[2023-06-01 01:38:30] INFO Log saved in /root/autodl-tmp/xiaolong/WorkSpace/Amazon-KDDCUP-23/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.log.
[2023-06-01 01:38:30] INFO Global seed set to 2022
[2023-06-01 01:38:30] INFO Load dataset from cache ./.recstudio/cache/b5aeac4e5b9ff0518bbcb59a28086594
[2023-06-01 01:38:34] INFO 
Dataset Info: 

==================================================================
item information: 
field      product_id DE_index   
type       token      float      
##         518328     -          
==================================================================
user information: 
field      sess_id    
type       token      
##         1340553    
==================================================================
interaction information: 
field      rating     sess_id    product_id timestamp  locale     
type       float      token      token      float      token      
##         -          1340553    518328     -          2          
==================================================================
Total Interactions: 6816971
Sparsity: 0.999990
==================================================================
[2023-06-01 01:38:34] INFO 
Model Config: 

data:
	binarized_rating_thres=None
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=True
	split_mode=user
	split_ratio=[1.0]
	test_rep=True
	train_rep=True
eval:
	batch_size=1024
	cutoff=[100, 200, 300]
	val_metrics=['mrr', 'recall', 'precision', 'ndcg']
	val_n_epoch=1
	test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
	topk=300
	save_path=./saved/
	num_workers=8
	predict_topk=100
model:
	embed_dim=128
	item_bias=False
	activation=gelu
	dropout_rate=0.5
	hidden_size=256
	head_num=2
	layer_norm_eps=1e-12
	layer_num=3
	loss_func=softmax
	use_product_feature=1
	use_color=0
	use_price=0
	feature_id_concat=0
	use_text_feat=False
	item_title_layers=[768, 128]
	item_title_dropout=0.0
	feat_id_concat=False
	feat_id_layers=None
	feat_id_dropout=None
train:
	accelerator=gpu
	ann=None
	batch_size=1024
	early_stop_mode=max
	early_stop_patience=10
	epochs=100
	gpu=2
	grad_clip_norm=None
	init_method=default
	init_range=0.02
	item_batch_size=500000
	learner=adam
	learning_rate=0.001
	num_threads=10
	num_workers=8
	sampling_method=none
	sampler=uniform
	negative_count=None
	excluding_hist=False
	scheduler=onplateau
	scheduler_patience=2
	scheduler_factor=0.5
	seed=2022
	weight_decay=0.0
	tensorboard_path=None
	use_wandb=False
	wandb_project=None
	wandb_count=0
	pretrained_embed_file=None
[2023-06-01 01:38:35] INFO save_dir:./saved/
[2023-06-01 01:38:35] INFO SASRec_Next_Feat(
  (score_func): InnerProductScorer()
  (loss_fn): SoftmaxLoss()
  (item_encoder): SASRecFeatItemEncoder(
    (item_emb): Embedding(518328, 128, padding_idx=0)
    (brand_embedding): Embedding(68941, 128, padding_idx=0)
    (material_embedding): Embedding(15127, 128, padding_idx=0)
    (author_embedding): Embedding(10517, 128, padding_idx=0)
  )
  (query_encoder): SASRecQueryEncoder(
    (item_encoder): SASRecFeatItemEncoder(
      (item_emb): Embedding(518328, 128, padding_idx=0)
      (brand_embedding): Embedding(68941, 128, padding_idx=0)
      (material_embedding): Embedding(15127, 128, padding_idx=0)
      (author_embedding): Embedding(10517, 128, padding_idx=0)
    )
    (position_emb): Embedding(11, 128)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.5, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
[2023-06-01 01:38:35] INFO GPU id [2] are selected.
[2023-06-01 01:48:00] INFO Training: Epoch=  0 [mrr@100=0.1277 recall@100=0.3587 precision@100=0.0036 ndcg@100=0.1740 train_loss_0=12.0865]
[2023-06-01 01:48:00] INFO Train time: 556.83939s. Valid time: 5.92776s. GPU RAM: 11.97/23.70 GB
[2023-06-01 01:48:00] INFO Current learning rate : 0.001
[2023-06-01 01:48:01] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 01:48:01] INFO mrr@100 improved. Best value: 0.1277
[2023-06-01 01:57:25] INFO Training: Epoch=  1 [mrr@100=0.1660 recall@100=0.4106 precision@100=0.0041 ndcg@100=0.2150 train_loss_0=8.4051]
[2023-06-01 01:57:25] INFO Train time: 557.92712s. Valid time: 5.81766s. GPU RAM: 11.98/23.70 GB
[2023-06-01 01:57:25] INFO Current learning rate : 0.001
[2023-06-01 01:57:28] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 01:57:28] INFO mrr@100 improved. Best value: 0.1660
[2023-06-01 02:06:52] INFO Training: Epoch=  2 [mrr@100=0.1910 recall@100=0.4552 precision@100=0.0046 ndcg@100=0.2438 train_loss_0=7.5264]
[2023-06-01 02:06:52] INFO Train time: 557.61860s. Valid time: 6.14183s. GPU RAM: 11.98/23.70 GB
[2023-06-01 02:06:52] INFO Current learning rate : 0.001
[2023-06-01 02:06:54] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 02:06:54] INFO mrr@100 improved. Best value: 0.1910
[2023-06-01 02:16:17] INFO Training: Epoch=  3 [mrr@100=0.2123 recall@100=0.4893 precision@100=0.0049 ndcg@100=0.2679 train_loss_0=6.9502]
[2023-06-01 02:16:17] INFO Train time: 556.28489s. Valid time: 6.33677s. GPU RAM: 11.98/23.70 GB
[2023-06-01 02:16:17] INFO Current learning rate : 0.001
[2023-06-01 02:16:20] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 02:16:20] INFO mrr@100 improved. Best value: 0.2123
[2023-06-01 02:25:39] INFO Training: Epoch=  4 [mrr@100=0.2279 recall@100=0.5175 precision@100=0.0052 ndcg@100=0.2862 train_loss_0=6.5360]
[2023-06-01 02:25:39] INFO Train time: 553.65505s. Valid time: 5.57821s. GPU RAM: 11.98/23.70 GB
[2023-06-01 02:25:39] INFO Current learning rate : 0.001
[2023-06-01 02:25:42] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 02:25:42] INFO mrr@100 improved. Best value: 0.2279
[2023-06-01 02:35:00] INFO Training: Epoch=  5 [mrr@100=0.2414 recall@100=0.5401 precision@100=0.0054 ndcg@100=0.3016 train_loss_0=6.2231]
[2023-06-01 02:35:00] INFO Train time: 552.02781s. Valid time: 5.58830s. GPU RAM: 11.98/23.70 GB
[2023-06-01 02:35:00] INFO Current learning rate : 0.001
[2023-06-01 02:35:01] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 02:35:01] INFO mrr@100 improved. Best value: 0.2414
[2023-06-01 02:44:28] INFO Training: Epoch=  6 [mrr@100=0.2516 recall@100=0.5586 precision@100=0.0056 ndcg@100=0.3136 train_loss_0=5.9773]
[2023-06-01 02:44:28] INFO Train time: 560.16399s. Valid time: 6.13751s. GPU RAM: 11.98/23.70 GB
[2023-06-01 02:44:28] INFO Current learning rate : 0.001
[2023-06-01 02:44:30] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 02:44:30] INFO mrr@100 improved. Best value: 0.2516
[2023-06-01 02:53:44] INFO Training: Epoch=  7 [mrr@100=0.2602 recall@100=0.5738 precision@100=0.0057 ndcg@100=0.3237 train_loss_0=5.7785]
[2023-06-01 02:53:44] INFO Train time: 548.16523s. Valid time: 5.98269s. GPU RAM: 11.98/23.70 GB
[2023-06-01 02:53:44] INFO Current learning rate : 0.001
[2023-06-01 02:53:47] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 02:53:47] INFO mrr@100 improved. Best value: 0.2602
[2023-06-01 03:03:02] INFO Training: Epoch=  8 [mrr@100=0.2682 recall@100=0.5864 precision@100=0.0059 ndcg@100=0.3327 train_loss_0=5.6136]
[2023-06-01 03:03:02] INFO Train time: 549.10594s. Valid time: 6.17180s. GPU RAM: 11.98/23.70 GB
[2023-06-01 03:03:02] INFO Current learning rate : 0.001
[2023-06-01 03:03:04] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 03:03:04] INFO mrr@100 improved. Best value: 0.2682
[2023-06-01 03:12:20] INFO Training: Epoch=  9 [mrr@100=0.2735 recall@100=0.5970 precision@100=0.0060 ndcg@100=0.3392 train_loss_0=5.4748]
[2023-06-01 03:12:20] INFO Train time: 550.22192s. Valid time: 6.01750s. GPU RAM: 11.98/23.70 GB
[2023-06-01 03:12:20] INFO Current learning rate : 0.001
[2023-06-01 03:12:23] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 03:12:23] INFO mrr@100 improved. Best value: 0.2735
[2023-06-01 03:21:38] INFO Training: Epoch= 10 [mrr@100=0.2788 recall@100=0.6065 precision@100=0.0061 ndcg@100=0.3454 train_loss_0=5.3566]
[2023-06-01 03:21:38] INFO Train time: 548.32947s. Valid time: 6.33177s. GPU RAM: 11.98/23.70 GB
[2023-06-01 03:21:38] INFO Current learning rate : 0.001
[2023-06-01 03:21:39] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 03:21:39] INFO mrr@100 improved. Best value: 0.2788
[2023-06-01 03:30:54] INFO Training: Epoch= 11 [mrr@100=0.2831 recall@100=0.6143 precision@100=0.0061 ndcg@100=0.3504 train_loss_0=5.2545]
[2023-06-01 03:30:54] INFO Train time: 549.49958s. Valid time: 5.45691s. GPU RAM: 11.98/23.70 GB
[2023-06-01 03:30:54] INFO Current learning rate : 0.001
[2023-06-01 03:30:57] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 03:30:57] INFO mrr@100 improved. Best value: 0.2831
[2023-06-01 03:40:16] INFO Training: Epoch= 12 [mrr@100=0.2868 recall@100=0.6213 precision@100=0.0062 ndcg@100=0.3549 train_loss_0=5.1663]
[2023-06-01 03:40:16] INFO Train time: 552.38954s. Valid time: 6.36951s. GPU RAM: 11.98/23.70 GB
[2023-06-01 03:40:16] INFO Current learning rate : 0.001
[2023-06-01 03:40:19] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 03:40:19] INFO mrr@100 improved. Best value: 0.2868
[2023-06-01 03:49:37] INFO Training: Epoch= 13 [mrr@100=0.2892 recall@100=0.6272 precision@100=0.0063 ndcg@100=0.3581 train_loss_0=5.0873]
[2023-06-01 03:49:37] INFO Train time: 552.38907s. Valid time: 5.84961s. GPU RAM: 11.98/23.70 GB
[2023-06-01 03:49:37] INFO Current learning rate : 0.001
[2023-06-01 03:49:40] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 03:49:40] INFO mrr@100 improved. Best value: 0.2892
[2023-06-01 03:58:58] INFO Training: Epoch= 14 [mrr@100=0.2916 recall@100=0.6323 precision@100=0.0063 ndcg@100=0.3610 train_loss_0=5.0180]
[2023-06-01 03:58:58] INFO Train time: 552.25649s. Valid time: 5.73396s. GPU RAM: 11.98/23.70 GB
[2023-06-01 03:58:58] INFO Current learning rate : 0.001
[2023-06-01 03:59:01] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 03:59:01] INFO mrr@100 improved. Best value: 0.2916
[2023-06-01 04:08:16] INFO Training: Epoch= 15 [mrr@100=0.2947 recall@100=0.6372 precision@100=0.0064 ndcg@100=0.3646 train_loss_0=4.9548]
[2023-06-01 04:08:16] INFO Train time: 548.99495s. Valid time: 5.85850s. GPU RAM: 11.98/23.70 GB
[2023-06-01 04:08:16] INFO Current learning rate : 0.001
[2023-06-01 04:08:18] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 04:08:18] INFO mrr@100 improved. Best value: 0.2947
[2023-06-01 04:17:35] INFO Training: Epoch= 16 [mrr@100=0.2957 recall@100=0.6412 precision@100=0.0064 ndcg@100=0.3662 train_loss_0=4.8973]
[2023-06-01 04:17:35] INFO Train time: 550.50322s. Valid time: 6.02732s. GPU RAM: 11.98/23.70 GB
[2023-06-01 04:17:35] INFO Current learning rate : 0.001
[2023-06-01 04:17:39] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 04:17:39] INFO mrr@100 improved. Best value: 0.2957
[2023-06-01 04:26:55] INFO Training: Epoch= 17 [mrr@100=0.2973 recall@100=0.6455 precision@100=0.0065 ndcg@100=0.3684 train_loss_0=4.8463]
[2023-06-01 04:26:55] INFO Train time: 550.82631s. Valid time: 5.96675s. GPU RAM: 11.98/23.70 GB
[2023-06-01 04:26:55] INFO Current learning rate : 0.001
[2023-06-01 04:26:57] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 04:26:57] INFO mrr@100 improved. Best value: 0.2973
[2023-06-01 04:36:11] INFO Training: Epoch= 18 [mrr@100=0.2994 recall@100=0.6479 precision@100=0.0065 ndcg@100=0.3706 train_loss_0=4.7979]
[2023-06-01 04:36:11] INFO Train time: 548.30937s. Valid time: 5.62452s. GPU RAM: 11.98/23.70 GB
[2023-06-01 04:36:11] INFO Current learning rate : 0.001
[2023-06-01 04:36:14] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 04:36:14] INFO mrr@100 improved. Best value: 0.2994
[2023-06-01 04:45:31] INFO Training: Epoch= 19 [mrr@100=0.3005 recall@100=0.6514 precision@100=0.0065 ndcg@100=0.3721 train_loss_0=4.7544]
[2023-06-01 04:45:31] INFO Train time: 551.24583s. Valid time: 5.79616s. GPU RAM: 11.98/23.70 GB
[2023-06-01 04:45:31] INFO Current learning rate : 0.001
[2023-06-01 04:45:33] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 04:45:33] INFO mrr@100 improved. Best value: 0.3005
[2023-06-01 04:54:49] INFO Training: Epoch= 20 [mrr@100=0.3017 recall@100=0.6537 precision@100=0.0065 ndcg@100=0.3736 train_loss_0=4.7141]
[2023-06-01 04:54:49] INFO Train time: 550.33403s. Valid time: 5.84706s. GPU RAM: 11.98/23.70 GB
[2023-06-01 04:54:49] INFO Current learning rate : 0.001
[2023-06-01 04:54:53] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 04:54:53] INFO mrr@100 improved. Best value: 0.3017
[2023-06-01 05:04:09] INFO Training: Epoch= 21 [mrr@100=0.3019 recall@100=0.6556 precision@100=0.0066 ndcg@100=0.3742 train_loss_0=4.6778]
[2023-06-01 05:04:09] INFO Train time: 550.58118s. Valid time: 5.77757s. GPU RAM: 11.98/23.70 GB
[2023-06-01 05:04:09] INFO Current learning rate : 0.001
[2023-06-01 05:04:13] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 05:04:13] INFO mrr@100 improved. Best value: 0.3019
[2023-06-01 05:13:27] INFO Training: Epoch= 22 [mrr@100=0.3033 recall@100=0.6576 precision@100=0.0066 ndcg@100=0.3757 train_loss_0=4.6437]
[2023-06-01 05:13:27] INFO Train time: 548.03751s. Valid time: 5.82363s. GPU RAM: 11.98/23.70 GB
[2023-06-01 05:13:27] INFO Current learning rate : 0.001
[2023-06-01 05:13:30] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 05:13:30] INFO mrr@100 improved. Best value: 0.3033
[2023-06-01 05:22:44] INFO Training: Epoch= 23 [mrr@100=0.3035 recall@100=0.6592 precision@100=0.0066 ndcg@100=0.3763 train_loss_0=4.6112]
[2023-06-01 05:22:44] INFO Train time: 548.62285s. Valid time: 5.55993s. GPU RAM: 11.98/23.70 GB
[2023-06-01 05:22:44] INFO Current learning rate : 0.001
[2023-06-01 05:22:45] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 05:22:45] INFO mrr@100 improved. Best value: 0.3035
[2023-06-01 05:31:58] INFO Training: Epoch= 24 [mrr@100=0.3043 recall@100=0.6611 precision@100=0.0066 ndcg@100=0.3772 train_loss_0=4.5817]
[2023-06-01 05:31:58] INFO Train time: 547.48189s. Valid time: 5.58629s. GPU RAM: 11.98/23.70 GB
[2023-06-01 05:31:58] INFO Current learning rate : 0.001
[2023-06-01 05:32:01] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 05:32:01] INFO mrr@100 improved. Best value: 0.3043
[2023-06-01 05:41:15] INFO Training: Epoch= 25 [mrr@100=0.3053 recall@100=0.6623 precision@100=0.0066 ndcg@100=0.3784 train_loss_0=4.5540]
[2023-06-01 05:41:15] INFO Train time: 547.86857s. Valid time: 5.45498s. GPU RAM: 11.98/23.70 GB
[2023-06-01 05:41:15] INFO Current learning rate : 0.001
[2023-06-01 05:41:16] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 05:41:16] INFO mrr@100 improved. Best value: 0.3053
[2023-06-01 05:50:30] INFO Training: Epoch= 26 [mrr@100=0.3061 recall@100=0.6642 precision@100=0.0066 ndcg@100=0.3793 train_loss_0=4.5296]
[2023-06-01 05:50:30] INFO Train time: 548.54414s. Valid time: 5.52981s. GPU RAM: 11.98/23.70 GB
[2023-06-01 05:50:30] INFO Current learning rate : 0.001
[2023-06-01 05:50:33] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 05:50:33] INFO mrr@100 improved. Best value: 0.3061
[2023-06-01 05:59:47] INFO Training: Epoch= 27 [mrr@100=0.3063 recall@100=0.6650 precision@100=0.0067 ndcg@100=0.3797 train_loss_0=4.5053]
[2023-06-01 05:59:47] INFO Train time: 548.03816s. Valid time: 5.70313s. GPU RAM: 11.98/23.70 GB
[2023-06-01 05:59:47] INFO Current learning rate : 0.001
[2023-06-01 05:59:51] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 05:59:51] INFO mrr@100 improved. Best value: 0.3063
[2023-06-01 06:09:06] INFO Training: Epoch= 28 [mrr@100=0.3066 recall@100=0.6655 precision@100=0.0067 ndcg@100=0.3801 train_loss_0=4.4822]
[2023-06-01 06:09:06] INFO Train time: 549.49698s. Valid time: 5.60223s. GPU RAM: 11.98/23.70 GB
[2023-06-01 06:09:06] INFO Current learning rate : 0.001
[2023-06-01 06:09:08] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 06:09:08] INFO mrr@100 improved. Best value: 0.3066
[2023-06-01 06:18:19] INFO Training: Epoch= 29 [mrr@100=0.3073 recall@100=0.6671 precision@100=0.0067 ndcg@100=0.3810 train_loss_0=4.4605]
[2023-06-01 06:18:19] INFO Train time: 545.13602s. Valid time: 5.68824s. GPU RAM: 11.98/23.70 GB
[2023-06-01 06:18:19] INFO Current learning rate : 0.001
[2023-06-01 06:18:22] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 06:18:22] INFO mrr@100 improved. Best value: 0.3073
[2023-06-01 06:27:37] INFO Training: Epoch= 30 [mrr@100=0.3075 recall@100=0.6679 precision@100=0.0067 ndcg@100=0.3813 train_loss_0=4.4415]
[2023-06-01 06:27:37] INFO Train time: 549.42210s. Valid time: 5.61900s. GPU RAM: 11.98/23.70 GB
[2023-06-01 06:27:37] INFO Current learning rate : 0.001
[2023-06-01 06:27:40] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 06:27:40] INFO mrr@100 improved. Best value: 0.3075
[2023-06-01 06:36:55] INFO Training: Epoch= 31 [mrr@100=0.3077 recall@100=0.6691 precision@100=0.0067 ndcg@100=0.3816 train_loss_0=4.4227]
[2023-06-01 06:36:55] INFO Train time: 549.87159s. Valid time: 5.46795s. GPU RAM: 11.98/23.70 GB
[2023-06-01 06:36:55] INFO Current learning rate : 0.001
[2023-06-01 06:36:58] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 06:36:58] INFO mrr@100 improved. Best value: 0.3077
[2023-06-01 06:46:15] INFO Training: Epoch= 32 [mrr@100=0.3081 recall@100=0.6700 precision@100=0.0067 ndcg@100=0.3822 train_loss_0=4.4059]
[2023-06-01 06:46:15] INFO Train time: 552.05262s. Valid time: 5.39040s. GPU RAM: 11.98/23.70 GB
[2023-06-01 06:46:15] INFO Current learning rate : 0.001
[2023-06-01 06:46:18] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 06:46:18] INFO mrr@100 improved. Best value: 0.3081
[2023-06-01 06:55:36] INFO Training: Epoch= 33 [mrr@100=0.3085 recall@100=0.6707 precision@100=0.0067 ndcg@100=0.3827 train_loss_0=4.3879]
[2023-06-01 06:55:36] INFO Train time: 553.03536s. Valid time: 5.50532s. GPU RAM: 11.98/23.70 GB
[2023-06-01 06:55:36] INFO Current learning rate : 0.001
[2023-06-01 06:55:39] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 06:55:39] INFO mrr@100 improved. Best value: 0.3085
[2023-06-01 07:04:57] INFO Training: Epoch= 34 [mrr@100=0.3087 recall@100=0.6714 precision@100=0.0067 ndcg@100=0.3829 train_loss_0=4.3722]
[2023-06-01 07:04:57] INFO Train time: 552.01626s. Valid time: 5.59787s. GPU RAM: 11.98/23.70 GB
[2023-06-01 07:04:57] INFO Current learning rate : 0.001
[2023-06-01 07:04:59] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 07:04:59] INFO mrr@100 improved. Best value: 0.3087
[2023-06-01 07:14:18] INFO Training: Epoch= 35 [mrr@100=0.3087 recall@100=0.6723 precision@100=0.0067 ndcg@100=0.3832 train_loss_0=4.3573]
[2023-06-01 07:14:18] INFO Train time: 553.57521s. Valid time: 5.64428s. GPU RAM: 11.98/23.70 GB
[2023-06-01 07:14:18] INFO Current learning rate : 0.001
[2023-06-01 07:14:21] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 07:14:21] INFO mrr@100 improved. Best value: 0.3087
[2023-06-01 07:23:40] INFO Training: Epoch= 36 [mrr@100=0.3095 recall@100=0.6726 precision@100=0.0067 ndcg@100=0.3838 train_loss_0=4.3430]
[2023-06-01 07:23:40] INFO Train time: 553.78923s. Valid time: 5.56636s. GPU RAM: 11.98/23.70 GB
[2023-06-01 07:23:40] INFO Current learning rate : 0.001
[2023-06-01 07:23:43] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 07:23:43] INFO mrr@100 improved. Best value: 0.3095
[2023-06-01 07:33:01] INFO Training: Epoch= 37 [mrr@100=0.3092 recall@100=0.6733 precision@100=0.0067 ndcg@100=0.3837 train_loss_0=4.3288]
[2023-06-01 07:33:01] INFO Train time: 553.07045s. Valid time: 5.27903s. GPU RAM: 11.98/23.70 GB
[2023-06-01 07:33:01] INFO Current learning rate : 0.001
[2023-06-01 07:42:20] INFO Training: Epoch= 38 [mrr@100=0.3097 recall@100=0.6737 precision@100=0.0067 ndcg@100=0.3841 train_loss_0=4.3161]
[2023-06-01 07:42:20] INFO Train time: 553.14348s. Valid time: 5.25104s. GPU RAM: 11.98/23.70 GB
[2023-06-01 07:42:20] INFO Current learning rate : 0.001
[2023-06-01 07:42:22] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 07:42:22] INFO mrr@100 improved. Best value: 0.3097
[2023-06-01 07:51:39] INFO Training: Epoch= 39 [mrr@100=0.3096 recall@100=0.6738 precision@100=0.0067 ndcg@100=0.3841 train_loss_0=4.3044]
[2023-06-01 07:51:39] INFO Train time: 551.09315s. Valid time: 5.74537s. GPU RAM: 11.98/23.70 GB
[2023-06-01 07:51:39] INFO Current learning rate : 0.001
[2023-06-01 08:00:59] INFO Training: Epoch= 40 [mrr@100=0.3097 recall@100=0.6744 precision@100=0.0067 ndcg@100=0.3843 train_loss_0=4.2919]
[2023-06-01 08:00:59] INFO Train time: 553.63267s. Valid time: 5.62237s. GPU RAM: 11.98/23.70 GB
[2023-06-01 08:00:59] INFO Current learning rate : 0.001
[2023-06-01 08:10:21] INFO Training: Epoch= 41 [mrr@100=0.3101 recall@100=0.6745 precision@100=0.0067 ndcg@100=0.3846 train_loss_0=4.2814]
[2023-06-01 08:10:21] INFO Train time: 556.84419s. Valid time: 5.43563s. GPU RAM: 11.98/23.70 GB
[2023-06-01 08:10:21] INFO Current learning rate : 0.001
[2023-06-01 08:10:24] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 08:10:24] INFO mrr@100 improved. Best value: 0.3101
[2023-06-01 08:19:44] INFO Training: Epoch= 42 [mrr@100=0.3099 recall@100=0.6745 precision@100=0.0067 ndcg@100=0.3845 train_loss_0=4.2701]
[2023-06-01 08:19:44] INFO Train time: 554.07977s. Valid time: 5.55235s. GPU RAM: 11.98/23.70 GB
[2023-06-01 08:19:44] INFO Current learning rate : 0.001
[2023-06-01 08:29:03] INFO Training: Epoch= 43 [mrr@100=0.3096 recall@100=0.6749 precision@100=0.0067 ndcg@100=0.3843 train_loss_0=4.2593]
[2023-06-01 08:29:03] INFO Train time: 553.77524s. Valid time: 5.39048s. GPU RAM: 11.98/23.70 GB
[2023-06-01 08:29:03] INFO Current learning rate : 0.001
[2023-06-01 08:38:21] INFO Training: Epoch= 44 [mrr@100=0.3104 recall@100=0.6753 precision@100=0.0068 ndcg@100=0.3850 train_loss_0=4.2495]
[2023-06-01 08:38:21] INFO Train time: 552.64486s. Valid time: 5.49658s. GPU RAM: 11.98/23.70 GB
[2023-06-01 08:38:21] INFO Current learning rate : 0.001
[2023-06-01 08:38:24] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 08:38:24] INFO mrr@100 improved. Best value: 0.3104
[2023-06-01 08:47:41] INFO Training: Epoch= 45 [mrr@100=0.3100 recall@100=0.6750 precision@100=0.0068 ndcg@100=0.3847 train_loss_0=4.2397]
[2023-06-01 08:47:41] INFO Train time: 552.01215s. Valid time: 5.56820s. GPU RAM: 11.98/23.70 GB
[2023-06-01 08:47:41] INFO Current learning rate : 0.001
[2023-06-01 08:56:59] INFO Training: Epoch= 46 [mrr@100=0.3101 recall@100=0.6753 precision@100=0.0068 ndcg@100=0.3849 train_loss_0=4.2300]
[2023-06-01 08:56:59] INFO Train time: 551.75944s. Valid time: 5.73285s. GPU RAM: 11.98/23.70 GB
[2023-06-01 08:56:59] INFO Current learning rate : 0.001
[2023-06-01 09:06:24] INFO Training: Epoch= 47 [mrr@100=0.3104 recall@100=0.6749 precision@100=0.0067 ndcg@100=0.3850 train_loss_0=4.2210]
[2023-06-01 09:06:24] INFO Train time: 559.60677s. Valid time: 5.20616s. GPU RAM: 11.98/23.70 GB
[2023-06-01 09:06:24] INFO Current learning rate : 0.0005
[2023-06-01 09:15:52] INFO Training: Epoch= 48 [mrr@100=0.3111 recall@100=0.6764 precision@100=0.0068 ndcg@100=0.3858 train_loss_0=4.1455]
[2023-06-01 09:15:52] INFO Train time: 562.58502s. Valid time: 5.37693s. GPU RAM: 11.98/23.70 GB
[2023-06-01 09:15:52] INFO Current learning rate : 0.0005
[2023-06-01 09:15:54] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 09:15:54] INFO mrr@100 improved. Best value: 0.3111
[2023-06-01 09:25:17] INFO Training: Epoch= 49 [mrr@100=0.3114 recall@100=0.6765 precision@100=0.0068 ndcg@100=0.3861 train_loss_0=4.1323]
[2023-06-01 09:25:17] INFO Train time: 557.23051s. Valid time: 5.09531s. GPU RAM: 11.98/23.70 GB
[2023-06-01 09:25:17] INFO Current learning rate : 0.0005
[2023-06-01 09:25:19] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 09:25:19] INFO mrr@100 improved. Best value: 0.3114
[2023-06-01 09:34:42] INFO Training: Epoch= 50 [mrr@100=0.3110 recall@100=0.6756 precision@100=0.0068 ndcg@100=0.3856 train_loss_0=4.1236]
[2023-06-01 09:34:42] INFO Train time: 557.59643s. Valid time: 5.06553s. GPU RAM: 11.98/23.70 GB
[2023-06-01 09:34:42] INFO Current learning rate : 0.0005
[2023-06-01 09:44:04] INFO Training: Epoch= 51 [mrr@100=0.3110 recall@100=0.6765 precision@100=0.0068 ndcg@100=0.3858 train_loss_0=4.1161]
[2023-06-01 09:44:04] INFO Train time: 557.13998s. Valid time: 5.28088s. GPU RAM: 11.98/23.70 GB
[2023-06-01 09:44:04] INFO Current learning rate : 0.0005
[2023-06-01 09:53:26] INFO Training: Epoch= 52 [mrr@100=0.3108 recall@100=0.6762 precision@100=0.0068 ndcg@100=0.3856 train_loss_0=4.1083]
[2023-06-01 09:53:26] INFO Train time: 556.35638s. Valid time: 5.22063s. GPU RAM: 11.98/23.70 GB
[2023-06-01 09:53:26] INFO Current learning rate : 0.00025
[2023-06-01 10:02:48] INFO Training: Epoch= 53 [mrr@100=0.3112 recall@100=0.6768 precision@100=0.0068 ndcg@100=0.3860 train_loss_0=4.0655]
[2023-06-01 10:02:48] INFO Train time: 556.51267s. Valid time: 5.15291s. GPU RAM: 11.98/23.70 GB
[2023-06-01 10:02:48] INFO Current learning rate : 0.00025
[2023-06-01 10:12:13] INFO Training: Epoch= 54 [mrr@100=0.3110 recall@100=0.6763 precision@100=0.0068 ndcg@100=0.3858 train_loss_0=4.0580]
[2023-06-01 10:12:13] INFO Train time: 559.76158s. Valid time: 5.43304s. GPU RAM: 11.98/23.70 GB
[2023-06-01 10:12:13] INFO Current learning rate : 0.00025
[2023-06-01 10:21:58] INFO Training: Epoch= 55 [mrr@100=0.3114 recall@100=0.6765 precision@100=0.0068 ndcg@100=0.3861 train_loss_0=4.0526]
[2023-06-01 10:21:58] INFO Train time: 578.77866s. Valid time: 6.41558s. GPU RAM: 11.98/23.70 GB
[2023-06-01 10:21:58] INFO Current learning rate : 0.000125
[2023-06-01 10:22:01] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 10:22:01] INFO mrr@100 improved. Best value: 0.3114
[2023-06-01 10:31:47] INFO Training: Epoch= 56 [mrr@100=0.3115 recall@100=0.6767 precision@100=0.0068 ndcg@100=0.3862 train_loss_0=4.0295]
[2023-06-01 10:31:47] INFO Train time: 578.83765s. Valid time: 6.68308s. GPU RAM: 11.98/23.70 GB
[2023-06-01 10:31:47] INFO Current learning rate : 0.000125
[2023-06-01 10:31:50] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 10:31:50] INFO mrr@100 improved. Best value: 0.3115
[2023-06-01 10:41:36] INFO Training: Epoch= 57 [mrr@100=0.3116 recall@100=0.6768 precision@100=0.0068 ndcg@100=0.3863 train_loss_0=4.0259]
[2023-06-01 10:41:36] INFO Train time: 579.18521s. Valid time: 7.11483s. GPU RAM: 11.98/23.70 GB
[2023-06-01 10:41:36] INFO Current learning rate : 0.000125
[2023-06-01 10:41:38] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 10:41:38] INFO mrr@100 improved. Best value: 0.3116
[2023-06-01 10:51:26] INFO Training: Epoch= 58 [mrr@100=0.3118 recall@100=0.6769 precision@100=0.0068 ndcg@100=0.3865 train_loss_0=4.0230]
[2023-06-01 10:51:26] INFO Train time: 581.27334s. Valid time: 6.57112s. GPU RAM: 11.98/23.70 GB
[2023-06-01 10:51:26] INFO Current learning rate : 0.000125
[2023-06-01 10:51:28] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 10:51:28] INFO mrr@100 improved. Best value: 0.3118
[2023-06-01 11:01:14] INFO Training: Epoch= 59 [mrr@100=0.3114 recall@100=0.6768 precision@100=0.0068 ndcg@100=0.3862 train_loss_0=4.0202]
[2023-06-01 11:01:14] INFO Train time: 579.30272s. Valid time: 7.00724s. GPU RAM: 11.98/23.70 GB
[2023-06-01 11:01:14] INFO Current learning rate : 0.000125
[2023-06-01 11:10:50] INFO Training: Epoch= 60 [mrr@100=0.3114 recall@100=0.6767 precision@100=0.0068 ndcg@100=0.3862 train_loss_0=4.0178]
[2023-06-01 11:10:50] INFO Train time: 569.40952s. Valid time: 6.50715s. GPU RAM: 11.98/23.70 GB
[2023-06-01 11:10:50] INFO Current learning rate : 0.000125
[2023-06-01 11:20:13] INFO Training: Epoch= 61 [mrr@100=0.3115 recall@100=0.6767 precision@100=0.0068 ndcg@100=0.3863 train_loss_0=4.0154]
[2023-06-01 11:20:13] INFO Train time: 556.89544s. Valid time: 6.24888s. GPU RAM: 11.98/23.70 GB
[2023-06-01 11:20:13] INFO Current learning rate : 6.25e-05
[2023-06-01 11:29:38] INFO Training: Epoch= 62 [mrr@100=0.3116 recall@100=0.6767 precision@100=0.0068 ndcg@100=0.3863 train_loss_0=4.0033]
[2023-06-01 11:29:38] INFO Train time: 558.90751s. Valid time: 6.14917s. GPU RAM: 11.98/23.70 GB
[2023-06-01 11:29:38] INFO Current learning rate : 6.25e-05
[2023-06-01 11:39:05] INFO Training: Epoch= 63 [mrr@100=0.3115 recall@100=0.6764 precision@100=0.0068 ndcg@100=0.3862 train_loss_0=4.0016]
[2023-06-01 11:39:05] INFO Train time: 560.71244s. Valid time: 6.11628s. GPU RAM: 11.98/23.70 GB
[2023-06-01 11:39:05] INFO Current learning rate : 6.25e-05
[2023-06-01 11:48:59] INFO Training: Epoch= 64 [mrr@100=0.3114 recall@100=0.6766 precision@100=0.0068 ndcg@100=0.3862 train_loss_0=3.9996]
[2023-06-01 11:48:59] INFO Train time: 587.30927s. Valid time: 6.30605s. GPU RAM: 11.98/23.70 GB
[2023-06-01 11:48:59] INFO Current learning rate : 3.125e-05
[2023-06-01 11:58:22] INFO Training: Epoch= 65 [mrr@100=0.3116 recall@100=0.6768 precision@100=0.0068 ndcg@100=0.3863 train_loss_0=3.9937]
[2023-06-01 11:58:22] INFO Train time: 556.18185s. Valid time: 6.68292s. GPU RAM: 11.98/23.70 GB
[2023-06-01 11:58:22] INFO Current learning rate : 3.125e-05
[2023-06-01 12:07:46] INFO Training: Epoch= 66 [mrr@100=0.3117 recall@100=0.6768 precision@100=0.0068 ndcg@100=0.3864 train_loss_0=3.9929]
[2023-06-01 12:07:46] INFO Train time: 557.36075s. Valid time: 6.55201s. GPU RAM: 11.98/23.70 GB
[2023-06-01 12:07:46] INFO Current learning rate : 3.125e-05
[2023-06-01 12:17:15] INFO Training: Epoch= 67 [mrr@100=0.3117 recall@100=0.6766 precision@100=0.0068 ndcg@100=0.3864 train_loss_0=3.9917]
[2023-06-01 12:17:15] INFO Train time: 562.48362s. Valid time: 6.45769s. GPU RAM: 11.98/23.70 GB
[2023-06-01 12:17:15] INFO Current learning rate : 1.5625e-05
[2023-06-01 12:26:46] INFO Training: Epoch= 68 [mrr@100=0.3116 recall@100=0.6768 precision@100=0.0068 ndcg@100=0.3863 train_loss_0=3.9885]
[2023-06-01 12:26:46] INFO Train time: 564.76565s. Valid time: 7.03374s. GPU RAM: 11.98/23.70 GB
[2023-06-01 12:26:46] INFO Current learning rate : 1.5625e-05
[2023-06-01 12:26:46] INFO Early stopped. Since the metric mrr@100 haven't been improved for 10 epochs.
[2023-06-01 12:26:46] INFO The best score of mrr@100 is 0.3118 on epoch 58
[2023-06-01 12:26:51] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt.
[2023-06-01 12:26:59] INFO Testing:  [recall@100=0.6769 precision@100=0.0068 map@100=0.3118 ndcg@100=0.3865 mrr@100=0.3118 hit@100=0.6769 recall@200=0.7173 precision@200=0.0036 map@200=0.3121 ndcg@200=0.3922 mrr@200=0.3121 hit@200=0.7173 recall@300=0.7364 precision@300=0.0025 map@300=0.3122 ndcg@300=0.3946 mrr@300=0.3122 hit@300=0.7364]
[2023-06-01 12:27:09] INFO Load checkpoint from ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt
[2023-06-01 12:27:38] INFO Load checkpoint from ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt
[2023-06-01 12:28:04] INFO Load checkpoint from ./saved/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-01-38-30.ckpt
[2023-06-01 12:28:30] INFO Prediction is finished, results are saved in ./predictions/SASRec_Next_Feat/kdd_cup_2023_DE/2023-06-01-12-26-59.parquet.
