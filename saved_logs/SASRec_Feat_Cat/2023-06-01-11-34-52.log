[2023-06-01 11:34:52] INFO Log saved in /root/autodl-tmp/xiaolong/WorkSpace/Amazon-KDDCUP-23/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.log.
[2023-06-01 11:34:52] INFO Global seed set to 2022
[2023-06-01 11:34:52] INFO Load dataset from cache ./.recstudio/cache/2536617955df215e0047f5b220d1c012
[2023-06-01 11:35:02] INFO 
Dataset Info: 

==================================================================
item information: 
field      product_id JP_index   
type       token      float      
##         395010     -          
==================================================================
user information: 
field      sess_id    
type       token      
##         1192054    
==================================================================
interaction information: 
field      rating     sess_id    product_id timestamp  locale     
type       float      token      token      float      token      
##         -          1192054    395010     -          2          
==================================================================
Total Interactions: 6218923
Sparsity: 0.999987
==================================================================
[2023-06-01 11:35:02] INFO 
Model Config: 

data:
	binarized_rating_thres=None
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=True
	split_mode=user
	split_ratio=[1.0]
	test_rep=True
	train_rep=True
eval:
	batch_size=1024
	cutoff=[100, 200, 300]
	val_metrics=['mrr', 'recall', 'precision', 'ndcg']
	val_n_epoch=1
	test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
	topk=300
	save_path=./saved/
	num_workers=8
	predict_topk=100
model:
	embed_dim=128
	item_bias=False
	activation=gelu
	dropout_rate=0.5
	hidden_size=256
	head_num=2
	layer_norm_eps=1e-12
	layer_num=3
	loss_func=softmax
	use_product_feature=1
	use_color=0
	use_price=0
	feature_id_concat=0
	use_text_feat=False
	item_title_layers=[768, 128]
	item_title_dropout=0.0
	feat_id_concat=False
	feat_id_layers=None
	feat_id_dropout=None
train:
	accelerator=gpu
	ann=None
	batch_size=1024
	early_stop_mode=max
	early_stop_patience=10
	epochs=100
	gpu=0
	grad_clip_norm=None
	init_method=default
	init_range=0.02
	item_batch_size=500000
	learner=adam
	learning_rate=0.001
	num_threads=10
	num_workers=8
	sampling_method=none
	sampler=uniform
	negative_count=None
	excluding_hist=False
	scheduler=onplateau
	scheduler_patience=2
	scheduler_factor=0.5
	seed=2022
	weight_decay=0.0
	tensorboard_path=None
	use_wandb=False
	wandb_project=None
	wandb_count=0
	pretrained_embed_file=None
[2023-06-01 11:35:03] INFO save_dir:./saved/
[2023-06-01 11:35:03] INFO SASRec_Next_Feat(
  (score_func): InnerProductScorer()
  (loss_fn): SoftmaxLoss()
  (item_encoder): SASRecFeatItemEncoder(
    (item_emb): Embedding(395010, 128, padding_idx=0)
    (brand_embedding): Embedding(48697, 128, padding_idx=0)
    (material_embedding): Embedding(15408, 128, padding_idx=0)
    (author_embedding): Embedding(11560, 128, padding_idx=0)
  )
  (query_encoder): SASRecQueryEncoder(
    (item_encoder): SASRecFeatItemEncoder(
      (item_emb): Embedding(395010, 128, padding_idx=0)
      (brand_embedding): Embedding(48697, 128, padding_idx=0)
      (material_embedding): Embedding(15408, 128, padding_idx=0)
      (author_embedding): Embedding(11560, 128, padding_idx=0)
    )
    (position_emb): Embedding(11, 128)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.5, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
[2023-06-01 11:35:03] INFO GPU id [0] are selected.
[2023-06-01 11:42:27] INFO Training: Epoch=  0 [mrr@100=0.1454 recall@100=0.4138 precision@100=0.0041 ndcg@100=0.1993 train_loss_0=11.6563]
[2023-06-01 11:42:27] INFO Train time: 434.56438s. Valid time: 7.10210s. GPU RAM: 7.82/23.70 GB
[2023-06-01 11:42:27] INFO Current learning rate : 0.001
[2023-06-01 11:42:28] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 11:42:28] INFO mrr@100 improved. Best value: 0.1454
[2023-06-01 11:50:13] INFO Training: Epoch=  1 [mrr@100=0.1938 recall@100=0.4738 precision@100=0.0047 ndcg@100=0.2500 train_loss_0=7.7978]
[2023-06-01 11:50:13] INFO Train time: 458.33814s. Valid time: 6.37800s. GPU RAM: 9.33/23.70 GB
[2023-06-01 11:50:13] INFO Current learning rate : 0.001
[2023-06-01 11:50:16] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 11:50:16] INFO mrr@100 improved. Best value: 0.1938
[2023-06-01 11:57:32] INFO Training: Epoch=  2 [mrr@100=0.2281 recall@100=0.5182 precision@100=0.0052 ndcg@100=0.2865 train_loss_0=6.9342]
[2023-06-01 11:57:32] INFO Train time: 430.38521s. Valid time: 5.85196s. GPU RAM: 9.33/23.70 GB
[2023-06-01 11:57:32] INFO Current learning rate : 0.001
[2023-06-01 11:57:34] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 11:57:34] INFO mrr@100 improved. Best value: 0.2281
[2023-06-01 12:04:49] INFO Training: Epoch=  3 [mrr@100=0.2533 recall@100=0.5506 precision@100=0.0055 ndcg@100=0.3134 train_loss_0=6.3909]
[2023-06-01 12:04:49] INFO Train time: 428.41427s. Valid time: 6.19404s. GPU RAM: 9.33/23.70 GB
[2023-06-01 12:04:49] INFO Current learning rate : 0.001
[2023-06-01 12:04:51] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 12:04:51] INFO mrr@100 improved. Best value: 0.2533
[2023-06-01 12:12:05] INFO Training: Epoch=  4 [mrr@100=0.2746 recall@100=0.5752 precision@100=0.0058 ndcg@100=0.3357 train_loss_0=6.0081]
[2023-06-01 12:12:05] INFO Train time: 426.66611s. Valid time: 7.18381s. GPU RAM: 9.33/23.70 GB
[2023-06-01 12:12:05] INFO Current learning rate : 0.001
[2023-06-01 12:12:06] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 12:12:06] INFO mrr@100 improved. Best value: 0.2746
[2023-06-01 12:19:25] INFO Training: Epoch=  5 [mrr@100=0.2900 recall@100=0.5948 precision@100=0.0059 ndcg@100=0.3523 train_loss_0=5.7225]
[2023-06-01 12:19:25] INFO Train time: 432.14805s. Valid time: 6.61863s. GPU RAM: 9.33/23.70 GB
[2023-06-01 12:19:25] INFO Current learning rate : 0.001
[2023-06-01 12:19:27] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 12:19:27] INFO mrr@100 improved. Best value: 0.2900
[2023-06-01 12:26:48] INFO Training: Epoch=  6 [mrr@100=0.3008 recall@100=0.6100 precision@100=0.0061 ndcg@100=0.3641 train_loss_0=5.5018]
[2023-06-01 12:26:48] INFO Train time: 434.22674s. Valid time: 6.81041s. GPU RAM: 9.34/23.70 GB
[2023-06-01 12:26:48] INFO Current learning rate : 0.001
[2023-06-01 12:26:51] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 12:26:51] INFO mrr@100 improved. Best value: 0.3008
[2023-06-01 12:34:07] INFO Training: Epoch=  7 [mrr@100=0.3108 recall@100=0.6221 precision@100=0.0062 ndcg@100=0.3747 train_loss_0=5.3248]
[2023-06-01 12:34:07] INFO Train time: 430.03606s. Valid time: 6.03592s. GPU RAM: 9.34/23.70 GB
[2023-06-01 12:34:07] INFO Current learning rate : 0.001
[2023-06-01 12:34:10] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 12:34:10] INFO mrr@100 improved. Best value: 0.3108
[2023-06-01 12:41:25] INFO Training: Epoch=  8 [mrr@100=0.3175 recall@100=0.6313 precision@100=0.0063 ndcg@100=0.3822 train_loss_0=5.1807]
[2023-06-01 12:41:25] INFO Train time: 429.35656s. Valid time: 5.67905s. GPU RAM: 9.34/23.70 GB
[2023-06-01 12:41:25] INFO Current learning rate : 0.001
[2023-06-01 12:41:27] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 12:41:27] INFO mrr@100 improved. Best value: 0.3175
[2023-06-01 12:48:43] INFO Training: Epoch=  9 [mrr@100=0.3250 recall@100=0.6409 precision@100=0.0064 ndcg@100=0.3902 train_loss_0=5.0604]
[2023-06-01 12:48:43] INFO Train time: 429.68926s. Valid time: 6.26130s. GPU RAM: 9.34/23.70 GB
[2023-06-01 12:48:43] INFO Current learning rate : 0.001
[2023-06-01 12:48:45] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 12:48:45] INFO mrr@100 improved. Best value: 0.3250
[2023-06-01 12:56:01] INFO Training: Epoch= 10 [mrr@100=0.3293 recall@100=0.6484 precision@100=0.0065 ndcg@100=0.3952 train_loss_0=4.9582]
[2023-06-01 12:56:01] INFO Train time: 428.88794s. Valid time: 6.87246s. GPU RAM: 9.34/23.70 GB
[2023-06-01 12:56:01] INFO Current learning rate : 0.001
[2023-06-01 12:56:02] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 12:56:02] INFO mrr@100 improved. Best value: 0.3293
[2023-06-01 13:03:18] INFO Training: Epoch= 11 [mrr@100=0.3334 recall@100=0.6543 precision@100=0.0065 ndcg@100=0.3998 train_loss_0=4.8710]
[2023-06-01 13:03:18] INFO Train time: 428.82410s. Valid time: 6.88873s. GPU RAM: 9.34/23.70 GB
[2023-06-01 13:03:18] INFO Current learning rate : 0.001
[2023-06-01 13:03:20] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 13:03:20] INFO mrr@100 improved. Best value: 0.3334
[2023-06-01 13:10:35] INFO Training: Epoch= 12 [mrr@100=0.3371 recall@100=0.6584 precision@100=0.0066 ndcg@100=0.4037 train_loss_0=4.7950]
[2023-06-01 13:10:35] INFO Train time: 427.81571s. Valid time: 6.96527s. GPU RAM: 9.34/23.70 GB
[2023-06-01 13:10:35] INFO Current learning rate : 0.001
[2023-06-01 13:10:36] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 13:10:36] INFO mrr@100 improved. Best value: 0.3371
[2023-06-01 13:17:53] INFO Training: Epoch= 13 [mrr@100=0.3403 recall@100=0.6636 precision@100=0.0066 ndcg@100=0.4074 train_loss_0=4.7284]
[2023-06-01 13:17:53] INFO Train time: 430.72066s. Valid time: 6.12531s. GPU RAM: 9.34/23.70 GB
[2023-06-01 13:17:53] INFO Current learning rate : 0.001
[2023-06-01 13:17:55] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 13:17:55] INFO mrr@100 improved. Best value: 0.3403
[2023-06-01 13:25:13] INFO Training: Epoch= 14 [mrr@100=0.3422 recall@100=0.6673 precision@100=0.0067 ndcg@100=0.4097 train_loss_0=4.6693]
[2023-06-01 13:25:13] INFO Train time: 431.45214s. Valid time: 6.29255s. GPU RAM: 9.34/23.70 GB
[2023-06-01 13:25:13] INFO Current learning rate : 0.001
[2023-06-01 13:25:15] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 13:25:15] INFO mrr@100 improved. Best value: 0.3422
[2023-06-01 13:32:30] INFO Training: Epoch= 15 [mrr@100=0.3439 recall@100=0.6708 precision@100=0.0067 ndcg@100=0.4119 train_loss_0=4.6162]
[2023-06-01 13:32:30] INFO Train time: 428.61362s. Valid time: 6.19080s. GPU RAM: 9.34/23.70 GB
[2023-06-01 13:32:30] INFO Current learning rate : 0.001
[2023-06-01 13:32:32] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 13:32:32] INFO mrr@100 improved. Best value: 0.3439
[2023-06-01 13:39:52] INFO Training: Epoch= 16 [mrr@100=0.3460 recall@100=0.6738 precision@100=0.0067 ndcg@100=0.4142 train_loss_0=4.5685]
[2023-06-01 13:39:52] INFO Train time: 433.81488s. Valid time: 6.37590s. GPU RAM: 9.34/23.70 GB
[2023-06-01 13:39:52] INFO Current learning rate : 0.001
[2023-06-01 13:39:54] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 13:39:54] INFO mrr@100 improved. Best value: 0.3460
[2023-06-01 13:47:12] INFO Training: Epoch= 17 [mrr@100=0.3481 recall@100=0.6768 precision@100=0.0068 ndcg@100=0.4165 train_loss_0=4.5245]
[2023-06-01 13:47:12] INFO Train time: 430.97524s. Valid time: 6.71858s. GPU RAM: 9.34/23.70 GB
[2023-06-01 13:47:12] INFO Current learning rate : 0.001
[2023-06-01 13:47:14] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 13:47:14] INFO mrr@100 improved. Best value: 0.3481
[2023-06-01 13:54:33] INFO Training: Epoch= 18 [mrr@100=0.3491 recall@100=0.6792 precision@100=0.0068 ndcg@100=0.4178 train_loss_0=4.4844]
[2023-06-01 13:54:33] INFO Train time: 431.19877s. Valid time: 7.13310s. GPU RAM: 9.34/23.70 GB
[2023-06-01 13:54:33] INFO Current learning rate : 0.001
[2023-06-01 13:54:36] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 13:54:36] INFO mrr@100 improved. Best value: 0.3491
[2023-06-01 14:01:54] INFO Training: Epoch= 19 [mrr@100=0.3501 recall@100=0.6813 precision@100=0.0068 ndcg@100=0.4191 train_loss_0=4.4474]
[2023-06-01 14:01:54] INFO Train time: 432.14490s. Valid time: 6.10944s. GPU RAM: 9.34/23.70 GB
[2023-06-01 14:01:54] INFO Current learning rate : 0.001
[2023-06-01 14:01:56] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 14:01:56] INFO mrr@100 improved. Best value: 0.3501
[2023-06-01 14:09:17] INFO Training: Epoch= 20 [mrr@100=0.3511 recall@100=0.6833 precision@100=0.0068 ndcg@100=0.4202 train_loss_0=4.4127]
[2023-06-01 14:09:17] INFO Train time: 435.13823s. Valid time: 5.91361s. GPU RAM: 9.34/23.70 GB
[2023-06-01 14:09:17] INFO Current learning rate : 0.001
[2023-06-01 14:09:19] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 14:09:19] INFO mrr@100 improved. Best value: 0.3511
[2023-06-01 14:16:37] INFO Training: Epoch= 21 [mrr@100=0.3527 recall@100=0.6846 precision@100=0.0068 ndcg@100=0.4218 train_loss_0=4.3804]
[2023-06-01 14:16:37] INFO Train time: 429.78373s. Valid time: 7.87704s. GPU RAM: 9.34/23.70 GB
[2023-06-01 14:16:37] INFO Current learning rate : 0.001
[2023-06-01 14:16:38] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 14:16:38] INFO mrr@100 improved. Best value: 0.3527
[2023-06-01 14:23:58] INFO Training: Epoch= 22 [mrr@100=0.3528 recall@100=0.6867 precision@100=0.0069 ndcg@100=0.4223 train_loss_0=4.3488]
[2023-06-01 14:23:58] INFO Train time: 432.26063s. Valid time: 7.52609s. GPU RAM: 9.34/23.70 GB
[2023-06-01 14:23:58] INFO Current learning rate : 0.001
[2023-06-01 14:24:00] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 14:24:00] INFO mrr@100 improved. Best value: 0.3528
[2023-06-01 14:31:20] INFO Training: Epoch= 23 [mrr@100=0.3540 recall@100=0.6887 precision@100=0.0069 ndcg@100=0.4237 train_loss_0=4.3189]
[2023-06-01 14:31:20] INFO Train time: 432.91783s. Valid time: 6.46868s. GPU RAM: 9.34/23.70 GB
[2023-06-01 14:31:20] INFO Current learning rate : 0.001
[2023-06-01 14:31:22] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 14:31:22] INFO mrr@100 improved. Best value: 0.3540
[2023-06-01 14:38:43] INFO Training: Epoch= 24 [mrr@100=0.3549 recall@100=0.6894 precision@100=0.0069 ndcg@100=0.4246 train_loss_0=4.2901]
[2023-06-01 14:38:43] INFO Train time: 434.70041s. Valid time: 6.58511s. GPU RAM: 9.34/23.70 GB
[2023-06-01 14:38:43] INFO Current learning rate : 0.001
[2023-06-01 14:38:45] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 14:38:45] INFO mrr@100 improved. Best value: 0.3549
[2023-06-01 14:46:04] INFO Training: Epoch= 25 [mrr@100=0.3550 recall@100=0.6908 precision@100=0.0069 ndcg@100=0.4249 train_loss_0=4.2628]
[2023-06-01 14:46:04] INFO Train time: 432.46065s. Valid time: 6.57384s. GPU RAM: 9.34/23.70 GB
[2023-06-01 14:46:04] INFO Current learning rate : 0.001
[2023-06-01 14:46:07] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 14:46:07] INFO mrr@100 improved. Best value: 0.3550
[2023-06-01 14:53:31] INFO Training: Epoch= 26 [mrr@100=0.3554 recall@100=0.6912 precision@100=0.0069 ndcg@100=0.4254 train_loss_0=4.2373]
[2023-06-01 14:53:31] INFO Train time: 438.45849s. Valid time: 5.83817s. GPU RAM: 9.34/23.70 GB
[2023-06-01 14:53:31] INFO Current learning rate : 0.001
[2023-06-01 14:53:33] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 14:53:33] INFO mrr@100 improved. Best value: 0.3554
[2023-06-01 15:00:55] INFO Training: Epoch= 27 [mrr@100=0.3573 recall@100=0.6925 precision@100=0.0069 ndcg@100=0.4272 train_loss_0=4.2118]
[2023-06-01 15:00:55] INFO Train time: 435.48641s. Valid time: 6.95604s. GPU RAM: 9.34/23.70 GB
[2023-06-01 15:00:55] INFO Current learning rate : 0.001
[2023-06-01 15:00:58] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 15:00:58] INFO mrr@100 improved. Best value: 0.3573
[2023-06-01 15:08:14] INFO Training: Epoch= 28 [mrr@100=0.3570 recall@100=0.6935 precision@100=0.0069 ndcg@100=0.4271 train_loss_0=4.1888]
[2023-06-01 15:08:14] INFO Train time: 429.42096s. Valid time: 6.70537s. GPU RAM: 9.34/23.70 GB
[2023-06-01 15:08:14] INFO Current learning rate : 0.001
[2023-06-01 15:15:31] INFO Training: Epoch= 29 [mrr@100=0.3569 recall@100=0.6936 precision@100=0.0069 ndcg@100=0.4271 train_loss_0=4.1659]
[2023-06-01 15:15:31] INFO Train time: 430.97656s. Valid time: 6.60839s. GPU RAM: 9.34/23.70 GB
[2023-06-01 15:15:31] INFO Current learning rate : 0.001
[2023-06-01 15:22:52] INFO Training: Epoch= 30 [mrr@100=0.3578 recall@100=0.6952 precision@100=0.0070 ndcg@100=0.4281 train_loss_0=4.1445]
[2023-06-01 15:22:52] INFO Train time: 433.99155s. Valid time: 6.30759s. GPU RAM: 9.34/23.70 GB
[2023-06-01 15:22:52] INFO Current learning rate : 0.001
[2023-06-01 15:22:54] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 15:22:54] INFO mrr@100 improved. Best value: 0.3578
[2023-06-01 15:30:15] INFO Training: Epoch= 31 [mrr@100=0.3577 recall@100=0.6949 precision@100=0.0069 ndcg@100=0.4280 train_loss_0=4.1242]
[2023-06-01 15:30:15] INFO Train time: 434.10469s. Valid time: 7.18377s. GPU RAM: 9.34/23.70 GB
[2023-06-01 15:30:15] INFO Current learning rate : 0.001
[2023-06-01 15:37:55] INFO Training: Epoch= 32 [mrr@100=0.3581 recall@100=0.6962 precision@100=0.0070 ndcg@100=0.4286 train_loss_0=4.1059]
[2023-06-01 15:37:55] INFO Train time: 452.40212s. Valid time: 7.42475s. GPU RAM: 9.34/23.70 GB
[2023-06-01 15:37:55] INFO Current learning rate : 0.001
[2023-06-01 15:37:57] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 15:37:57] INFO mrr@100 improved. Best value: 0.3581
[2023-06-01 15:45:55] INFO Training: Epoch= 33 [mrr@100=0.3581 recall@100=0.6957 precision@100=0.0070 ndcg@100=0.4285 train_loss_0=4.0882]
[2023-06-01 15:45:55] INFO Train time: 469.09239s. Valid time: 8.14814s. GPU RAM: 9.34/23.70 GB
[2023-06-01 15:45:55] INFO Current learning rate : 0.001
[2023-06-01 15:45:57] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 15:45:57] INFO mrr@100 improved. Best value: 0.3581
[2023-06-01 15:54:18] INFO Training: Epoch= 34 [mrr@100=0.3581 recall@100=0.6965 precision@100=0.0070 ndcg@100=0.4287 train_loss_0=4.0712]
[2023-06-01 15:54:18] INFO Train time: 490.71417s. Valid time: 9.87033s. GPU RAM: 9.34/23.70 GB
[2023-06-01 15:54:18] INFO Current learning rate : 0.001
[2023-06-01 15:54:20] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 15:54:20] INFO mrr@100 improved. Best value: 0.3581
[2023-06-01 16:02:35] INFO Training: Epoch= 35 [mrr@100=0.3584 recall@100=0.6964 precision@100=0.0070 ndcg@100=0.4289 train_loss_0=4.0546]
[2023-06-01 16:02:35] INFO Train time: 487.34979s. Valid time: 8.07663s. GPU RAM: 9.34/23.70 GB
[2023-06-01 16:02:35] INFO Current learning rate : 0.001
[2023-06-01 16:02:38] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 16:02:38] INFO mrr@100 improved. Best value: 0.3584
[2023-06-01 16:11:03] INFO Training: Epoch= 36 [mrr@100=0.3586 recall@100=0.6975 precision@100=0.0070 ndcg@100=0.4293 train_loss_0=4.0400]
[2023-06-01 16:11:03] INFO Train time: 496.57298s. Valid time: 8.33333s. GPU RAM: 9.34/23.70 GB
[2023-06-01 16:11:03] INFO Current learning rate : 0.001
[2023-06-01 16:11:05] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 16:11:05] INFO mrr@100 improved. Best value: 0.3586
[2023-06-01 16:19:09] INFO Training: Epoch= 37 [mrr@100=0.3581 recall@100=0.6971 precision@100=0.0070 ndcg@100=0.4288 train_loss_0=4.0245]
[2023-06-01 16:19:09] INFO Train time: 474.49953s. Valid time: 8.66821s. GPU RAM: 9.34/23.70 GB
[2023-06-01 16:19:09] INFO Current learning rate : 0.001
[2023-06-01 16:27:00] INFO Training: Epoch= 38 [mrr@100=0.3584 recall@100=0.6968 precision@100=0.0070 ndcg@100=0.4290 train_loss_0=4.0111]
[2023-06-01 16:27:00] INFO Train time: 465.63992s. Valid time: 6.25952s. GPU RAM: 9.34/23.70 GB
[2023-06-01 16:27:00] INFO Current learning rate : 0.001
[2023-06-01 16:34:25] INFO Training: Epoch= 39 [mrr@100=0.3586 recall@100=0.6981 precision@100=0.0070 ndcg@100=0.4294 train_loss_0=3.9979]
[2023-06-01 16:34:25] INFO Train time: 437.32167s. Valid time: 6.77016s. GPU RAM: 9.34/23.70 GB
[2023-06-01 16:34:25] INFO Current learning rate : 0.001
[2023-06-01 16:34:26] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 16:34:26] INFO mrr@100 improved. Best value: 0.3586
[2023-06-01 16:41:44] INFO Training: Epoch= 40 [mrr@100=0.3583 recall@100=0.6980 precision@100=0.0070 ndcg@100=0.4292 train_loss_0=3.9856]
[2023-06-01 16:41:44] INFO Train time: 431.59701s. Valid time: 6.53403s. GPU RAM: 9.34/23.70 GB
[2023-06-01 16:41:44] INFO Current learning rate : 0.001
[2023-06-01 16:49:09] INFO Training: Epoch= 41 [mrr@100=0.3582 recall@100=0.6978 precision@100=0.0070 ndcg@100=0.4290 train_loss_0=3.9729]
[2023-06-01 16:49:09] INFO Train time: 436.14172s. Valid time: 8.80420s. GPU RAM: 9.34/23.70 GB
[2023-06-01 16:49:09] INFO Current learning rate : 0.001
[2023-06-01 16:56:54] INFO Training: Epoch= 42 [mrr@100=0.3588 recall@100=0.6978 precision@100=0.0070 ndcg@100=0.4295 train_loss_0=3.9611]
[2023-06-01 16:56:54] INFO Train time: 457.23141s. Valid time: 7.35743s. GPU RAM: 9.34/23.70 GB
[2023-06-01 16:56:54] INFO Current learning rate : 0.001
[2023-06-01 16:56:56] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 16:56:56] INFO mrr@100 improved. Best value: 0.3588
[2023-06-01 17:04:50] INFO Training: Epoch= 43 [mrr@100=0.3592 recall@100=0.6983 precision@100=0.0070 ndcg@100=0.4299 train_loss_0=3.9514]
[2023-06-01 17:04:50] INFO Train time: 466.82483s. Valid time: 6.81495s. GPU RAM: 9.34/23.70 GB
[2023-06-01 17:04:50] INFO Current learning rate : 0.001
[2023-06-01 17:04:52] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 17:04:52] INFO mrr@100 improved. Best value: 0.3592
[2023-06-01 17:12:53] INFO Training: Epoch= 44 [mrr@100=0.3591 recall@100=0.6976 precision@100=0.0070 ndcg@100=0.4297 train_loss_0=3.9395]
[2023-06-01 17:12:53] INFO Train time: 474.40755s. Valid time: 6.79230s. GPU RAM: 9.34/23.70 GB
[2023-06-01 17:12:53] INFO Current learning rate : 0.001
[2023-06-01 17:20:45] INFO Training: Epoch= 45 [mrr@100=0.3590 recall@100=0.6985 precision@100=0.0070 ndcg@100=0.4297 train_loss_0=3.9297]
[2023-06-01 17:20:45] INFO Train time: 463.32173s. Valid time: 7.93432s. GPU RAM: 9.34/23.70 GB
[2023-06-01 17:20:45] INFO Current learning rate : 0.001
[2023-06-01 17:28:32] INFO Training: Epoch= 46 [mrr@100=0.3584 recall@100=0.6973 precision@100=0.0070 ndcg@100=0.4291 train_loss_0=3.9209]
[2023-06-01 17:28:32] INFO Train time: 460.22733s. Valid time: 7.29760s. GPU RAM: 9.34/23.70 GB
[2023-06-01 17:28:32] INFO Current learning rate : 0.0005
[2023-06-01 17:36:22] INFO Training: Epoch= 47 [mrr@100=0.3599 recall@100=0.6985 precision@100=0.0070 ndcg@100=0.4306 train_loss_0=3.8551]
[2023-06-01 17:36:22] INFO Train time: 461.90883s. Valid time: 7.67929s. GPU RAM: 9.34/23.70 GB
[2023-06-01 17:36:22] INFO Current learning rate : 0.0005
[2023-06-01 17:36:23] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 17:36:23] INFO mrr@100 improved. Best value: 0.3599
[2023-06-01 17:43:58] INFO Training: Epoch= 48 [mrr@100=0.3594 recall@100=0.6982 precision@100=0.0070 ndcg@100=0.4301 train_loss_0=3.8437]
[2023-06-01 17:43:58] INFO Train time: 447.69605s. Valid time: 6.56700s. GPU RAM: 9.34/23.70 GB
[2023-06-01 17:43:58] INFO Current learning rate : 0.0005
[2023-06-01 17:51:15] INFO Training: Epoch= 49 [mrr@100=0.3599 recall@100=0.6985 precision@100=0.0070 ndcg@100=0.4306 train_loss_0=3.8362]
[2023-06-01 17:51:15] INFO Train time: 429.99796s. Valid time: 7.15258s. GPU RAM: 9.34/23.70 GB
[2023-06-01 17:51:15] INFO Current learning rate : 0.0005
[2023-06-01 17:51:17] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 17:51:17] INFO mrr@100 improved. Best value: 0.3599
[2023-06-01 17:58:34] INFO Training: Epoch= 50 [mrr@100=0.3605 recall@100=0.6986 precision@100=0.0070 ndcg@100=0.4311 train_loss_0=3.8289]
[2023-06-01 17:58:34] INFO Train time: 430.01526s. Valid time: 6.88999s. GPU RAM: 9.34/23.70 GB
[2023-06-01 17:58:34] INFO Current learning rate : 0.0005
[2023-06-01 17:58:36] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 17:58:36] INFO mrr@100 improved. Best value: 0.3605
[2023-06-01 18:05:54] INFO Training: Epoch= 51 [mrr@100=0.3602 recall@100=0.6984 precision@100=0.0070 ndcg@100=0.4308 train_loss_0=3.8236]
[2023-06-01 18:05:54] INFO Train time: 431.11115s. Valid time: 6.45189s. GPU RAM: 9.34/23.70 GB
[2023-06-01 18:05:54] INFO Current learning rate : 0.0005
[2023-06-01 18:13:11] INFO Training: Epoch= 52 [mrr@100=0.3598 recall@100=0.6985 precision@100=0.0070 ndcg@100=0.4305 train_loss_0=3.8170]
[2023-06-01 18:13:11] INFO Train time: 431.00334s. Valid time: 6.25347s. GPU RAM: 9.34/23.70 GB
[2023-06-01 18:13:11] INFO Current learning rate : 0.0005
[2023-06-01 18:20:27] INFO Training: Epoch= 53 [mrr@100=0.3600 recall@100=0.6986 precision@100=0.0070 ndcg@100=0.4307 train_loss_0=3.8116]
[2023-06-01 18:20:27] INFO Train time: 428.79844s. Valid time: 6.39167s. GPU RAM: 9.34/23.70 GB
[2023-06-01 18:20:27] INFO Current learning rate : 0.00025
[2023-06-01 18:27:41] INFO Training: Epoch= 54 [mrr@100=0.3602 recall@100=0.6994 precision@100=0.0070 ndcg@100=0.4310 train_loss_0=3.7751]
[2023-06-01 18:27:41] INFO Train time: 428.08382s. Valid time: 6.10140s. GPU RAM: 9.34/23.70 GB
[2023-06-01 18:27:41] INFO Current learning rate : 0.00025
[2023-06-01 18:34:54] INFO Training: Epoch= 55 [mrr@100=0.3606 recall@100=0.6995 precision@100=0.0070 ndcg@100=0.4313 train_loss_0=3.7691]
[2023-06-01 18:34:54] INFO Train time: 426.26503s. Valid time: 6.91497s. GPU RAM: 9.34/23.70 GB
[2023-06-01 18:34:54] INFO Current learning rate : 0.00025
[2023-06-01 18:34:56] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 18:34:56] INFO mrr@100 improved. Best value: 0.3606
[2023-06-01 18:42:10] INFO Training: Epoch= 56 [mrr@100=0.3604 recall@100=0.6992 precision@100=0.0070 ndcg@100=0.4311 train_loss_0=3.7661]
[2023-06-01 18:42:10] INFO Train time: 427.43801s. Valid time: 6.47376s. GPU RAM: 9.34/23.70 GB
[2023-06-01 18:42:10] INFO Current learning rate : 0.00025
[2023-06-01 18:49:24] INFO Training: Epoch= 57 [mrr@100=0.3606 recall@100=0.6989 precision@100=0.0070 ndcg@100=0.4312 train_loss_0=3.7617]
[2023-06-01 18:49:24] INFO Train time: 427.05984s. Valid time: 6.47524s. GPU RAM: 9.34/23.70 GB
[2023-06-01 18:49:24] INFO Current learning rate : 0.00025
[2023-06-01 18:49:26] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 18:49:26] INFO mrr@100 improved. Best value: 0.3606
[2023-06-01 18:56:39] INFO Training: Epoch= 58 [mrr@100=0.3606 recall@100=0.6994 precision@100=0.0070 ndcg@100=0.4313 train_loss_0=3.7584]
[2023-06-01 18:56:39] INFO Train time: 426.73080s. Valid time: 6.76981s. GPU RAM: 9.34/23.70 GB
[2023-06-01 18:56:39] INFO Current learning rate : 0.000125
[2023-06-01 19:03:51] INFO Training: Epoch= 59 [mrr@100=0.3604 recall@100=0.6991 precision@100=0.0070 ndcg@100=0.4311 train_loss_0=3.7395]
[2023-06-01 19:03:51] INFO Train time: 424.59287s. Valid time: 6.61292s. GPU RAM: 9.34/23.70 GB
[2023-06-01 19:03:51] INFO Current learning rate : 0.000125
[2023-06-01 19:10:59] INFO Training: Epoch= 60 [mrr@100=0.3603 recall@100=0.6995 precision@100=0.0070 ndcg@100=0.4311 train_loss_0=3.7363]
[2023-06-01 19:10:59] INFO Train time: 422.29144s. Valid time: 6.36402s. GPU RAM: 9.34/23.70 GB
[2023-06-01 19:10:59] INFO Current learning rate : 0.000125
[2023-06-01 19:18:08] INFO Training: Epoch= 61 [mrr@100=0.3603 recall@100=0.6993 precision@100=0.0070 ndcg@100=0.4311 train_loss_0=3.7338]
[2023-06-01 19:18:08] INFO Train time: 422.93520s. Valid time: 6.29772s. GPU RAM: 9.34/23.70 GB
[2023-06-01 19:18:08] INFO Current learning rate : 6.25e-05
[2023-06-01 19:25:18] INFO Training: Epoch= 62 [mrr@100=0.3604 recall@100=0.6994 precision@100=0.0070 ndcg@100=0.4312 train_loss_0=3.7244]
[2023-06-01 19:25:18] INFO Train time: 423.66026s. Valid time: 6.15766s. GPU RAM: 9.34/23.70 GB
[2023-06-01 19:25:18] INFO Current learning rate : 6.25e-05
[2023-06-01 19:32:29] INFO Training: Epoch= 63 [mrr@100=0.3603 recall@100=0.6993 precision@100=0.0070 ndcg@100=0.4311 train_loss_0=3.7226]
[2023-06-01 19:32:29] INFO Train time: 424.50113s. Valid time: 6.46070s. GPU RAM: 9.34/23.70 GB
[2023-06-01 19:32:29] INFO Current learning rate : 6.25e-05
[2023-06-01 19:39:39] INFO Training: Epoch= 64 [mrr@100=0.3604 recall@100=0.6993 precision@100=0.0070 ndcg@100=0.4311 train_loss_0=3.7218]
[2023-06-01 19:39:39] INFO Train time: 423.12923s. Valid time: 6.67407s. GPU RAM: 9.34/23.70 GB
[2023-06-01 19:39:39] INFO Current learning rate : 3.125e-05
[2023-06-01 19:46:49] INFO Training: Epoch= 65 [mrr@100=0.3605 recall@100=0.6994 precision@100=0.0070 ndcg@100=0.4312 train_loss_0=3.7158]
[2023-06-01 19:46:49] INFO Train time: 423.86928s. Valid time: 6.28990s. GPU RAM: 9.34/23.70 GB
[2023-06-01 19:46:49] INFO Current learning rate : 3.125e-05
[2023-06-01 19:53:58] INFO Training: Epoch= 66 [mrr@100=0.3604 recall@100=0.6992 precision@100=0.0070 ndcg@100=0.4311 train_loss_0=3.7150]
[2023-06-01 19:53:58] INFO Train time: 422.65729s. Valid time: 5.98379s. GPU RAM: 9.34/23.70 GB
[2023-06-01 19:53:58] INFO Current learning rate : 3.125e-05
[2023-06-01 20:01:04] INFO Training: Epoch= 67 [mrr@100=0.3604 recall@100=0.6992 precision@100=0.0070 ndcg@100=0.4312 train_loss_0=3.7154]
[2023-06-01 20:01:04] INFO Train time: 419.98958s. Valid time: 6.02985s. GPU RAM: 9.34/23.70 GB
[2023-06-01 20:01:04] INFO Current learning rate : 1.5625e-05
[2023-06-01 20:01:04] INFO Early stopped. Since the metric mrr@100 haven't been improved for 10 epochs.
[2023-06-01 20:01:04] INFO The best score of mrr@100 is 0.3606 on epoch 57
[2023-06-01 20:01:05] INFO Best model checkpoint saved in ./saved/SASRec_Next_Feat/kdd_cup_2023_JP/2023-06-01-11-34-52.ckpt.
[2023-06-01 20:01:12] INFO Testing:  [recall@100=0.6989 precision@100=0.0070 map@100=0.3606 ndcg@100=0.4312 mrr@100=0.3606 hit@100=0.6989 recall@200=0.7316 precision@200=0.0037 map@200=0.3609 ndcg@200=0.4358 mrr@200=0.3609 hit@200=0.7316 recall@300=0.7471 precision@300=0.0025 map@300=0.3609 ndcg@300=0.4378 mrr@300=0.3609 hit@300=0.7471]
