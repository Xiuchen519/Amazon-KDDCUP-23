[2023-05-30 20:23:17] INFO Log saved in /root/autodl-tmp/xiaolong/WorkSpace/Amazon-KDDCUP-23/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.log.
[2023-05-30 20:23:17] INFO Global seed set to 2022
[2023-05-30 20:23:17] INFO Load dataset from cache ./.recstudio/cache/2536617955df215e0047f5b220d1c012
[2023-05-30 20:23:28] INFO 
Dataset Info: 

==================================================================
item information: 
field      product_id JP_index   
type       token      float      
##         395010     -          
==================================================================
user information: 
field      sess_id    
type       token      
##         1192054    
==================================================================
interaction information: 
field      rating     sess_id    product_id timestamp  locale     
type       float      token      token      float      token      
##         -          1192054    395010     -          2          
==================================================================
Total Interactions: 6218923
Sparsity: 0.999987
==================================================================
[2023-05-30 20:23:28] INFO 
Model Config: 

data:
	binarized_rating_thres=None
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=True
	split_mode=user
	split_ratio=[1.0]
	test_rep=True
	train_rep=True
eval:
	batch_size=1024
	cutoff=[100, 200, 300]
	val_metrics=['mrr', 'recall', 'precision', 'ndcg']
	val_n_epoch=1
	test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
	topk=300
	save_path=./saved/
	num_workers=8
	predict_topk=100
model:
	embed_dim=128
	item_bias=False
	hidden_size=256
	dropout_rate=0.5
	layer_num=2
	loss_func=softmax
train:
	accelerator=gpu
	ann=None
	batch_size=1024
	early_stop_mode=max
	early_stop_patience=10
	epochs=100
	gpu=0
	grad_clip_norm=None
	init_method=default
	init_range=0.02
	item_batch_size=1024
	learner=adam
	learning_rate=0.001
	num_threads=10
	num_workers=8
	sampling_method=none
	sampler=uniform
	negative_count=None
	excluding_hist=False
	scheduler=onplateau
	scheduler_patience=2
	scheduler_factor=0.5
	seed=2022
	weight_decay=0.0
	tensorboard_path=None
	use_wandb=False
	wandb_project=None
	wandb_count=0
[2023-05-30 20:23:29] INFO save_dir:./saved/
[2023-05-30 20:23:29] INFO GRU4Rec_Next(
  (score_func): InnerProductScorer()
  (loss_fn): SoftmaxLoss()
  (item_encoder): Embedding(395010, 128, padding_idx=0)
  (query_encoder): VStackLayer(
    (0): HStackLayer(
      (0): Sequential(
        (0): LambdaLayer()
        (1): Embedding(395010, 128, padding_idx=0)
        (2): Dropout(p=0.5, inplace=False)
        (3): GRULayer(
          (gru): GRU(128, 256, num_layers=2, bias=False, batch_first=True)
        )
      )
      (1): LambdaLayer()
    )
    (1): SeqPoolingLayer(pooling_type=last, keepdim=False)
    (2): Linear(in_features=256, out_features=128, bias=True)
  )
)
[2023-05-30 20:23:29] INFO GPU id [0] are selected.
[2023-05-30 20:28:36] INFO Training: Epoch=  0 [mrr@100=0.0373 recall@100=0.0902 precision@100=0.0009 ndcg@100=0.0476 train_loss_0=11.1518]
[2023-05-30 20:28:36] INFO Train time: 297.71836s. Valid time: 5.43227s. GPU RAM: 8.13/23.70 GB
[2023-05-30 20:28:36] INFO Current learning rate : 0.001
[2023-05-30 20:28:36] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 20:28:36] INFO mrr@100 improved. Best value: 0.0373
[2023-05-30 20:33:39] INFO Training: Epoch=  1 [mrr@100=0.1130 recall@100=0.2227 precision@100=0.0022 ndcg@100=0.1352 train_loss_0=9.7395]
[2023-05-30 20:33:39] INFO Train time: 297.28794s. Valid time: 5.55570s. GPU RAM: 8.13/23.70 GB
[2023-05-30 20:33:39] INFO Current learning rate : 0.001
[2023-05-30 20:33:40] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 20:33:40] INFO mrr@100 improved. Best value: 0.1130
[2023-05-30 20:38:22] INFO Training: Epoch=  2 [mrr@100=0.1705 recall@100=0.3199 precision@100=0.0032 ndcg@100=0.2015 train_loss_0=8.6560]
[2023-05-30 20:38:22] INFO Train time: 275.99390s. Valid time: 5.32730s. GPU RAM: 8.13/23.70 GB
[2023-05-30 20:38:22] INFO Current learning rate : 0.001
[2023-05-30 20:38:23] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 20:38:23] INFO mrr@100 improved. Best value: 0.1705
[2023-05-30 20:42:52] INFO Training: Epoch=  3 [mrr@100=0.2113 recall@100=0.3938 precision@100=0.0039 ndcg@100=0.2495 train_loss_0=7.8091]
[2023-05-30 20:42:52] INFO Train time: 264.56297s. Valid time: 5.00361s. GPU RAM: 8.13/23.70 GB
[2023-05-30 20:42:52] INFO Current learning rate : 0.001
[2023-05-30 20:42:53] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 20:42:53] INFO mrr@100 improved. Best value: 0.2113
[2023-05-30 20:47:22] INFO Training: Epoch=  4 [mrr@100=0.2391 recall@100=0.4491 precision@100=0.0045 ndcg@100=0.2832 train_loss_0=7.1559]
[2023-05-30 20:47:22] INFO Train time: 263.75864s. Valid time: 5.61192s. GPU RAM: 8.13/23.70 GB
[2023-05-30 20:47:22] INFO Current learning rate : 0.001
[2023-05-30 20:47:23] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 20:47:23] INFO mrr@100 improved. Best value: 0.2391
[2023-05-30 20:51:52] INFO Training: Epoch=  5 [mrr@100=0.2603 recall@100=0.4912 precision@100=0.0049 ndcg@100=0.3089 train_loss_0=6.6486]
[2023-05-30 20:51:52] INFO Train time: 263.27705s. Valid time: 5.16120s. GPU RAM: 8.13/23.70 GB
[2023-05-30 20:51:52] INFO Current learning rate : 0.001
[2023-05-30 20:51:53] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 20:51:53] INFO mrr@100 improved. Best value: 0.2603
[2023-05-30 20:56:24] INFO Training: Epoch=  6 [mrr@100=0.2760 recall@100=0.5244 precision@100=0.0052 ndcg@100=0.3283 train_loss_0=6.2480]
[2023-05-30 20:56:24] INFO Train time: 264.97876s. Valid time: 5.50135s. GPU RAM: 8.13/23.70 GB
[2023-05-30 20:56:24] INFO Current learning rate : 0.001
[2023-05-30 20:56:25] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 20:56:25] INFO mrr@100 improved. Best value: 0.2760
[2023-05-30 21:01:27] INFO Training: Epoch=  7 [mrr@100=0.2880 recall@100=0.5516 precision@100=0.0055 ndcg@100=0.3435 train_loss_0=5.9266]
[2023-05-30 21:01:27] INFO Train time: 297.03675s. Valid time: 5.55021s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:01:27] INFO Current learning rate : 0.001
[2023-05-30 21:01:28] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:01:28] INFO mrr@100 improved. Best value: 0.2880
[2023-05-30 21:06:34] INFO Training: Epoch=  8 [mrr@100=0.2970 recall@100=0.5722 precision@100=0.0057 ndcg@100=0.3548 train_loss_0=5.6656]
[2023-05-30 21:06:34] INFO Train time: 299.98641s. Valid time: 5.53825s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:06:34] INFO Current learning rate : 0.001
[2023-05-30 21:06:35] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:06:35] INFO mrr@100 improved. Best value: 0.2970
[2023-05-30 21:11:42] INFO Training: Epoch=  9 [mrr@100=0.3058 recall@100=0.5898 precision@100=0.0059 ndcg@100=0.3656 train_loss_0=5.4498]
[2023-05-30 21:11:42] INFO Train time: 301.15943s. Valid time: 5.75727s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:11:42] INFO Current learning rate : 0.001
[2023-05-30 21:11:42] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:11:42] INFO mrr@100 improved. Best value: 0.3058
[2023-05-30 21:16:48] INFO Training: Epoch= 10 [mrr@100=0.3123 recall@100=0.6040 precision@100=0.0060 ndcg@100=0.3736 train_loss_0=5.2672]
[2023-05-30 21:16:48] INFO Train time: 300.29702s. Valid time: 5.65494s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:16:48] INFO Current learning rate : 0.001
[2023-05-30 21:16:49] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:16:49] INFO mrr@100 improved. Best value: 0.3123
[2023-05-30 21:21:55] INFO Training: Epoch= 11 [mrr@100=0.3167 recall@100=0.6156 precision@100=0.0062 ndcg@100=0.3794 train_loss_0=5.1146]
[2023-05-30 21:21:55] INFO Train time: 300.11686s. Valid time: 5.68449s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:21:55] INFO Current learning rate : 0.001
[2023-05-30 21:21:56] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:21:56] INFO mrr@100 improved. Best value: 0.3167
[2023-05-30 21:27:01] INFO Training: Epoch= 12 [mrr@100=0.3215 recall@100=0.6240 precision@100=0.0062 ndcg@100=0.3850 train_loss_0=4.9826]
[2023-05-30 21:27:01] INFO Train time: 299.07849s. Valid time: 5.72535s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:27:01] INFO Current learning rate : 0.001
[2023-05-30 21:27:02] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:27:02] INFO mrr@100 improved. Best value: 0.3215
[2023-05-30 21:32:08] INFO Training: Epoch= 13 [mrr@100=0.3246 recall@100=0.6323 precision@100=0.0063 ndcg@100=0.3892 train_loss_0=4.8673]
[2023-05-30 21:32:08] INFO Train time: 300.32644s. Valid time: 5.44156s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:32:08] INFO Current learning rate : 0.001
[2023-05-30 21:32:09] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:32:09] INFO mrr@100 improved. Best value: 0.3246
[2023-05-30 21:37:14] INFO Training: Epoch= 14 [mrr@100=0.3281 recall@100=0.6394 precision@100=0.0064 ndcg@100=0.3934 train_loss_0=4.7657]
[2023-05-30 21:37:14] INFO Train time: 299.47184s. Valid time: 5.66098s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:37:14] INFO Current learning rate : 0.001
[2023-05-30 21:37:15] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:37:15] INFO mrr@100 improved. Best value: 0.3281
[2023-05-30 21:42:21] INFO Training: Epoch= 15 [mrr@100=0.3307 recall@100=0.6445 precision@100=0.0064 ndcg@100=0.3965 train_loss_0=4.6771]
[2023-05-30 21:42:21] INFO Train time: 299.96181s. Valid time: 5.67749s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:42:21] INFO Current learning rate : 0.001
[2023-05-30 21:42:22] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:42:22] INFO mrr@100 improved. Best value: 0.3307
[2023-05-30 21:47:28] INFO Training: Epoch= 16 [mrr@100=0.3331 recall@100=0.6501 precision@100=0.0065 ndcg@100=0.3996 train_loss_0=4.5974]
[2023-05-30 21:47:28] INFO Train time: 300.30184s. Valid time: 5.64591s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:47:28] INFO Current learning rate : 0.001
[2023-05-30 21:47:29] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:47:29] INFO mrr@100 improved. Best value: 0.3331
[2023-05-30 21:52:35] INFO Training: Epoch= 17 [mrr@100=0.3358 recall@100=0.6534 precision@100=0.0065 ndcg@100=0.4024 train_loss_0=4.5248]
[2023-05-30 21:52:35] INFO Train time: 300.08511s. Valid time: 6.02029s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:52:35] INFO Current learning rate : 0.001
[2023-05-30 21:52:36] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:52:36] INFO mrr@100 improved. Best value: 0.3358
[2023-05-30 21:57:44] INFO Training: Epoch= 18 [mrr@100=0.3364 recall@100=0.6573 precision@100=0.0066 ndcg@100=0.4037 train_loss_0=4.4590]
[2023-05-30 21:57:44] INFO Train time: 302.00802s. Valid time: 5.90613s. GPU RAM: 8.13/23.70 GB
[2023-05-30 21:57:44] INFO Current learning rate : 0.001
[2023-05-30 21:57:45] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 21:57:45] INFO mrr@100 improved. Best value: 0.3364
[2023-05-30 22:02:52] INFO Training: Epoch= 19 [mrr@100=0.3383 recall@100=0.6608 precision@100=0.0066 ndcg@100=0.4059 train_loss_0=4.3996]
[2023-05-30 22:02:52] INFO Train time: 302.16247s. Valid time: 5.78815s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:02:52] INFO Current learning rate : 0.001
[2023-05-30 22:02:53] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:02:53] INFO mrr@100 improved. Best value: 0.3383
[2023-05-30 22:07:28] INFO Training: Epoch= 20 [mrr@100=0.3391 recall@100=0.6632 precision@100=0.0066 ndcg@100=0.4070 train_loss_0=4.3452]
[2023-05-30 22:07:28] INFO Train time: 268.66717s. Valid time: 5.38358s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:07:28] INFO Current learning rate : 0.001
[2023-05-30 22:07:28] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:07:28] INFO mrr@100 improved. Best value: 0.3391
[2023-05-30 22:12:01] INFO Training: Epoch= 21 [mrr@100=0.3399 recall@100=0.6652 precision@100=0.0067 ndcg@100=0.4080 train_loss_0=4.2937]
[2023-05-30 22:12:01] INFO Train time: 266.85355s. Valid time: 5.42218s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:12:01] INFO Current learning rate : 0.001
[2023-05-30 22:12:02] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:12:02] INFO mrr@100 improved. Best value: 0.3399
[2023-05-30 22:16:40] INFO Training: Epoch= 22 [mrr@100=0.3413 recall@100=0.6663 precision@100=0.0067 ndcg@100=0.4094 train_loss_0=4.2471]
[2023-05-30 22:16:40] INFO Train time: 271.69917s. Valid time: 6.26455s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:16:40] INFO Current learning rate : 0.001
[2023-05-30 22:16:41] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:16:41] INFO mrr@100 improved. Best value: 0.3413
[2023-05-30 22:21:14] INFO Training: Epoch= 23 [mrr@100=0.3422 recall@100=0.6680 precision@100=0.0067 ndcg@100=0.4104 train_loss_0=4.2021]
[2023-05-30 22:21:14] INFO Train time: 267.77771s. Valid time: 5.79569s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:21:14] INFO Current learning rate : 0.001
[2023-05-30 22:21:15] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:21:15] INFO mrr@100 improved. Best value: 0.3422
[2023-05-30 22:25:48] INFO Training: Epoch= 24 [mrr@100=0.3422 recall@100=0.6690 precision@100=0.0067 ndcg@100=0.4106 train_loss_0=4.1610]
[2023-05-30 22:25:48] INFO Train time: 267.45519s. Valid time: 5.44942s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:25:48] INFO Current learning rate : 0.001
[2023-05-30 22:30:20] INFO Training: Epoch= 25 [mrr@100=0.3433 recall@100=0.6703 precision@100=0.0067 ndcg@100=0.4117 train_loss_0=4.1226]
[2023-05-30 22:30:20] INFO Train time: 266.60487s. Valid time: 5.68844s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:30:20] INFO Current learning rate : 0.001
[2023-05-30 22:30:21] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:30:21] INFO mrr@100 improved. Best value: 0.3433
[2023-05-30 22:34:54] INFO Training: Epoch= 26 [mrr@100=0.3434 recall@100=0.6701 precision@100=0.0067 ndcg@100=0.4118 train_loss_0=4.0853]
[2023-05-30 22:34:54] INFO Train time: 267.17119s. Valid time: 5.37277s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:34:54] INFO Current learning rate : 0.001
[2023-05-30 22:34:55] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:34:55] INFO mrr@100 improved. Best value: 0.3434
[2023-05-30 22:39:28] INFO Training: Epoch= 27 [mrr@100=0.3441 recall@100=0.6716 precision@100=0.0067 ndcg@100=0.4126 train_loss_0=4.0506]
[2023-05-30 22:39:28] INFO Train time: 267.27615s. Valid time: 5.59906s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:39:28] INFO Current learning rate : 0.001
[2023-05-30 22:39:29] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:39:29] INFO mrr@100 improved. Best value: 0.3441
[2023-05-30 22:44:01] INFO Training: Epoch= 28 [mrr@100=0.3446 recall@100=0.6726 precision@100=0.0067 ndcg@100=0.4133 train_loss_0=4.0174]
[2023-05-30 22:44:01] INFO Train time: 266.53308s. Valid time: 5.67744s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:44:01] INFO Current learning rate : 0.001
[2023-05-30 22:44:02] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 22:44:02] INFO mrr@100 improved. Best value: 0.3446
[2023-05-30 22:48:34] INFO Training: Epoch= 29 [mrr@100=0.3438 recall@100=0.6723 precision@100=0.0067 ndcg@100=0.4126 train_loss_0=3.9859]
[2023-05-30 22:48:34] INFO Train time: 267.13396s. Valid time: 5.38610s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:48:34] INFO Current learning rate : 0.001
[2023-05-30 22:53:05] INFO Training: Epoch= 30 [mrr@100=0.3429 recall@100=0.6728 precision@100=0.0067 ndcg@100=0.4119 train_loss_0=3.9555]
[2023-05-30 22:53:05] INFO Train time: 264.93178s. Valid time: 5.54603s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:53:05] INFO Current learning rate : 0.001
[2023-05-30 22:57:37] INFO Training: Epoch= 31 [mrr@100=0.3429 recall@100=0.6723 precision@100=0.0067 ndcg@100=0.4118 train_loss_0=3.9263]
[2023-05-30 22:57:37] INFO Train time: 265.66398s. Valid time: 6.54629s. GPU RAM: 8.13/23.70 GB
[2023-05-30 22:57:37] INFO Current learning rate : 0.0005
[2023-05-30 23:02:08] INFO Training: Epoch= 32 [mrr@100=0.3468 recall@100=0.6740 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.7879]
[2023-05-30 23:02:08] INFO Train time: 265.63243s. Valid time: 5.45044s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:02:08] INFO Current learning rate : 0.0005
[2023-05-30 23:02:09] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 23:02:09] INFO mrr@100 improved. Best value: 0.3468
[2023-05-30 23:06:41] INFO Training: Epoch= 33 [mrr@100=0.3470 recall@100=0.6734 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.7578]
[2023-05-30 23:06:41] INFO Train time: 265.99710s. Valid time: 5.72144s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:06:41] INFO Current learning rate : 0.0005
[2023-05-30 23:06:42] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 23:06:42] INFO mrr@100 improved. Best value: 0.3470
[2023-05-30 23:11:13] INFO Training: Epoch= 34 [mrr@100=0.3462 recall@100=0.6732 precision@100=0.0067 ndcg@100=0.4147 train_loss_0=3.7378]
[2023-05-30 23:11:13] INFO Train time: 265.75792s. Valid time: 5.57314s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:11:13] INFO Current learning rate : 0.0005
[2023-05-30 23:15:45] INFO Training: Epoch= 35 [mrr@100=0.3462 recall@100=0.6737 precision@100=0.0067 ndcg@100=0.4147 train_loss_0=3.7203]
[2023-05-30 23:15:45] INFO Train time: 265.45329s. Valid time: 5.79157s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:15:45] INFO Current learning rate : 0.0005
[2023-05-30 23:20:15] INFO Training: Epoch= 36 [mrr@100=0.3465 recall@100=0.6733 precision@100=0.0067 ndcg@100=0.4149 train_loss_0=3.7055]
[2023-05-30 23:20:15] INFO Train time: 264.63680s. Valid time: 5.73145s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:20:15] INFO Current learning rate : 0.00025
[2023-05-30 23:24:46] INFO Training: Epoch= 37 [mrr@100=0.3472 recall@100=0.6737 precision@100=0.0067 ndcg@100=0.4155 train_loss_0=3.6280]
[2023-05-30 23:24:46] INFO Train time: 264.68128s. Valid time: 6.15399s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:24:46] INFO Current learning rate : 0.00025
[2023-05-30 23:24:47] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 23:24:47] INFO mrr@100 improved. Best value: 0.3472
[2023-05-30 23:29:18] INFO Training: Epoch= 38 [mrr@100=0.3469 recall@100=0.6733 precision@100=0.0067 ndcg@100=0.4152 train_loss_0=3.6118]
[2023-05-30 23:29:18] INFO Train time: 265.27375s. Valid time: 5.57500s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:29:18] INFO Current learning rate : 0.00025
[2023-05-30 23:33:48] INFO Training: Epoch= 39 [mrr@100=0.3472 recall@100=0.6730 precision@100=0.0067 ndcg@100=0.4154 train_loss_0=3.6014]
[2023-05-30 23:33:48] INFO Train time: 264.77136s. Valid time: 5.25471s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:33:48] INFO Current learning rate : 0.00025
[2023-05-30 23:33:49] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 23:33:49] INFO mrr@100 improved. Best value: 0.3472
[2023-05-30 23:38:21] INFO Training: Epoch= 40 [mrr@100=0.3477 recall@100=0.6725 precision@100=0.0067 ndcg@100=0.4157 train_loss_0=3.5920]
[2023-05-30 23:38:21] INFO Train time: 266.12609s. Valid time: 6.48371s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:38:21] INFO Current learning rate : 0.00025
[2023-05-30 23:38:23] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 23:38:23] INFO mrr@100 improved. Best value: 0.3477
[2023-05-30 23:42:54] INFO Training: Epoch= 41 [mrr@100=0.3473 recall@100=0.6726 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.5838]
[2023-05-30 23:42:54] INFO Train time: 265.89062s. Valid time: 5.45158s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:42:54] INFO Current learning rate : 0.00025
[2023-05-30 23:47:25] INFO Training: Epoch= 42 [mrr@100=0.3467 recall@100=0.6719 precision@100=0.0067 ndcg@100=0.4148 train_loss_0=3.5759]
[2023-05-30 23:47:25] INFO Train time: 265.53974s. Valid time: 5.71396s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:47:25] INFO Current learning rate : 0.00025
[2023-05-30 23:51:56] INFO Training: Epoch= 43 [mrr@100=0.3470 recall@100=0.6722 precision@100=0.0067 ndcg@100=0.4150 train_loss_0=3.5677]
[2023-05-30 23:51:56] INFO Train time: 265.18626s. Valid time: 5.25882s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:51:56] INFO Current learning rate : 0.000125
[2023-05-30 23:56:25] INFO Training: Epoch= 44 [mrr@100=0.3478 recall@100=0.6721 precision@100=0.0067 ndcg@100=0.4156 train_loss_0=3.5248]
[2023-05-30 23:56:25] INFO Train time: 264.32953s. Valid time: 5.50509s. GPU RAM: 8.13/23.70 GB
[2023-05-30 23:56:25] INFO Current learning rate : 0.000125
[2023-05-30 23:56:26] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-30 23:56:26] INFO mrr@100 improved. Best value: 0.3478
[2023-05-31 00:00:58] INFO Training: Epoch= 45 [mrr@100=0.3474 recall@100=0.6717 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.5169]
[2023-05-31 00:00:58] INFO Train time: 265.73249s. Valid time: 5.88009s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:00:58] INFO Current learning rate : 0.000125
[2023-05-31 00:05:31] INFO Training: Epoch= 46 [mrr@100=0.3474 recall@100=0.6717 precision@100=0.0067 ndcg@100=0.4152 train_loss_0=3.5119]
[2023-05-31 00:05:31] INFO Train time: 267.62066s. Valid time: 5.73107s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:05:31] INFO Current learning rate : 0.000125
[2023-05-31 00:10:05] INFO Training: Epoch= 47 [mrr@100=0.3474 recall@100=0.6718 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.5073]
[2023-05-31 00:10:05] INFO Train time: 267.53411s. Valid time: 5.86647s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:10:05] INFO Current learning rate : 6.25e-05
[2023-05-31 00:14:38] INFO Training: Epoch= 48 [mrr@100=0.3476 recall@100=0.6715 precision@100=0.0067 ndcg@100=0.4154 train_loss_0=3.4851]
[2023-05-31 00:14:38] INFO Train time: 267.03339s. Valid time: 6.20632s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:14:38] INFO Current learning rate : 6.25e-05
[2023-05-31 00:19:10] INFO Training: Epoch= 49 [mrr@100=0.3475 recall@100=0.6717 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.4791]
[2023-05-31 00:19:10] INFO Train time: 266.48532s. Valid time: 5.57494s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:19:10] INFO Current learning rate : 6.25e-05
[2023-05-31 00:23:43] INFO Training: Epoch= 50 [mrr@100=0.3472 recall@100=0.6716 precision@100=0.0067 ndcg@100=0.4151 train_loss_0=3.4780]
[2023-05-31 00:23:43] INFO Train time: 266.83651s. Valid time: 5.74321s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:23:43] INFO Current learning rate : 3.125e-05
[2023-05-31 00:28:15] INFO Training: Epoch= 51 [mrr@100=0.3475 recall@100=0.6716 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.4657]
[2023-05-31 00:28:15] INFO Train time: 266.06965s. Valid time: 5.63499s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:28:15] INFO Current learning rate : 3.125e-05
[2023-05-31 00:32:47] INFO Training: Epoch= 52 [mrr@100=0.3475 recall@100=0.6717 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.4639]
[2023-05-31 00:32:47] INFO Train time: 266.37446s. Valid time: 5.70199s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:32:47] INFO Current learning rate : 3.125e-05
[2023-05-31 00:37:18] INFO Training: Epoch= 53 [mrr@100=0.3475 recall@100=0.6716 precision@100=0.0067 ndcg@100=0.4153 train_loss_0=3.4617]
[2023-05-31 00:37:18] INFO Train time: 265.19039s. Valid time: 5.67986s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:37:18] INFO Current learning rate : 1.5625e-05
[2023-05-31 00:41:49] INFO Training: Epoch= 54 [mrr@100=0.3474 recall@100=0.6716 precision@100=0.0067 ndcg@100=0.4152 train_loss_0=3.4557]
[2023-05-31 00:41:49] INFO Train time: 265.43009s. Valid time: 6.11596s. GPU RAM: 8.13/23.70 GB
[2023-05-31 00:41:49] INFO Current learning rate : 1.5625e-05
[2023-05-31 00:41:49] INFO Early stopped. Since the metric mrr@100 haven't been improved for 10 epochs.
[2023-05-31 00:41:49] INFO The best score of mrr@100 is 0.3478 on epoch 44
[2023-05-31 00:41:50] INFO Best model checkpoint saved in ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt.
[2023-05-31 00:41:56] INFO Testing:  [recall@100=0.6721 precision@100=0.0067 map@100=0.3478 ndcg@100=0.4156 mrr@100=0.3478 hit@100=0.6721 recall@200=0.6998 precision@200=0.0035 map@200=0.3480 ndcg@200=0.4195 mrr@200=0.3480 hit@200=0.6998 recall@300=0.7135 precision@300=0.0024 map@300=0.3481 ndcg@300=0.4213 mrr@300=0.3481 hit@300=0.7135]
[2023-05-31 00:42:04] INFO Load checkpoint from ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt
[2023-05-31 00:42:25] INFO Load checkpoint from ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt
[2023-05-31 00:42:50] INFO Load checkpoint from ./saved/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-30-20-23-17.ckpt
[2023-05-31 00:43:11] INFO Prediction is finished, results are saved in ./predictions/GRU4Rec_Next/kdd_cup_2023_JP/2023-05-31-00-41-56.parquet.
