[2023-05-30 00:56:53] INFO Log saved in /root/autodl-tmp/xiaolong/WorkSpace/Amazon-KDDCUP-23/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.log.
[2023-05-30 00:56:53] INFO Global seed set to 2022
[2023-05-30 00:56:53] INFO dataset is read from /root/autodl-tmp/xiaolong/WorkSpace/Amazon-KDDCUP-23/data_for_recstudio/UK_data.
[2023-05-30 01:00:55] INFO start to create item index feat.
[2023-05-30 01:00:57] INFO item index feat is ready.
[2023-05-30 01:04:33] INFO 
Dataset Info: 

==================================================================
item information: 
field      product_id UK_index   
type       token      float      
##         500181     -          
==================================================================
user information: 
field      sess_id    
type       token      
##         1434055    
==================================================================
interaction information: 
field      rating     sess_id    product_id timestamp  locale     
type       float      token      token      float      token      
##         -          1434055    500181     -          2          
==================================================================
Total Interactions: 6963409
Sparsity: 0.999990
==================================================================
[2023-05-30 01:04:33] INFO 
Model Config: 

data:
	binarized_rating_thres=None
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=True
	split_mode=user
	split_ratio=[1.0]
	test_rep=True
	train_rep=True
	max_seq_len=10
eval:
	batch_size=1024
	cutoff=[100, 200, 300]
	val_metrics=['mrr', 'recall', 'precision', 'ndcg']
	val_n_epoch=1
	test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
	topk=300
	save_path=./saved/
	num_workers=8
	predict_topk=100
model:
	embed_dim=128
	item_bias=False
	activation=gelu
	dropout_rate=0.5
	hidden_size=256
	head_num=2
	layer_norm_eps=1e-12
	layer_num=3
	loss_func=softmax
	reverse_pos=1
train:
	accelerator=gpu
	ann=None
	batch_size=1024
	early_stop_mode=max
	early_stop_patience=10
	epochs=300
	gpu=6
	grad_clip_norm=None
	init_method=default
	init_range=0.02
	item_batch_size=1024
	learner=adam
	learning_rate=0.0005
	num_threads=10
	num_workers=8
	sampling_method=none
	sampler=uniform
	negative_count=None
	excluding_hist=False
	scheduler=onplateau
	scheduler_patience=2
	scheduler_factor=0.5
	seed=2022
	weight_decay=0.0
	tensorboard_path=None
	use_wandb=False
	wandb_project=None
	wandb_count=0
	pretrained_embed_file=None
[2023-05-30 01:04:36] INFO save_dir:./saved/
[2023-05-30 01:04:36] INFO SASRec_Next(
  (score_func): InnerProductScorer()
  (loss_fn): SoftmaxLoss()
  (item_encoder): Embedding(500181, 128, padding_idx=0)
  (query_encoder): SASRecQueryEncoder(
    (item_encoder): Embedding(500181, 128, padding_idx=0)
    (position_emb): Embedding(11, 128, padding_idx=0)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.5, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
[2023-05-30 01:04:36] INFO GPU id [6] are selected.
[2023-05-30 01:15:33] INFO Training: Epoch=  0 [mrr@100=0.0004 recall@100=0.0034 precision@100=0.0000 ndcg@100=0.0009 train_loss_0=15.1785]
[2023-05-30 01:15:33] INFO Train time: 632.49836s. Valid time: 20.65629s. GPU RAM: 10.26/23.70 GB
[2023-05-30 01:15:33] INFO Current learning rate : 0.0005
[2023-05-30 01:15:35] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 01:15:35] INFO mrr@100 improved. Best value: 0.0004
[2023-05-30 01:25:58] INFO Training: Epoch=  1 [mrr@100=0.0116 recall@100=0.0312 precision@100=0.0003 ndcg@100=0.0152 train_loss_0=11.8564]
[2023-05-30 01:25:58] INFO Train time: 610.39519s. Valid time: 12.08876s. GPU RAM: 10.27/23.70 GB
[2023-05-30 01:25:58] INFO Current learning rate : 0.0005
[2023-05-30 01:26:00] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 01:26:00] INFO mrr@100 improved. Best value: 0.0116
[2023-05-30 01:36:25] INFO Training: Epoch=  2 [mrr@100=0.0444 recall@100=0.0831 precision@100=0.0008 ndcg@100=0.0520 train_loss_0=11.2877]
[2023-05-30 01:36:25] INFO Train time: 608.44086s. Valid time: 16.89220s. GPU RAM: 10.27/23.70 GB
[2023-05-30 01:36:25] INFO Current learning rate : 0.0005
[2023-05-30 01:36:27] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 01:36:27] INFO mrr@100 improved. Best value: 0.0444
[2023-05-30 01:46:39] INFO Training: Epoch=  3 [mrr@100=0.0810 recall@100=0.1323 precision@100=0.0013 ndcg@100=0.0913 train_loss_0=10.7888]
[2023-05-30 01:46:39] INFO Train time: 593.92612s. Valid time: 17.93852s. GPU RAM: 10.27/23.70 GB
[2023-05-30 01:46:39] INFO Current learning rate : 0.0005
[2023-05-30 01:46:42] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 01:46:42] INFO mrr@100 improved. Best value: 0.0810
[2023-05-30 01:56:18] INFO Training: Epoch=  4 [mrr@100=0.1119 recall@100=0.1749 precision@100=0.0017 ndcg@100=0.1248 train_loss_0=10.3192]
[2023-05-30 01:56:18] INFO Train time: 564.19405s. Valid time: 11.72312s. GPU RAM: 10.27/23.70 GB
[2023-05-30 01:56:18] INFO Current learning rate : 0.0005
[2023-05-30 01:56:19] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 01:56:19] INFO mrr@100 improved. Best value: 0.1119
[2023-05-30 02:04:48] INFO Training: Epoch=  5 [mrr@100=0.1364 recall@100=0.2123 precision@100=0.0021 ndcg@100=0.1521 train_loss_0=9.8843]
[2023-05-30 02:04:48] INFO Train time: 498.37674s. Valid time: 10.27141s. GPU RAM: 10.27/23.70 GB
[2023-05-30 02:04:48] INFO Current learning rate : 0.0005
[2023-05-30 02:04:49] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 02:04:49] INFO mrr@100 improved. Best value: 0.1364
[2023-05-30 02:12:29] INFO Training: Epoch=  6 [mrr@100=0.1566 recall@100=0.2463 precision@100=0.0025 ndcg@100=0.1753 train_loss_0=9.4854]
[2023-05-30 02:12:29] INFO Train time: 449.37115s. Valid time: 10.06222s. GPU RAM: 10.27/23.70 GB
[2023-05-30 02:12:29] INFO Current learning rate : 0.0005
[2023-05-30 02:12:30] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 02:12:30] INFO mrr@100 improved. Best value: 0.1566
[2023-05-30 02:20:13] INFO Training: Epoch=  7 [mrr@100=0.1737 recall@100=0.2771 precision@100=0.0028 ndcg@100=0.1953 train_loss_0=9.1205]
[2023-05-30 02:20:13] INFO Train time: 453.95276s. Valid time: 8.44871s. GPU RAM: 10.27/23.70 GB
[2023-05-30 02:20:13] INFO Current learning rate : 0.0005
[2023-05-30 02:20:14] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 02:20:14] INFO mrr@100 improved. Best value: 0.1737
[2023-05-30 02:27:59] INFO Training: Epoch=  8 [mrr@100=0.1880 recall@100=0.3068 precision@100=0.0031 ndcg@100=0.2128 train_loss_0=8.7884]
[2023-05-30 02:27:59] INFO Train time: 455.64525s. Valid time: 8.91230s. GPU RAM: 10.27/23.70 GB
[2023-05-30 02:27:59] INFO Current learning rate : 0.0005
[2023-05-30 02:28:00] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 02:28:00] INFO mrr@100 improved. Best value: 0.1880
[2023-05-30 02:35:44] INFO Training: Epoch=  9 [mrr@100=0.2004 recall@100=0.3327 precision@100=0.0033 ndcg@100=0.2281 train_loss_0=8.4834]
[2023-05-30 02:35:44] INFO Train time: 454.87200s. Valid time: 9.29166s. GPU RAM: 10.27/23.70 GB
[2023-05-30 02:35:44] INFO Current learning rate : 0.0005
[2023-05-30 02:35:45] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 02:35:45] INFO mrr@100 improved. Best value: 0.2004
[2023-05-30 02:43:28] INFO Training: Epoch= 10 [mrr@100=0.2106 recall@100=0.3554 precision@100=0.0036 ndcg@100=0.2410 train_loss_0=8.2054]
[2023-05-30 02:43:28] INFO Train time: 450.63105s. Valid time: 11.47188s. GPU RAM: 10.27/23.70 GB
[2023-05-30 02:43:28] INFO Current learning rate : 0.0005
[2023-05-30 02:43:29] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 02:43:29] INFO mrr@100 improved. Best value: 0.2106
[2023-05-30 02:51:13] INFO Training: Epoch= 11 [mrr@100=0.2199 recall@100=0.3764 precision@100=0.0038 ndcg@100=0.2528 train_loss_0=7.9507]
[2023-05-30 02:51:13] INFO Train time: 452.41833s. Valid time: 11.28292s. GPU RAM: 10.27/23.70 GB
[2023-05-30 02:51:13] INFO Current learning rate : 0.0005
[2023-05-30 02:51:14] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 02:51:14] INFO mrr@100 improved. Best value: 0.2199
[2023-05-30 02:58:54] INFO Training: Epoch= 12 [mrr@100=0.2276 recall@100=0.3947 precision@100=0.0039 ndcg@100=0.2627 train_loss_0=7.7176]
[2023-05-30 02:58:54] INFO Train time: 451.65344s. Valid time: 8.48658s. GPU RAM: 10.27/23.70 GB
[2023-05-30 02:58:54] INFO Current learning rate : 0.0005
[2023-05-30 02:58:55] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 02:58:55] INFO mrr@100 improved. Best value: 0.2276
[2023-05-30 03:06:33] INFO Training: Epoch= 13 [mrr@100=0.2348 recall@100=0.4127 precision@100=0.0041 ndcg@100=0.2721 train_loss_0=7.5023]
[2023-05-30 03:06:33] INFO Train time: 447.68987s. Valid time: 9.45278s. GPU RAM: 10.27/23.70 GB
[2023-05-30 03:06:33] INFO Current learning rate : 0.0005
[2023-05-30 03:06:34] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 03:06:34] INFO mrr@100 improved. Best value: 0.2348
[2023-05-30 03:14:11] INFO Training: Epoch= 14 [mrr@100=0.2411 recall@100=0.4295 precision@100=0.0043 ndcg@100=0.2806 train_loss_0=7.3054]
[2023-05-30 03:14:11] INFO Train time: 447.17488s. Valid time: 9.76969s. GPU RAM: 10.27/23.70 GB
[2023-05-30 03:14:11] INFO Current learning rate : 0.0005
[2023-05-30 03:14:13] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 03:14:13] INFO mrr@100 improved. Best value: 0.2411
[2023-05-30 03:21:50] INFO Training: Epoch= 15 [mrr@100=0.2462 recall@100=0.4446 precision@100=0.0044 ndcg@100=0.2877 train_loss_0=7.1219]
[2023-05-30 03:21:50] INFO Train time: 447.43096s. Valid time: 9.49312s. GPU RAM: 10.27/23.70 GB
[2023-05-30 03:21:50] INFO Current learning rate : 0.0005
[2023-05-30 03:21:51] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 03:21:51] INFO mrr@100 improved. Best value: 0.2462
[2023-05-30 03:29:27] INFO Training: Epoch= 16 [mrr@100=0.2511 recall@100=0.4583 precision@100=0.0046 ndcg@100=0.2944 train_loss_0=6.9535]
[2023-05-30 03:29:27] INFO Train time: 448.24948s. Valid time: 7.32297s. GPU RAM: 10.27/23.70 GB
[2023-05-30 03:29:27] INFO Current learning rate : 0.0005
[2023-05-30 03:29:28] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 03:29:28] INFO mrr@100 improved. Best value: 0.2511
[2023-05-30 03:37:06] INFO Training: Epoch= 17 [mrr@100=0.2558 recall@100=0.4714 precision@100=0.0047 ndcg@100=0.3008 train_loss_0=6.7975]
[2023-05-30 03:37:06] INFO Train time: 449.12465s. Valid time: 8.80847s. GPU RAM: 10.27/23.70 GB
[2023-05-30 03:37:06] INFO Current learning rate : 0.0005
[2023-05-30 03:37:07] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 03:37:07] INFO mrr@100 improved. Best value: 0.2558
[2023-05-30 03:44:46] INFO Training: Epoch= 18 [mrr@100=0.2606 recall@100=0.4839 precision@100=0.0048 ndcg@100=0.3071 train_loss_0=6.6525]
[2023-05-30 03:44:46] INFO Train time: 449.56481s. Valid time: 8.69517s. GPU RAM: 10.27/23.70 GB
[2023-05-30 03:44:46] INFO Current learning rate : 0.0005
[2023-05-30 03:44:47] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 03:44:47] INFO mrr@100 improved. Best value: 0.2606
[2023-05-30 03:52:25] INFO Training: Epoch= 19 [mrr@100=0.2632 recall@100=0.4945 precision@100=0.0049 ndcg@100=0.3114 train_loss_0=6.5182]
[2023-05-30 03:52:25] INFO Train time: 449.70999s. Valid time: 7.94245s. GPU RAM: 10.27/23.70 GB
[2023-05-30 03:52:25] INFO Current learning rate : 0.0005
[2023-05-30 03:52:26] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 03:52:26] INFO mrr@100 improved. Best value: 0.2632
[2023-05-30 04:00:03] INFO Training: Epoch= 20 [mrr@100=0.2669 recall@100=0.5046 precision@100=0.0050 ndcg@100=0.3163 train_loss_0=6.3939]
[2023-05-30 04:00:03] INFO Train time: 447.42961s. Valid time: 9.33762s. GPU RAM: 10.27/23.70 GB
[2023-05-30 04:00:03] INFO Current learning rate : 0.0005
[2023-05-30 04:00:05] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 04:00:05] INFO mrr@100 improved. Best value: 0.2669
[2023-05-30 04:07:43] INFO Training: Epoch= 21 [mrr@100=0.2699 recall@100=0.5143 precision@100=0.0051 ndcg@100=0.3208 train_loss_0=6.2770]
[2023-05-30 04:07:43] INFO Train time: 451.04618s. Valid time: 7.26522s. GPU RAM: 10.27/23.70 GB
[2023-05-30 04:07:43] INFO Current learning rate : 0.0005
[2023-05-30 04:07:44] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 04:07:44] INFO mrr@100 improved. Best value: 0.2699
[2023-05-30 04:15:20] INFO Training: Epoch= 22 [mrr@100=0.2725 recall@100=0.5221 precision@100=0.0052 ndcg@100=0.3244 train_loss_0=6.1696]
[2023-05-30 04:15:20] INFO Train time: 446.89071s. Valid time: 8.91463s. GPU RAM: 10.27/23.70 GB
[2023-05-30 04:15:20] INFO Current learning rate : 0.0005
[2023-05-30 04:15:21] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 04:15:21] INFO mrr@100 improved. Best value: 0.2725
[2023-05-30 04:23:02] INFO Training: Epoch= 23 [mrr@100=0.2754 recall@100=0.5302 precision@100=0.0053 ndcg@100=0.3283 train_loss_0=6.0695]
[2023-05-30 04:23:02] INFO Train time: 452.95457s. Valid time: 7.58809s. GPU RAM: 10.27/23.70 GB
[2023-05-30 04:23:02] INFO Current learning rate : 0.0005
[2023-05-30 04:23:03] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 04:23:03] INFO mrr@100 improved. Best value: 0.2754
[2023-05-30 04:30:41] INFO Training: Epoch= 24 [mrr@100=0.2774 recall@100=0.5374 precision@100=0.0054 ndcg@100=0.3314 train_loss_0=5.9748]
[2023-05-30 04:30:41] INFO Train time: 447.46558s. Valid time: 10.39729s. GPU RAM: 10.27/23.70 GB
[2023-05-30 04:30:41] INFO Current learning rate : 0.0005
[2023-05-30 04:30:43] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 04:30:43] INFO mrr@100 improved. Best value: 0.2774
[2023-05-30 04:38:18] INFO Training: Epoch= 25 [mrr@100=0.2793 recall@100=0.5441 precision@100=0.0054 ndcg@100=0.3342 train_loss_0=5.8863]
[2023-05-30 04:38:18] INFO Train time: 447.09702s. Valid time: 8.49903s. GPU RAM: 10.27/23.70 GB
[2023-05-30 04:38:18] INFO Current learning rate : 0.0005
[2023-05-30 04:38:20] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 04:38:20] INFO mrr@100 improved. Best value: 0.2793
[2023-05-30 04:45:57] INFO Training: Epoch= 26 [mrr@100=0.2811 recall@100=0.5506 precision@100=0.0055 ndcg@100=0.3369 train_loss_0=5.8046]
[2023-05-30 04:45:57] INFO Train time: 449.43102s. Valid time: 8.24173s. GPU RAM: 10.27/23.70 GB
[2023-05-30 04:45:57] INFO Current learning rate : 0.0005
[2023-05-30 04:45:58] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 04:45:58] INFO mrr@100 improved. Best value: 0.2811
[2023-05-30 04:53:36] INFO Training: Epoch= 27 [mrr@100=0.2833 recall@100=0.5573 precision@100=0.0056 ndcg@100=0.3400 train_loss_0=5.7267]
[2023-05-30 04:53:36] INFO Train time: 447.61605s. Valid time: 10.18896s. GPU RAM: 10.27/23.70 GB
[2023-05-30 04:53:36] INFO Current learning rate : 0.0005
[2023-05-30 04:53:38] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 04:53:38] INFO mrr@100 improved. Best value: 0.2833
[2023-05-30 05:01:14] INFO Training: Epoch= 28 [mrr@100=0.2845 recall@100=0.5618 precision@100=0.0056 ndcg@100=0.3419 train_loss_0=5.6547]
[2023-05-30 05:01:14] INFO Train time: 447.80700s. Valid time: 8.60245s. GPU RAM: 10.27/23.70 GB
[2023-05-30 05:01:14] INFO Current learning rate : 0.0005
[2023-05-30 05:01:16] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 05:01:16] INFO mrr@100 improved. Best value: 0.2845
[2023-05-30 05:08:51] INFO Training: Epoch= 29 [mrr@100=0.2863 recall@100=0.5679 precision@100=0.0057 ndcg@100=0.3445 train_loss_0=5.5864]
[2023-05-30 05:08:51] INFO Train time: 448.49064s. Valid time: 6.90982s. GPU RAM: 10.27/23.70 GB
[2023-05-30 05:08:51] INFO Current learning rate : 0.0005
[2023-05-30 05:08:52] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 05:08:52] INFO mrr@100 improved. Best value: 0.2863
[2023-05-30 05:16:31] INFO Training: Epoch= 30 [mrr@100=0.2876 recall@100=0.5725 precision@100=0.0057 ndcg@100=0.3464 train_loss_0=5.5227]
[2023-05-30 05:16:31] INFO Train time: 450.97280s. Valid time: 7.25935s. GPU RAM: 10.27/23.70 GB
[2023-05-30 05:16:31] INFO Current learning rate : 0.0005
[2023-05-30 05:16:32] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 05:16:32] INFO mrr@100 improved. Best value: 0.2876
[2023-05-30 05:24:04] INFO Training: Epoch= 31 [mrr@100=0.2891 recall@100=0.5761 precision@100=0.0058 ndcg@100=0.3483 train_loss_0=5.4623]
[2023-05-30 05:24:04] INFO Train time: 444.02972s. Valid time: 8.32156s. GPU RAM: 10.27/23.70 GB
[2023-05-30 05:24:04] INFO Current learning rate : 0.0005
[2023-05-30 05:24:06] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 05:24:06] INFO mrr@100 improved. Best value: 0.2891
[2023-05-30 05:31:42] INFO Training: Epoch= 32 [mrr@100=0.2901 recall@100=0.5799 precision@100=0.0058 ndcg@100=0.3500 train_loss_0=5.4057]
[2023-05-30 05:31:42] INFO Train time: 448.05016s. Valid time: 8.55827s. GPU RAM: 10.27/23.70 GB
[2023-05-30 05:31:42] INFO Current learning rate : 0.0005
[2023-05-30 05:31:44] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 05:31:44] INFO mrr@100 improved. Best value: 0.2901
[2023-05-30 05:39:21] INFO Training: Epoch= 33 [mrr@100=0.2912 recall@100=0.5844 precision@100=0.0058 ndcg@100=0.3517 train_loss_0=5.3519]
[2023-05-30 05:39:21] INFO Train time: 448.97750s. Valid time: 8.27467s. GPU RAM: 10.27/23.70 GB
[2023-05-30 05:39:21] INFO Current learning rate : 0.0005
[2023-05-30 05:39:22] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 05:39:22] INFO mrr@100 improved. Best value: 0.2912
[2023-05-30 05:47:02] INFO Training: Epoch= 34 [mrr@100=0.2929 recall@100=0.5877 precision@100=0.0059 ndcg@100=0.3537 train_loss_0=5.3012]
[2023-05-30 05:47:02] INFO Train time: 450.53314s. Valid time: 9.30652s. GPU RAM: 10.27/23.70 GB
[2023-05-30 05:47:02] INFO Current learning rate : 0.0005
[2023-05-30 05:47:04] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 05:47:04] INFO mrr@100 improved. Best value: 0.2929
[2023-05-30 05:54:31] INFO Training: Epoch= 35 [mrr@100=0.2931 recall@100=0.5915 precision@100=0.0059 ndcg@100=0.3546 train_loss_0=5.2540]
[2023-05-30 05:54:31] INFO Train time: 439.57827s. Valid time: 7.51375s. GPU RAM: 10.27/23.70 GB
[2023-05-30 05:54:31] INFO Current learning rate : 0.0005
[2023-05-30 05:54:32] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 05:54:32] INFO mrr@100 improved. Best value: 0.2931
[2023-05-30 06:01:56] INFO Training: Epoch= 36 [mrr@100=0.2935 recall@100=0.5943 precision@100=0.0059 ndcg@100=0.3555 train_loss_0=5.2073]
[2023-05-30 06:01:56] INFO Train time: 435.76398s. Valid time: 7.86497s. GPU RAM: 10.27/23.70 GB
[2023-05-30 06:01:56] INFO Current learning rate : 0.0005
[2023-05-30 06:01:57] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 06:01:57] INFO mrr@100 improved. Best value: 0.2935
[2023-05-30 06:09:19] INFO Training: Epoch= 37 [mrr@100=0.2953 recall@100=0.5977 precision@100=0.0060 ndcg@100=0.3576 train_loss_0=5.1646]
[2023-05-30 06:09:19] INFO Train time: 433.88279s. Valid time: 7.57928s. GPU RAM: 10.27/23.70 GB
[2023-05-30 06:09:19] INFO Current learning rate : 0.0005
[2023-05-30 06:09:20] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 06:09:20] INFO mrr@100 improved. Best value: 0.2953
[2023-05-30 06:16:43] INFO Training: Epoch= 38 [mrr@100=0.2965 recall@100=0.6009 precision@100=0.0060 ndcg@100=0.3592 train_loss_0=5.1244]
[2023-05-30 06:16:43] INFO Train time: 435.49580s. Valid time: 7.89471s. GPU RAM: 10.27/23.70 GB
[2023-05-30 06:16:43] INFO Current learning rate : 0.0005
[2023-05-30 06:16:44] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 06:16:44] INFO mrr@100 improved. Best value: 0.2965
[2023-05-30 06:24:01] INFO Training: Epoch= 39 [mrr@100=0.2974 recall@100=0.6030 precision@100=0.0060 ndcg@100=0.3604 train_loss_0=5.0849]
[2023-05-30 06:24:01] INFO Train time: 429.38011s. Valid time: 7.37168s. GPU RAM: 10.27/23.70 GB
[2023-05-30 06:24:01] INFO Current learning rate : 0.0005
[2023-05-30 06:24:03] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 06:24:03] INFO mrr@100 improved. Best value: 0.2974
[2023-05-30 06:31:13] INFO Training: Epoch= 40 [mrr@100=0.2980 recall@100=0.6059 precision@100=0.0061 ndcg@100=0.3614 train_loss_0=5.0488]
[2023-05-30 06:31:13] INFO Train time: 423.42942s. Valid time: 7.15654s. GPU RAM: 10.27/23.70 GB
[2023-05-30 06:31:13] INFO Current learning rate : 0.0005
[2023-05-30 06:31:14] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 06:31:14] INFO mrr@100 improved. Best value: 0.2980
[2023-05-30 06:38:26] INFO Training: Epoch= 41 [mrr@100=0.2987 recall@100=0.6084 precision@100=0.0061 ndcg@100=0.3625 train_loss_0=5.0138]
[2023-05-30 06:38:26] INFO Train time: 423.52899s. Valid time: 8.10477s. GPU RAM: 10.27/23.70 GB
[2023-05-30 06:38:26] INFO Current learning rate : 0.0005
[2023-05-30 06:38:27] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 06:38:27] INFO mrr@100 improved. Best value: 0.2987
[2023-05-30 06:45:40] INFO Training: Epoch= 42 [mrr@100=0.2995 recall@100=0.6102 precision@100=0.0061 ndcg@100=0.3635 train_loss_0=4.9804]
[2023-05-30 06:45:40] INFO Train time: 425.89455s. Valid time: 7.07884s. GPU RAM: 10.27/23.70 GB
[2023-05-30 06:45:40] INFO Current learning rate : 0.0005
[2023-05-30 06:45:41] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 06:45:41] INFO mrr@100 improved. Best value: 0.2995
[2023-05-30 06:52:54] INFO Training: Epoch= 43 [mrr@100=0.2994 recall@100=0.6118 precision@100=0.0061 ndcg@100=0.3637 train_loss_0=4.9478]
[2023-05-30 06:52:54] INFO Train time: 425.23217s. Valid time: 7.91920s. GPU RAM: 10.27/23.70 GB
[2023-05-30 06:52:54] INFO Current learning rate : 0.0005
[2023-05-30 07:00:05] INFO Training: Epoch= 44 [mrr@100=0.2997 recall@100=0.6145 precision@100=0.0061 ndcg@100=0.3645 train_loss_0=4.9178]
[2023-05-30 07:00:05] INFO Train time: 424.36485s. Valid time: 6.83577s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:00:05] INFO Current learning rate : 0.0005
[2023-05-30 07:00:07] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 07:00:07] INFO mrr@100 improved. Best value: 0.2997
[2023-05-30 07:07:22] INFO Training: Epoch= 45 [mrr@100=0.3010 recall@100=0.6160 precision@100=0.0062 ndcg@100=0.3658 train_loss_0=4.8893]
[2023-05-30 07:07:22] INFO Train time: 428.54504s. Valid time: 6.98114s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:07:22] INFO Current learning rate : 0.0005
[2023-05-30 07:07:23] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 07:07:23] INFO mrr@100 improved. Best value: 0.3010
[2023-05-30 07:14:37] INFO Training: Epoch= 46 [mrr@100=0.3013 recall@100=0.6183 precision@100=0.0062 ndcg@100=0.3666 train_loss_0=4.8619]
[2023-05-30 07:14:37] INFO Train time: 427.35535s. Valid time: 6.81069s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:14:37] INFO Current learning rate : 0.0005
[2023-05-30 07:14:38] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 07:14:38] INFO mrr@100 improved. Best value: 0.3013
[2023-05-30 07:21:51] INFO Training: Epoch= 47 [mrr@100=0.3019 recall@100=0.6195 precision@100=0.0062 ndcg@100=0.3673 train_loss_0=4.8341]
[2023-05-30 07:21:51] INFO Train time: 425.64157s. Valid time: 7.40763s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:21:51] INFO Current learning rate : 0.0005
[2023-05-30 07:21:52] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 07:21:52] INFO mrr@100 improved. Best value: 0.3019
[2023-05-30 07:29:03] INFO Training: Epoch= 48 [mrr@100=0.3023 recall@100=0.6209 precision@100=0.0062 ndcg@100=0.3678 train_loss_0=4.8095]
[2023-05-30 07:29:03] INFO Train time: 423.39149s. Valid time: 7.66830s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:29:03] INFO Current learning rate : 0.0005
[2023-05-30 07:29:04] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 07:29:04] INFO mrr@100 improved. Best value: 0.3023
[2023-05-30 07:36:18] INFO Training: Epoch= 49 [mrr@100=0.3029 recall@100=0.6226 precision@100=0.0062 ndcg@100=0.3687 train_loss_0=4.7846]
[2023-05-30 07:36:18] INFO Train time: 424.27633s. Valid time: 8.92458s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:36:18] INFO Current learning rate : 0.0005
[2023-05-30 07:36:19] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 07:36:19] INFO mrr@100 improved. Best value: 0.3029
[2023-05-30 07:43:30] INFO Training: Epoch= 50 [mrr@100=0.3027 recall@100=0.6238 precision@100=0.0062 ndcg@100=0.3688 train_loss_0=4.7610]
[2023-05-30 07:43:30] INFO Train time: 423.59999s. Valid time: 7.59710s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:43:30] INFO Current learning rate : 0.0005
[2023-05-30 07:50:41] INFO Training: Epoch= 51 [mrr@100=0.3034 recall@100=0.6255 precision@100=0.0063 ndcg@100=0.3696 train_loss_0=4.7382]
[2023-05-30 07:50:41] INFO Train time: 421.50482s. Valid time: 8.93179s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:50:41] INFO Current learning rate : 0.0005
[2023-05-30 07:50:42] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 07:50:42] INFO mrr@100 improved. Best value: 0.3034
[2023-05-30 07:57:54] INFO Training: Epoch= 52 [mrr@100=0.3036 recall@100=0.6266 precision@100=0.0063 ndcg@100=0.3700 train_loss_0=4.7173]
[2023-05-30 07:57:54] INFO Train time: 424.17832s. Valid time: 7.30307s. GPU RAM: 10.27/23.70 GB
[2023-05-30 07:57:54] INFO Current learning rate : 0.0005
[2023-05-30 07:57:55] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 07:57:55] INFO mrr@100 improved. Best value: 0.3036
[2023-05-30 08:05:07] INFO Training: Epoch= 53 [mrr@100=0.3038 recall@100=0.6283 precision@100=0.0063 ndcg@100=0.3705 train_loss_0=4.6961]
[2023-05-30 08:05:07] INFO Train time: 424.60089s. Valid time: 7.52526s. GPU RAM: 10.27/23.70 GB
[2023-05-30 08:05:07] INFO Current learning rate : 0.0005
[2023-05-30 08:05:08] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 08:05:08] INFO mrr@100 improved. Best value: 0.3038
[2023-05-30 08:12:20] INFO Training: Epoch= 54 [mrr@100=0.3049 recall@100=0.6293 precision@100=0.0063 ndcg@100=0.3715 train_loss_0=4.6762]
[2023-05-30 08:12:20] INFO Train time: 425.16933s. Valid time: 6.52131s. GPU RAM: 10.27/23.70 GB
[2023-05-30 08:12:20] INFO Current learning rate : 0.0005
[2023-05-30 08:12:21] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 08:12:21] INFO mrr@100 improved. Best value: 0.3049
[2023-05-30 08:19:34] INFO Training: Epoch= 55 [mrr@100=0.3049 recall@100=0.6307 precision@100=0.0063 ndcg@100=0.3718 train_loss_0=4.6563]
[2023-05-30 08:19:34] INFO Train time: 425.04476s. Valid time: 7.77932s. GPU RAM: 10.27/23.70 GB
[2023-05-30 08:19:34] INFO Current learning rate : 0.0005
[2023-05-30 08:19:35] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 08:19:35] INFO mrr@100 improved. Best value: 0.3049
[2023-05-30 08:26:46] INFO Training: Epoch= 56 [mrr@100=0.3049 recall@100=0.6312 precision@100=0.0063 ndcg@100=0.3719 train_loss_0=4.6387]
[2023-05-30 08:26:46] INFO Train time: 422.46307s. Valid time: 8.01006s. GPU RAM: 10.27/23.70 GB
[2023-05-30 08:26:46] INFO Current learning rate : 0.0005
[2023-05-30 08:33:57] INFO Training: Epoch= 57 [mrr@100=0.3054 recall@100=0.6325 precision@100=0.0063 ndcg@100=0.3726 train_loss_0=4.6197]
[2023-05-30 08:33:57] INFO Train time: 424.49420s. Valid time: 6.91456s. GPU RAM: 10.27/23.70 GB
[2023-05-30 08:33:57] INFO Current learning rate : 0.0005
[2023-05-30 08:33:58] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 08:33:58] INFO mrr@100 improved. Best value: 0.3054
[2023-05-30 08:41:10] INFO Training: Epoch= 58 [mrr@100=0.3059 recall@100=0.6331 precision@100=0.0063 ndcg@100=0.3731 train_loss_0=4.6034]
[2023-05-30 08:41:10] INFO Train time: 424.96418s. Valid time: 6.79590s. GPU RAM: 10.27/23.70 GB
[2023-05-30 08:41:10] INFO Current learning rate : 0.0005
[2023-05-30 08:41:11] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 08:41:11] INFO mrr@100 improved. Best value: 0.3059
[2023-05-30 08:48:21] INFO Training: Epoch= 59 [mrr@100=0.3058 recall@100=0.6340 precision@100=0.0063 ndcg@100=0.3732 train_loss_0=4.5866]
[2023-05-30 08:48:21] INFO Train time: 422.33637s. Valid time: 7.28535s. GPU RAM: 10.27/23.70 GB
[2023-05-30 08:48:21] INFO Current learning rate : 0.0005
[2023-05-30 08:55:24] INFO Training: Epoch= 60 [mrr@100=0.3057 recall@100=0.6349 precision@100=0.0063 ndcg@100=0.3733 train_loss_0=4.5704]
[2023-05-30 08:55:24] INFO Train time: 416.39525s. Valid time: 6.73455s. GPU RAM: 10.27/23.70 GB
[2023-05-30 08:55:24] INFO Current learning rate : 0.0005
[2023-05-30 09:02:32] INFO Training: Epoch= 61 [mrr@100=0.3063 recall@100=0.6352 precision@100=0.0064 ndcg@100=0.3739 train_loss_0=4.5545]
[2023-05-30 09:02:32] INFO Train time: 421.03497s. Valid time: 6.87485s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:02:32] INFO Current learning rate : 0.0005
[2023-05-30 09:02:33] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 09:02:33] INFO mrr@100 improved. Best value: 0.3063
[2023-05-30 09:09:38] INFO Training: Epoch= 62 [mrr@100=0.3060 recall@100=0.6359 precision@100=0.0064 ndcg@100=0.3738 train_loss_0=4.5391]
[2023-05-30 09:09:38] INFO Train time: 416.63976s. Valid time: 7.91047s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:09:38] INFO Current learning rate : 0.0005
[2023-05-30 09:16:37] INFO Training: Epoch= 63 [mrr@100=0.3068 recall@100=0.6365 precision@100=0.0064 ndcg@100=0.3744 train_loss_0=4.5256]
[2023-05-30 09:16:37] INFO Train time: 412.77910s. Valid time: 6.94712s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:16:37] INFO Current learning rate : 0.0005
[2023-05-30 09:16:38] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 09:16:38] INFO mrr@100 improved. Best value: 0.3068
[2023-05-30 09:23:41] INFO Training: Epoch= 64 [mrr@100=0.3063 recall@100=0.6367 precision@100=0.0064 ndcg@100=0.3741 train_loss_0=4.5113]
[2023-05-30 09:23:41] INFO Train time: 415.53332s. Valid time: 6.81742s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:23:41] INFO Current learning rate : 0.0005
[2023-05-30 09:30:40] INFO Training: Epoch= 65 [mrr@100=0.3067 recall@100=0.6375 precision@100=0.0064 ndcg@100=0.3746 train_loss_0=4.4976]
[2023-05-30 09:30:40] INFO Train time: 412.73251s. Valid time: 7.03301s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:30:40] INFO Current learning rate : 0.0005
[2023-05-30 09:37:39] INFO Training: Epoch= 66 [mrr@100=0.3069 recall@100=0.6386 precision@100=0.0064 ndcg@100=0.3750 train_loss_0=4.4851]
[2023-05-30 09:37:39] INFO Train time: 412.36895s. Valid time: 6.11679s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:37:39] INFO Current learning rate : 0.0005
[2023-05-30 09:37:40] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 09:37:40] INFO mrr@100 improved. Best value: 0.3069
[2023-05-30 09:44:39] INFO Training: Epoch= 67 [mrr@100=0.3070 recall@100=0.6388 precision@100=0.0064 ndcg@100=0.3750 train_loss_0=4.4725]
[2023-05-30 09:44:39] INFO Train time: 412.32929s. Valid time: 6.21751s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:44:39] INFO Current learning rate : 0.0005
[2023-05-30 09:44:40] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 09:44:40] INFO mrr@100 improved. Best value: 0.3070
[2023-05-30 09:51:41] INFO Training: Epoch= 68 [mrr@100=0.3068 recall@100=0.6394 precision@100=0.0064 ndcg@100=0.3750 train_loss_0=4.4599]
[2023-05-30 09:51:41] INFO Train time: 414.31334s. Valid time: 6.51470s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:51:41] INFO Current learning rate : 0.0005
[2023-05-30 09:58:39] INFO Training: Epoch= 69 [mrr@100=0.3074 recall@100=0.6402 precision@100=0.0064 ndcg@100=0.3756 train_loss_0=4.4491]
[2023-05-30 09:58:39] INFO Train time: 412.92588s. Valid time: 5.88634s. GPU RAM: 10.27/23.70 GB
[2023-05-30 09:58:39] INFO Current learning rate : 0.0005
[2023-05-30 09:58:40] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 09:58:40] INFO mrr@100 improved. Best value: 0.3074
[2023-05-30 10:05:39] INFO Training: Epoch= 70 [mrr@100=0.3074 recall@100=0.6400 precision@100=0.0064 ndcg@100=0.3756 train_loss_0=4.4364]
[2023-05-30 10:05:39] INFO Train time: 413.00370s. Valid time: 5.82153s. GPU RAM: 10.27/23.70 GB
[2023-05-30 10:05:39] INFO Current learning rate : 0.0005
[2023-05-30 10:05:40] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 10:05:40] INFO mrr@100 improved. Best value: 0.3074
[2023-05-30 10:12:40] INFO Training: Epoch= 71 [mrr@100=0.3075 recall@100=0.6407 precision@100=0.0064 ndcg@100=0.3759 train_loss_0=4.4248]
[2023-05-30 10:12:40] INFO Train time: 413.65100s. Valid time: 6.31411s. GPU RAM: 10.27/23.70 GB
[2023-05-30 10:12:40] INFO Current learning rate : 0.0005
[2023-05-30 10:12:41] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 10:12:41] INFO mrr@100 improved. Best value: 0.3075
[2023-05-30 10:19:37] INFO Training: Epoch= 72 [mrr@100=0.3079 recall@100=0.6409 precision@100=0.0064 ndcg@100=0.3761 train_loss_0=4.4148]
[2023-05-30 10:19:37] INFO Train time: 409.79968s. Valid time: 6.02719s. GPU RAM: 10.27/23.70 GB
[2023-05-30 10:19:37] INFO Current learning rate : 0.0005
[2023-05-30 10:19:38] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 10:19:38] INFO mrr@100 improved. Best value: 0.3079
[2023-05-30 10:26:35] INFO Training: Epoch= 73 [mrr@100=0.3072 recall@100=0.6406 precision@100=0.0064 ndcg@100=0.3756 train_loss_0=4.4043]
[2023-05-30 10:26:35] INFO Train time: 411.14644s. Valid time: 6.15152s. GPU RAM: 10.27/23.70 GB
[2023-05-30 10:26:35] INFO Current learning rate : 0.0005
[2023-05-30 10:34:08] INFO Training: Epoch= 74 [mrr@100=0.3079 recall@100=0.6416 precision@100=0.0064 ndcg@100=0.3763 train_loss_0=4.3938]
[2023-05-30 10:34:08] INFO Train time: 445.59882s. Valid time: 7.31091s. GPU RAM: 10.27/23.70 GB
[2023-05-30 10:34:08] INFO Current learning rate : 0.0005
[2023-05-30 10:42:03] INFO Training: Epoch= 75 [mrr@100=0.3077 recall@100=0.6417 precision@100=0.0064 ndcg@100=0.3763 train_loss_0=4.3841]
[2023-05-30 10:42:03] INFO Train time: 464.39472s. Valid time: 10.24733s. GPU RAM: 10.27/23.70 GB
[2023-05-30 10:42:03] INFO Current learning rate : 0.00025
[2023-05-30 10:49:46] INFO Training: Epoch= 76 [mrr@100=0.3085 recall@100=0.6421 precision@100=0.0064 ndcg@100=0.3769 train_loss_0=4.3204]
[2023-05-30 10:49:46] INFO Train time: 453.22568s. Valid time: 9.57300s. GPU RAM: 10.27/23.70 GB
[2023-05-30 10:49:46] INFO Current learning rate : 0.00025
[2023-05-30 10:49:47] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 10:49:47] INFO mrr@100 improved. Best value: 0.3085
[2023-05-30 10:57:27] INFO Training: Epoch= 77 [mrr@100=0.3085 recall@100=0.6427 precision@100=0.0064 ndcg@100=0.3771 train_loss_0=4.3077]
[2023-05-30 10:57:27] INFO Train time: 448.51607s. Valid time: 11.79036s. GPU RAM: 10.27/23.70 GB
[2023-05-30 10:57:27] INFO Current learning rate : 0.00025
[2023-05-30 11:05:05] INFO Training: Epoch= 78 [mrr@100=0.3085 recall@100=0.6425 precision@100=0.0064 ndcg@100=0.3770 train_loss_0=4.3009]
[2023-05-30 11:05:05] INFO Train time: 444.58423s. Valid time: 12.60272s. GPU RAM: 10.27/23.70 GB
[2023-05-30 11:05:05] INFO Current learning rate : 0.00025
[2023-05-30 11:12:44] INFO Training: Epoch= 79 [mrr@100=0.3086 recall@100=0.6429 precision@100=0.0064 ndcg@100=0.3772 train_loss_0=4.2944]
[2023-05-30 11:12:44] INFO Train time: 450.16099s. Valid time: 9.35294s. GPU RAM: 10.27/23.70 GB
[2023-05-30 11:12:44] INFO Current learning rate : 0.00025
[2023-05-30 11:12:46] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 11:12:46] INFO mrr@100 improved. Best value: 0.3086
[2023-05-30 11:20:26] INFO Training: Epoch= 80 [mrr@100=0.3085 recall@100=0.6429 precision@100=0.0064 ndcg@100=0.3771 train_loss_0=4.2884]
[2023-05-30 11:20:26] INFO Train time: 451.77036s. Valid time: 8.09686s. GPU RAM: 10.27/23.70 GB
[2023-05-30 11:20:26] INFO Current learning rate : 0.00025
[2023-05-30 11:28:07] INFO Training: Epoch= 81 [mrr@100=0.3088 recall@100=0.6428 precision@100=0.0064 ndcg@100=0.3774 train_loss_0=4.2818]
[2023-05-30 11:28:07] INFO Train time: 449.16771s. Valid time: 12.13076s. GPU RAM: 10.27/23.70 GB
[2023-05-30 11:28:07] INFO Current learning rate : 0.00025
[2023-05-30 11:28:08] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 11:28:08] INFO mrr@100 improved. Best value: 0.3088
[2023-05-30 11:35:46] INFO Training: Epoch= 82 [mrr@100=0.3084 recall@100=0.6431 precision@100=0.0064 ndcg@100=0.3771 train_loss_0=4.2766]
[2023-05-30 11:35:46] INFO Train time: 450.08772s. Valid time: 8.04952s. GPU RAM: 10.27/23.70 GB
[2023-05-30 11:35:46] INFO Current learning rate : 0.00025
[2023-05-30 11:43:30] INFO Training: Epoch= 83 [mrr@100=0.3085 recall@100=0.6432 precision@100=0.0064 ndcg@100=0.3772 train_loss_0=4.2710]
[2023-05-30 11:43:30] INFO Train time: 455.71917s. Valid time: 8.19921s. GPU RAM: 10.27/23.70 GB
[2023-05-30 11:43:30] INFO Current learning rate : 0.00025
[2023-05-30 11:51:15] INFO Training: Epoch= 84 [mrr@100=0.3085 recall@100=0.6435 precision@100=0.0064 ndcg@100=0.3772 train_loss_0=4.2658]
[2023-05-30 11:51:15] INFO Train time: 454.61104s. Valid time: 9.93886s. GPU RAM: 10.27/23.70 GB
[2023-05-30 11:51:15] INFO Current learning rate : 0.000125
[2023-05-30 11:58:57] INFO Training: Epoch= 85 [mrr@100=0.3085 recall@100=0.6436 precision@100=0.0064 ndcg@100=0.3772 train_loss_0=4.2307]
[2023-05-30 11:58:57] INFO Train time: 453.26621s. Valid time: 8.90650s. GPU RAM: 10.27/23.70 GB
[2023-05-30 11:58:57] INFO Current learning rate : 0.000125
[2023-05-30 12:06:37] INFO Training: Epoch= 86 [mrr@100=0.3087 recall@100=0.6435 precision@100=0.0064 ndcg@100=0.3774 train_loss_0=4.2248]
[2023-05-30 12:06:37] INFO Train time: 451.57429s. Valid time: 8.55635s. GPU RAM: 10.27/23.70 GB
[2023-05-30 12:06:37] INFO Current learning rate : 0.000125
[2023-05-30 12:14:17] INFO Training: Epoch= 87 [mrr@100=0.3092 recall@100=0.6437 precision@100=0.0064 ndcg@100=0.3778 train_loss_0=4.2206]
[2023-05-30 12:14:17] INFO Train time: 452.23505s. Valid time: 7.52221s. GPU RAM: 10.27/23.70 GB
[2023-05-30 12:14:17] INFO Current learning rate : 0.000125
[2023-05-30 12:14:19] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 12:14:19] INFO mrr@100 improved. Best value: 0.3092
[2023-05-30 12:22:04] INFO Training: Epoch= 88 [mrr@100=0.3090 recall@100=0.6436 precision@100=0.0064 ndcg@100=0.3776 train_loss_0=4.2172]
[2023-05-30 12:22:04] INFO Train time: 456.54777s. Valid time: 8.78287s. GPU RAM: 10.27/23.70 GB
[2023-05-30 12:22:04] INFO Current learning rate : 0.000125
[2023-05-30 12:29:45] INFO Training: Epoch= 89 [mrr@100=0.3090 recall@100=0.6438 precision@100=0.0064 ndcg@100=0.3777 train_loss_0=4.2145]
[2023-05-30 12:29:45] INFO Train time: 451.75381s. Valid time: 9.02911s. GPU RAM: 10.27/23.70 GB
[2023-05-30 12:29:45] INFO Current learning rate : 0.000125
[2023-05-30 12:37:24] INFO Training: Epoch= 90 [mrr@100=0.3088 recall@100=0.6435 precision@100=0.0064 ndcg@100=0.3775 train_loss_0=4.2106]
[2023-05-30 12:37:24] INFO Train time: 451.17420s. Valid time: 8.32923s. GPU RAM: 10.27/23.70 GB
[2023-05-30 12:37:24] INFO Current learning rate : 6.25e-05
[2023-05-30 12:45:00] INFO Training: Epoch= 91 [mrr@100=0.3091 recall@100=0.6439 precision@100=0.0064 ndcg@100=0.3778 train_loss_0=4.1933]
[2023-05-30 12:45:00] INFO Train time: 448.47928s. Valid time: 7.24721s. GPU RAM: 10.27/23.70 GB
[2023-05-30 12:45:00] INFO Current learning rate : 6.25e-05
[2023-05-30 12:52:41] INFO Training: Epoch= 92 [mrr@100=0.3091 recall@100=0.6442 precision@100=0.0064 ndcg@100=0.3778 train_loss_0=4.1896]
[2023-05-30 12:52:41] INFO Train time: 450.20881s. Valid time: 11.19827s. GPU RAM: 10.27/23.70 GB
[2023-05-30 12:52:41] INFO Current learning rate : 6.25e-05
[2023-05-30 13:00:23] INFO Training: Epoch= 93 [mrr@100=0.3088 recall@100=0.6441 precision@100=0.0064 ndcg@100=0.3775 train_loss_0=4.1876]
[2023-05-30 13:00:23] INFO Train time: 452.20680s. Valid time: 9.18668s. GPU RAM: 10.27/23.70 GB
[2023-05-30 13:00:23] INFO Current learning rate : 3.125e-05
[2023-05-30 13:08:01] INFO Training: Epoch= 94 [mrr@100=0.3089 recall@100=0.6441 precision@100=0.0064 ndcg@100=0.3776 train_loss_0=4.1777]
[2023-05-30 13:08:01] INFO Train time: 450.10402s. Valid time: 7.47334s. GPU RAM: 10.27/23.70 GB
[2023-05-30 13:08:01] INFO Current learning rate : 3.125e-05
[2023-05-30 13:15:40] INFO Training: Epoch= 95 [mrr@100=0.3091 recall@100=0.6440 precision@100=0.0064 ndcg@100=0.3778 train_loss_0=4.1764]
[2023-05-30 13:15:40] INFO Train time: 450.64260s. Valid time: 9.15228s. GPU RAM: 10.27/23.70 GB
[2023-05-30 13:15:40] INFO Current learning rate : 3.125e-05
[2023-05-30 13:23:22] INFO Training: Epoch= 96 [mrr@100=0.3091 recall@100=0.6443 precision@100=0.0064 ndcg@100=0.3778 train_loss_0=4.1753]
[2023-05-30 13:23:22] INFO Train time: 452.45201s. Valid time: 9.64560s. GPU RAM: 10.27/23.70 GB
[2023-05-30 13:23:22] INFO Current learning rate : 1.5625e-05
[2023-05-30 13:31:08] INFO Training: Epoch= 97 [mrr@100=0.3091 recall@100=0.6442 precision@100=0.0064 ndcg@100=0.3778 train_loss_0=4.1707]
[2023-05-30 13:31:08] INFO Train time: 453.16539s. Valid time: 12.14162s. GPU RAM: 10.27/23.70 GB
[2023-05-30 13:31:08] INFO Current learning rate : 1.5625e-05
[2023-05-30 13:31:08] INFO Early stopped. Since the metric mrr@100 haven't been improved for 10 epochs.
[2023-05-30 13:31:08] INFO The best score of mrr@100 is 0.3092 on epoch 87
[2023-05-30 13:31:10] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt.
[2023-05-30 13:31:20] INFO Testing:  [recall@100=0.6437 precision@100=0.0064 map@100=0.3092 ndcg@100=0.3778 mrr@100=0.3092 hit@100=0.6437 recall@200=0.6803 precision@200=0.0034 map@200=0.3095 ndcg@200=0.3830 mrr@200=0.3095 hit@200=0.6803 recall@300=0.6969 precision@300=0.0023 map@300=0.3096 ndcg@300=0.3851 mrr@300=0.3096 hit@300=0.6969]
[2023-05-30 13:31:32] INFO Load checkpoint from ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt
[2023-05-30 13:32:02] INFO Load checkpoint from ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt
[2023-05-30 13:32:38] INFO Load checkpoint from ./saved/SASRec_Next/kdd_cup_2023_UK/2023-05-30-00-56-53.ckpt
[2023-05-30 13:33:16] INFO Prediction is finished, results are saved in ./predictions/SASRec_Next/kdd_cup_2023_UK/2023-05-30-13-31-20.parquet.
