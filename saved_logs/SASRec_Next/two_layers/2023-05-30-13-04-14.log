[2023-05-30 13:04:14] INFO Log saved in /root/autodl-tmp/xiaolong/WorkSpace/Amazon-KDDCUP-23/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.log.
[2023-05-30 13:04:14] INFO Global seed set to 2022
[2023-05-30 13:04:14] INFO Load dataset from cache ./.recstudio/cache/b5aeac4e5b9ff0518bbcb59a28086594
[2023-05-30 13:04:20] INFO 
Dataset Info: 

==================================================================
item information: 
field      product_id DE_index   
type       token      float      
##         518328     -          
==================================================================
user information: 
field      sess_id    
type       token      
##         1340553    
==================================================================
interaction information: 
field      rating     sess_id    product_id timestamp  locale     
type       float      token      token      float      token      
##         -          1340553    518328     -          2          
==================================================================
Total Interactions: 6816971
Sparsity: 0.999990
==================================================================
[2023-05-30 13:04:20] INFO 
Model Config: 

data:
	binarized_rating_thres=None
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=True
	split_mode=user
	split_ratio=[1.0]
	test_rep=True
	train_rep=True
	max_seq_len=10
eval:
	batch_size=1024
	cutoff=[100, 200, 300]
	val_metrics=['mrr', 'recall', 'precision', 'ndcg']
	val_n_epoch=1
	test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
	topk=300
	save_path=./saved/
	num_workers=8
	predict_topk=100
model:
	embed_dim=128
	item_bias=False
	activation=gelu
	dropout_rate=0.5
	hidden_size=256
	head_num=2
	layer_norm_eps=1e-12
	layer_num=2
	loss_func=softmax
	reverse_pos=1
train:
	accelerator=gpu
	ann=None
	batch_size=1024
	early_stop_mode=max
	early_stop_patience=10
	epochs=300
	gpu=2
	grad_clip_norm=None
	init_method=default
	init_range=0.02
	item_batch_size=1024
	learner=adam
	learning_rate=0.00075
	num_threads=10
	num_workers=8
	sampling_method=none
	sampler=uniform
	negative_count=None
	excluding_hist=False
	scheduler=onplateau
	scheduler_patience=2
	scheduler_factor=0.5
	seed=2022
	weight_decay=0.0
	tensorboard_path=None
	use_wandb=False
	wandb_project=None
	wandb_count=0
	pretrained_embed_file=None
[2023-05-30 13:04:21] INFO save_dir:./saved/
[2023-05-30 13:04:21] INFO SASRec_Next(
  (score_func): InnerProductScorer()
  (loss_fn): SoftmaxLoss()
  (item_encoder): Embedding(518328, 128, padding_idx=0)
  (query_encoder): SASRecQueryEncoder(
    (item_encoder): Embedding(518328, 128, padding_idx=0)
    (position_emb): Embedding(11, 128, padding_idx=0)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
          )
          (linear1): Linear(in_features=128, out_features=256, bias=True)
          (dropout): Dropout(p=0.5, inplace=False)
          (linear2): Linear(in_features=256, out_features=128, bias=True)
          (norm1): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.5, inplace=False)
          (dropout2): Dropout(p=0.5, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.5, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
[2023-05-30 13:04:21] INFO GPU id [2] are selected.
[2023-05-30 13:11:45] INFO Training: Epoch=  0 [mrr@100=0.0018 recall@100=0.0082 precision@100=0.0001 ndcg@100=0.0030 train_loss_0=14.3636]
[2023-05-30 13:11:45] INFO Train time: 431.57306s. Valid time: 10.48258s. GPU RAM: 10.56/23.70 GB
[2023-05-30 13:11:45] INFO Current learning rate : 0.00075
[2023-05-30 13:11:47] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 13:11:47] INFO mrr@100 improved. Best value: 0.0018
[2023-05-30 13:19:09] INFO Training: Epoch=  1 [mrr@100=0.0358 recall@100=0.0698 precision@100=0.0007 ndcg@100=0.0424 train_loss_0=11.5464]
[2023-05-30 13:19:09] INFO Train time: 434.49481s. Valid time: 8.01620s. GPU RAM: 10.57/23.70 GB
[2023-05-30 13:19:09] INFO Current learning rate : 0.00075
[2023-05-30 13:19:11] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 13:19:11] INFO mrr@100 improved. Best value: 0.0358
[2023-05-30 13:26:30] INFO Training: Epoch=  2 [mrr@100=0.0842 recall@100=0.1409 precision@100=0.0014 ndcg@100=0.0956 train_loss_0=10.7823]
[2023-05-30 13:26:30] INFO Train time: 433.55259s. Valid time: 6.22788s. GPU RAM: 10.57/23.70 GB
[2023-05-30 13:26:30] INFO Current learning rate : 0.00075
[2023-05-30 13:26:32] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 13:26:32] INFO mrr@100 improved. Best value: 0.0842
[2023-05-30 13:33:50] INFO Training: Epoch=  3 [mrr@100=0.1239 recall@100=0.2031 precision@100=0.0020 ndcg@100=0.1401 train_loss_0=10.0818]
[2023-05-30 13:33:50] INFO Train time: 432.21700s. Valid time: 6.14957s. GPU RAM: 10.57/23.70 GB
[2023-05-30 13:33:50] INFO Current learning rate : 0.00075
[2023-05-30 13:33:51] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 13:33:51] INFO mrr@100 improved. Best value: 0.1239
[2023-05-30 13:41:19] INFO Training: Epoch=  4 [mrr@100=0.1536 recall@100=0.2564 precision@100=0.0026 ndcg@100=0.1749 train_loss_0=9.4599]
[2023-05-30 13:41:19] INFO Train time: 441.52046s. Valid time: 6.27935s. GPU RAM: 10.57/23.70 GB
[2023-05-30 13:41:19] INFO Current learning rate : 0.00075
[2023-05-30 13:41:21] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 13:41:21] INFO mrr@100 improved. Best value: 0.1536
[2023-05-30 13:49:03] INFO Training: Epoch=  5 [mrr@100=0.1763 recall@100=0.3005 precision@100=0.0030 ndcg@100=0.2023 train_loss_0=8.9181]
[2023-05-30 13:49:03] INFO Train time: 455.22199s. Valid time: 6.64026s. GPU RAM: 10.57/23.70 GB
[2023-05-30 13:49:03] INFO Current learning rate : 0.00075
[2023-05-30 13:49:04] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 13:49:04] INFO mrr@100 improved. Best value: 0.1763
[2023-05-30 13:56:41] INFO Training: Epoch=  6 [mrr@100=0.1947 recall@100=0.3401 precision@100=0.0034 ndcg@100=0.2251 train_loss_0=8.4455]
[2023-05-30 13:56:41] INFO Train time: 449.16631s. Valid time: 8.44545s. GPU RAM: 10.57/23.70 GB
[2023-05-30 13:56:41] INFO Current learning rate : 0.00075
[2023-05-30 13:56:43] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 13:56:43] INFO mrr@100 improved. Best value: 0.1947
[2023-05-30 14:05:27] INFO Training: Epoch=  7 [mrr@100=0.2105 recall@100=0.3743 precision@100=0.0037 ndcg@100=0.2448 train_loss_0=8.0325]
[2023-05-30 14:05:27] INFO Train time: 515.58582s. Valid time: 8.11152s. GPU RAM: 10.57/23.70 GB
[2023-05-30 14:05:27] INFO Current learning rate : 0.00075
[2023-05-30 14:05:29] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 14:05:29] INFO mrr@100 improved. Best value: 0.2105
[2023-05-30 14:13:09] INFO Training: Epoch=  8 [mrr@100=0.2235 recall@100=0.4048 precision@100=0.0040 ndcg@100=0.2614 train_loss_0=7.6708]
[2023-05-30 14:13:10] INFO Train time: 453.54745s. Valid time: 7.33863s. GPU RAM: 10.57/23.70 GB
[2023-05-30 14:13:10] INFO Current learning rate : 0.00075
[2023-05-30 14:13:11] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 14:13:11] INFO mrr@100 improved. Best value: 0.2235
[2023-05-30 14:21:17] INFO Training: Epoch=  9 [mrr@100=0.2338 recall@100=0.4309 precision@100=0.0043 ndcg@100=0.2750 train_loss_0=7.3521]
[2023-05-30 14:21:17] INFO Train time: 479.39430s. Valid time: 6.94874s. GPU RAM: 10.57/23.70 GB
[2023-05-30 14:21:17] INFO Current learning rate : 0.00075
[2023-05-30 14:21:19] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 14:21:19] INFO mrr@100 improved. Best value: 0.2338
[2023-05-30 14:29:10] INFO Training: Epoch= 10 [mrr@100=0.2425 recall@100=0.4529 precision@100=0.0045 ndcg@100=0.2864 train_loss_0=7.0714]
[2023-05-30 14:29:10] INFO Train time: 462.21493s. Valid time: 8.94532s. GPU RAM: 10.57/23.70 GB
[2023-05-30 14:29:10] INFO Current learning rate : 0.00075
[2023-05-30 14:29:12] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 14:29:12] INFO mrr@100 improved. Best value: 0.2425
[2023-05-30 14:37:09] INFO Training: Epoch= 11 [mrr@100=0.2504 recall@100=0.4731 precision@100=0.0047 ndcg@100=0.2968 train_loss_0=6.8229]
[2023-05-30 14:37:09] INFO Train time: 467.67495s. Valid time: 9.14985s. GPU RAM: 10.57/23.70 GB
[2023-05-30 14:37:09] INFO Current learning rate : 0.00075
[2023-05-30 14:37:11] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 14:37:11] INFO mrr@100 improved. Best value: 0.2504
[2023-05-30 14:45:01] INFO Training: Epoch= 12 [mrr@100=0.2569 recall@100=0.4903 precision@100=0.0049 ndcg@100=0.3056 train_loss_0=6.6016]
[2023-05-30 14:45:01] INFO Train time: 461.32253s. Valid time: 8.24960s. GPU RAM: 10.57/23.70 GB
[2023-05-30 14:45:01] INFO Current learning rate : 0.00075
[2023-05-30 14:45:02] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 14:45:02] INFO mrr@100 improved. Best value: 0.2569
[2023-05-30 14:53:11] INFO Training: Epoch= 13 [mrr@100=0.2626 recall@100=0.5071 precision@100=0.0051 ndcg@100=0.3135 train_loss_0=6.4054]
[2023-05-30 14:53:11] INFO Train time: 481.50459s. Valid time: 7.41715s. GPU RAM: 10.57/23.70 GB
[2023-05-30 14:53:11] INFO Current learning rate : 0.00075
[2023-05-30 14:53:12] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 14:53:12] INFO mrr@100 improved. Best value: 0.2626
[2023-05-30 15:00:53] INFO Training: Epoch= 14 [mrr@100=0.2672 recall@100=0.5208 precision@100=0.0052 ndcg@100=0.3200 train_loss_0=6.2297]
[2023-05-30 15:00:53] INFO Train time: 453.87367s. Valid time: 7.38975s. GPU RAM: 10.57/23.70 GB
[2023-05-30 15:00:53] INFO Current learning rate : 0.00075
[2023-05-30 15:00:56] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 15:00:56] INFO mrr@100 improved. Best value: 0.2672
[2023-05-30 15:08:30] INFO Training: Epoch= 15 [mrr@100=0.2718 recall@100=0.5337 precision@100=0.0053 ndcg@100=0.3263 train_loss_0=6.0712]
[2023-05-30 15:08:30] INFO Train time: 448.51070s. Valid time: 6.34319s. GPU RAM: 10.57/23.70 GB
[2023-05-30 15:08:30] INFO Current learning rate : 0.00075
[2023-05-30 15:08:32] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 15:08:32] INFO mrr@100 improved. Best value: 0.2718
[2023-05-30 15:16:11] INFO Training: Epoch= 16 [mrr@100=0.2746 recall@100=0.5441 precision@100=0.0054 ndcg@100=0.3306 train_loss_0=5.9280]
[2023-05-30 15:16:11] INFO Train time: 452.57797s. Valid time: 6.67360s. GPU RAM: 10.57/23.70 GB
[2023-05-30 15:16:11] INFO Current learning rate : 0.00075
[2023-05-30 15:16:13] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 15:16:13] INFO mrr@100 improved. Best value: 0.2746
[2023-05-30 15:23:52] INFO Training: Epoch= 17 [mrr@100=0.2780 recall@100=0.5542 precision@100=0.0055 ndcg@100=0.3354 train_loss_0=5.7983]
[2023-05-30 15:23:52] INFO Train time: 450.78414s. Valid time: 7.69117s. GPU RAM: 10.57/23.70 GB
[2023-05-30 15:23:52] INFO Current learning rate : 0.00075
[2023-05-30 15:23:53] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 15:23:53] INFO mrr@100 improved. Best value: 0.2780
[2023-05-30 15:31:31] INFO Training: Epoch= 18 [mrr@100=0.2808 recall@100=0.5633 precision@100=0.0056 ndcg@100=0.3395 train_loss_0=5.6818]
[2023-05-30 15:31:31] INFO Train time: 450.64849s. Valid time: 6.78954s. GPU RAM: 10.57/23.70 GB
[2023-05-30 15:31:31] INFO Current learning rate : 0.00075
[2023-05-30 15:31:32] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 15:31:32] INFO mrr@100 improved. Best value: 0.2808
[2023-05-30 15:39:13] INFO Training: Epoch= 19 [mrr@100=0.2835 recall@100=0.5707 precision@100=0.0057 ndcg@100=0.3431 train_loss_0=5.5741]
[2023-05-30 15:39:13] INFO Train time: 453.87881s. Valid time: 6.68611s. GPU RAM: 10.57/23.70 GB
[2023-05-30 15:39:13] INFO Current learning rate : 0.00075
[2023-05-30 15:39:15] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 15:39:15] INFO mrr@100 improved. Best value: 0.2835
[2023-05-30 15:46:51] INFO Training: Epoch= 20 [mrr@100=0.2857 recall@100=0.5782 precision@100=0.0058 ndcg@100=0.3464 train_loss_0=5.4778]
[2023-05-30 15:46:51] INFO Train time: 448.54315s. Valid time: 7.37540s. GPU RAM: 10.57/23.70 GB
[2023-05-30 15:46:51] INFO Current learning rate : 0.00075
[2023-05-30 15:46:52] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 15:46:52] INFO mrr@100 improved. Best value: 0.2857
[2023-05-30 15:54:25] INFO Training: Epoch= 21 [mrr@100=0.2880 recall@100=0.5848 precision@100=0.0058 ndcg@100=0.3495 train_loss_0=5.3886]
[2023-05-30 15:54:25] INFO Train time: 445.27448s. Valid time: 7.61461s. GPU RAM: 10.57/23.70 GB
[2023-05-30 15:54:25] INFO Current learning rate : 0.00075
[2023-05-30 15:54:26] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 15:54:26] INFO mrr@100 improved. Best value: 0.2880
[2023-05-30 16:02:01] INFO Training: Epoch= 22 [mrr@100=0.2897 recall@100=0.5920 precision@100=0.0059 ndcg@100=0.3522 train_loss_0=5.3074]
[2023-05-30 16:02:01] INFO Train time: 446.27019s. Valid time: 8.71609s. GPU RAM: 10.57/23.70 GB
[2023-05-30 16:02:01] INFO Current learning rate : 0.00075
[2023-05-30 16:02:03] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 16:02:03] INFO mrr@100 improved. Best value: 0.2897
[2023-05-30 16:09:39] INFO Training: Epoch= 23 [mrr@100=0.2917 recall@100=0.5977 precision@100=0.0060 ndcg@100=0.3549 train_loss_0=5.2314]
[2023-05-30 16:09:39] INFO Train time: 448.55312s. Valid time: 7.38618s. GPU RAM: 10.57/23.70 GB
[2023-05-30 16:09:39] INFO Current learning rate : 0.00075
[2023-05-30 16:09:40] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 16:09:40] INFO mrr@100 improved. Best value: 0.2917
[2023-05-30 16:17:11] INFO Training: Epoch= 24 [mrr@100=0.2921 recall@100=0.6022 precision@100=0.0060 ndcg@100=0.3562 train_loss_0=5.1630]
[2023-05-30 16:17:11] INFO Train time: 443.98966s. Valid time: 7.06908s. GPU RAM: 10.57/23.70 GB
[2023-05-30 16:17:11] INFO Current learning rate : 0.00075
[2023-05-30 16:17:13] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 16:17:13] INFO mrr@100 improved. Best value: 0.2921
[2023-05-30 16:24:43] INFO Training: Epoch= 25 [mrr@100=0.2939 recall@100=0.6073 precision@100=0.0061 ndcg@100=0.3587 train_loss_0=5.0987]
[2023-05-30 16:24:43] INFO Train time: 442.51170s. Valid time: 7.95385s. GPU RAM: 10.57/23.70 GB
[2023-05-30 16:24:43] INFO Current learning rate : 0.00075
[2023-05-30 16:24:45] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 16:24:45] INFO mrr@100 improved. Best value: 0.2939
[2023-05-30 16:32:14] INFO Training: Epoch= 26 [mrr@100=0.2949 recall@100=0.6113 precision@100=0.0061 ndcg@100=0.3603 train_loss_0=5.0392]
[2023-05-30 16:32:14] INFO Train time: 442.27339s. Valid time: 6.44964s. GPU RAM: 10.57/23.70 GB
[2023-05-30 16:32:14] INFO Current learning rate : 0.00075
[2023-05-30 16:32:15] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 16:32:15] INFO mrr@100 improved. Best value: 0.2949
[2023-05-30 16:39:48] INFO Training: Epoch= 27 [mrr@100=0.2968 recall@100=0.6160 precision@100=0.0062 ndcg@100=0.3626 train_loss_0=4.9846]
[2023-05-30 16:39:48] INFO Train time: 445.98673s. Valid time: 6.94533s. GPU RAM: 10.57/23.70 GB
[2023-05-30 16:39:48] INFO Current learning rate : 0.00075
[2023-05-30 16:39:49] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 16:39:49] INFO mrr@100 improved. Best value: 0.2968
[2023-05-30 16:47:15] INFO Training: Epoch= 28 [mrr@100=0.2970 recall@100=0.6192 precision@100=0.0062 ndcg@100=0.3635 train_loss_0=4.9346]
[2023-05-30 16:47:15] INFO Train time: 438.06903s. Valid time: 7.10284s. GPU RAM: 10.57/23.70 GB
[2023-05-30 16:47:15] INFO Current learning rate : 0.00075
[2023-05-30 16:47:16] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 16:47:16] INFO mrr@100 improved. Best value: 0.2970
[2023-05-30 16:54:41] INFO Training: Epoch= 29 [mrr@100=0.2980 recall@100=0.6233 precision@100=0.0062 ndcg@100=0.3651 train_loss_0=4.8863]
[2023-05-30 16:54:41] INFO Train time: 438.48003s. Valid time: 6.56866s. GPU RAM: 10.57/23.70 GB
[2023-05-30 16:54:41] INFO Current learning rate : 0.00075
[2023-05-30 16:54:43] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 16:54:43] INFO mrr@100 improved. Best value: 0.2980
[2023-05-30 17:02:07] INFO Training: Epoch= 30 [mrr@100=0.2987 recall@100=0.6263 precision@100=0.0063 ndcg@100=0.3663 train_loss_0=4.8414]
[2023-05-30 17:02:07] INFO Train time: 437.29109s. Valid time: 7.35131s. GPU RAM: 10.57/23.70 GB
[2023-05-30 17:02:07] INFO Current learning rate : 0.00075
[2023-05-30 17:02:09] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 17:02:09] INFO mrr@100 improved. Best value: 0.2987
[2023-05-30 17:09:29] INFO Training: Epoch= 31 [mrr@100=0.2997 recall@100=0.6285 precision@100=0.0063 ndcg@100=0.3675 train_loss_0=4.8014]
[2023-05-30 17:09:29] INFO Train time: 432.32163s. Valid time: 7.41325s. GPU RAM: 10.57/23.70 GB
[2023-05-30 17:09:29] INFO Current learning rate : 0.00075
[2023-05-30 17:09:30] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 17:09:30] INFO mrr@100 improved. Best value: 0.2997
[2023-05-30 17:16:37] INFO Training: Epoch= 32 [mrr@100=0.2999 recall@100=0.6315 precision@100=0.0063 ndcg@100=0.3683 train_loss_0=4.7628]
[2023-05-30 17:16:37] INFO Train time: 418.05087s. Valid time: 8.48395s. GPU RAM: 10.57/23.70 GB
[2023-05-30 17:16:37] INFO Current learning rate : 0.00075
[2023-05-30 17:16:38] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 17:16:38] INFO mrr@100 improved. Best value: 0.2999
[2023-05-30 17:23:41] INFO Training: Epoch= 33 [mrr@100=0.3006 recall@100=0.6347 precision@100=0.0063 ndcg@100=0.3694 train_loss_0=4.7268]
[2023-05-30 17:23:41] INFO Train time: 417.24179s. Valid time: 5.89002s. GPU RAM: 10.57/23.70 GB
[2023-05-30 17:23:41] INFO Current learning rate : 0.00075
[2023-05-30 17:23:43] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 17:23:43] INFO mrr@100 improved. Best value: 0.3006
[2023-05-30 17:30:52] INFO Training: Epoch= 34 [mrr@100=0.3016 recall@100=0.6370 precision@100=0.0064 ndcg@100=0.3706 train_loss_0=4.6927]
[2023-05-30 17:30:52] INFO Train time: 420.20798s. Valid time: 9.39367s. GPU RAM: 10.57/23.70 GB
[2023-05-30 17:30:52] INFO Current learning rate : 0.00075
[2023-05-30 17:30:53] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 17:30:53] INFO mrr@100 improved. Best value: 0.3016
[2023-05-30 17:38:31] INFO Training: Epoch= 35 [mrr@100=0.3021 recall@100=0.6395 precision@100=0.0064 ndcg@100=0.3715 train_loss_0=4.6615]
[2023-05-30 17:38:31] INFO Train time: 447.85729s. Valid time: 9.64441s. GPU RAM: 10.57/23.70 GB
[2023-05-30 17:38:31] INFO Current learning rate : 0.00075
[2023-05-30 17:38:32] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 17:38:32] INFO mrr@100 improved. Best value: 0.3021
[2023-05-30 17:45:57] INFO Training: Epoch= 36 [mrr@100=0.3026 recall@100=0.6412 precision@100=0.0064 ndcg@100=0.3723 train_loss_0=4.6320]
[2023-05-30 17:45:57] INFO Train time: 437.34604s. Valid time: 6.99944s. GPU RAM: 10.57/23.70 GB
[2023-05-30 17:45:57] INFO Current learning rate : 0.00075
[2023-05-30 17:45:58] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 17:45:58] INFO mrr@100 improved. Best value: 0.3026
[2023-05-30 17:53:03] INFO Training: Epoch= 37 [mrr@100=0.3027 recall@100=0.6431 precision@100=0.0064 ndcg@100=0.3728 train_loss_0=4.6043]
[2023-05-30 17:53:03] INFO Train time: 417.17008s. Valid time: 7.25979s. GPU RAM: 10.57/23.70 GB
[2023-05-30 17:53:03] INFO Current learning rate : 0.00075
[2023-05-30 17:53:04] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 17:53:04] INFO mrr@100 improved. Best value: 0.3027
[2023-05-30 18:00:06] INFO Training: Epoch= 38 [mrr@100=0.3034 recall@100=0.6446 precision@100=0.0064 ndcg@100=0.3737 train_loss_0=4.5777]
[2023-05-30 18:00:06] INFO Train time: 415.82509s. Valid time: 6.12396s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:00:06] INFO Current learning rate : 0.00075
[2023-05-30 18:00:08] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 18:00:08] INFO mrr@100 improved. Best value: 0.3034
[2023-05-30 18:07:08] INFO Training: Epoch= 39 [mrr@100=0.3032 recall@100=0.6466 precision@100=0.0065 ndcg@100=0.3739 train_loss_0=4.5535]
[2023-05-30 18:07:08] INFO Train time: 414.29774s. Valid time: 6.57587s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:07:08] INFO Current learning rate : 0.00075
[2023-05-30 18:14:10] INFO Training: Epoch= 40 [mrr@100=0.3035 recall@100=0.6476 precision@100=0.0065 ndcg@100=0.3743 train_loss_0=4.5296]
[2023-05-30 18:14:10] INFO Train time: 414.43772s. Valid time: 6.76153s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:14:10] INFO Current learning rate : 0.00075
[2023-05-30 18:14:11] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 18:14:11] INFO mrr@100 improved. Best value: 0.3035
[2023-05-30 18:21:15] INFO Training: Epoch= 41 [mrr@100=0.3043 recall@100=0.6495 precision@100=0.0065 ndcg@100=0.3753 train_loss_0=4.5085]
[2023-05-30 18:21:15] INFO Train time: 418.12829s. Valid time: 5.51682s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:21:15] INFO Current learning rate : 0.00075
[2023-05-30 18:21:16] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 18:21:16] INFO mrr@100 improved. Best value: 0.3043
[2023-05-30 18:28:18] INFO Training: Epoch= 42 [mrr@100=0.3040 recall@100=0.6506 precision@100=0.0065 ndcg@100=0.3753 train_loss_0=4.4875]
[2023-05-30 18:28:18] INFO Train time: 415.18830s. Valid time: 6.79143s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:28:18] INFO Current learning rate : 0.00075
[2023-05-30 18:35:22] INFO Training: Epoch= 43 [mrr@100=0.3047 recall@100=0.6518 precision@100=0.0065 ndcg@100=0.3761 train_loss_0=4.4675]
[2023-05-30 18:35:22] INFO Train time: 417.46339s. Valid time: 5.73049s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:35:22] INFO Current learning rate : 0.00075
[2023-05-30 18:35:23] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 18:35:23] INFO mrr@100 improved. Best value: 0.3047
[2023-05-30 18:42:25] INFO Training: Epoch= 44 [mrr@100=0.3045 recall@100=0.6524 precision@100=0.0065 ndcg@100=0.3761 train_loss_0=4.4500]
[2023-05-30 18:42:25] INFO Train time: 415.95284s. Valid time: 5.92002s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:42:25] INFO Current learning rate : 0.00075
[2023-05-30 18:49:31] INFO Training: Epoch= 45 [mrr@100=0.3054 recall@100=0.6542 precision@100=0.0065 ndcg@100=0.3771 train_loss_0=4.4321]
[2023-05-30 18:49:31] INFO Train time: 417.33714s. Valid time: 8.44732s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:49:31] INFO Current learning rate : 0.00075
[2023-05-30 18:49:32] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 18:49:32] INFO mrr@100 improved. Best value: 0.3054
[2023-05-30 18:56:37] INFO Training: Epoch= 46 [mrr@100=0.3052 recall@100=0.6551 precision@100=0.0066 ndcg@100=0.3771 train_loss_0=4.4152]
[2023-05-30 18:56:37] INFO Train time: 418.30393s. Valid time: 6.75688s. GPU RAM: 10.57/23.70 GB
[2023-05-30 18:56:37] INFO Current learning rate : 0.00075
[2023-05-30 19:03:40] INFO Training: Epoch= 47 [mrr@100=0.3057 recall@100=0.6553 precision@100=0.0066 ndcg@100=0.3776 train_loss_0=4.3989]
[2023-05-30 19:03:40] INFO Train time: 417.19745s. Valid time: 5.83912s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:03:40] INFO Current learning rate : 0.00075
[2023-05-30 19:03:42] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 19:03:42] INFO mrr@100 improved. Best value: 0.3057
[2023-05-30 19:10:43] INFO Training: Epoch= 48 [mrr@100=0.3052 recall@100=0.6563 precision@100=0.0066 ndcg@100=0.3773 train_loss_0=4.3842]
[2023-05-30 19:10:43] INFO Train time: 414.53305s. Valid time: 6.76458s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:10:43] INFO Current learning rate : 0.00075
[2023-05-30 19:17:39] INFO Training: Epoch= 49 [mrr@100=0.3052 recall@100=0.6577 precision@100=0.0066 ndcg@100=0.3776 train_loss_0=4.3689]
[2023-05-30 19:17:39] INFO Train time: 410.16924s. Valid time: 5.35549s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:17:39] INFO Current learning rate : 0.00075
[2023-05-30 19:24:36] INFO Training: Epoch= 50 [mrr@100=0.3053 recall@100=0.6572 precision@100=0.0066 ndcg@100=0.3776 train_loss_0=4.3558]
[2023-05-30 19:24:36] INFO Train time: 411.47214s. Valid time: 5.96840s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:24:36] INFO Current learning rate : 0.000375
[2023-05-30 19:31:32] INFO Training: Epoch= 51 [mrr@100=0.3067 recall@100=0.6583 precision@100=0.0066 ndcg@100=0.3790 train_loss_0=4.2781]
[2023-05-30 19:31:32] INFO Train time: 410.55037s. Valid time: 5.37635s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:31:32] INFO Current learning rate : 0.000375
[2023-05-30 19:31:34] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 19:31:34] INFO mrr@100 improved. Best value: 0.3067
[2023-05-30 19:38:32] INFO Training: Epoch= 52 [mrr@100=0.3070 recall@100=0.6591 precision@100=0.0066 ndcg@100=0.3793 train_loss_0=4.2625]
[2023-05-30 19:38:32] INFO Train time: 411.64136s. Valid time: 6.14131s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:38:32] INFO Current learning rate : 0.000375
[2023-05-30 19:38:33] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 19:38:33] INFO mrr@100 improved. Best value: 0.3070
[2023-05-30 19:45:37] INFO Training: Epoch= 53 [mrr@100=0.3070 recall@100=0.6597 precision@100=0.0066 ndcg@100=0.3795 train_loss_0=4.2533]
[2023-05-30 19:45:37] INFO Train time: 416.43646s. Valid time: 7.46446s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:45:37] INFO Current learning rate : 0.000375
[2023-05-30 19:45:39] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 19:45:39] INFO mrr@100 improved. Best value: 0.3070
[2023-05-30 19:52:43] INFO Training: Epoch= 54 [mrr@100=0.3073 recall@100=0.6600 precision@100=0.0066 ndcg@100=0.3797 train_loss_0=4.2427]
[2023-05-30 19:52:43] INFO Train time: 418.07047s. Valid time: 6.02572s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:52:43] INFO Current learning rate : 0.000375
[2023-05-30 19:52:44] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 19:52:44] INFO mrr@100 improved. Best value: 0.3073
[2023-05-30 19:59:48] INFO Training: Epoch= 55 [mrr@100=0.3071 recall@100=0.6601 precision@100=0.0066 ndcg@100=0.3796 train_loss_0=4.2357]
[2023-05-30 19:59:48] INFO Train time: 418.53239s. Valid time: 5.46124s. GPU RAM: 10.57/23.70 GB
[2023-05-30 19:59:48] INFO Current learning rate : 0.000375
[2023-05-30 20:06:44] INFO Training: Epoch= 56 [mrr@100=0.3069 recall@100=0.6607 precision@100=0.0066 ndcg@100=0.3795 train_loss_0=4.2279]
[2023-05-30 20:06:44] INFO Train time: 410.22509s. Valid time: 5.79046s. GPU RAM: 10.57/23.70 GB
[2023-05-30 20:06:44] INFO Current learning rate : 0.000375
[2023-05-30 20:13:41] INFO Training: Epoch= 57 [mrr@100=0.3070 recall@100=0.6607 precision@100=0.0066 ndcg@100=0.3797 train_loss_0=4.2204]
[2023-05-30 20:13:41] INFO Train time: 409.53361s. Valid time: 6.66547s. GPU RAM: 10.57/23.70 GB
[2023-05-30 20:13:41] INFO Current learning rate : 0.0001875
[2023-05-30 20:20:30] INFO Training: Epoch= 58 [mrr@100=0.3077 recall@100=0.6613 precision@100=0.0066 ndcg@100=0.3803 train_loss_0=4.1772]
[2023-05-30 20:20:30] INFO Train time: 403.98699s. Valid time: 5.30080s. GPU RAM: 10.57/23.70 GB
[2023-05-30 20:20:30] INFO Current learning rate : 0.0001875
[2023-05-30 20:20:31] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 20:20:31] INFO mrr@100 improved. Best value: 0.3077
[2023-05-30 20:27:17] INFO Training: Epoch= 59 [mrr@100=0.3077 recall@100=0.6614 precision@100=0.0066 ndcg@100=0.3803 train_loss_0=4.1698]
[2023-05-30 20:27:17] INFO Train time: 400.93069s. Valid time: 4.97529s. GPU RAM: 10.57/23.70 GB
[2023-05-30 20:27:17] INFO Current learning rate : 0.0001875
[2023-05-30 20:34:04] INFO Training: Epoch= 60 [mrr@100=0.3076 recall@100=0.6618 precision@100=0.0066 ndcg@100=0.3803 train_loss_0=4.1646]
[2023-05-30 20:34:04] INFO Train time: 399.48585s. Valid time: 7.05541s. GPU RAM: 10.57/23.70 GB
[2023-05-30 20:34:04] INFO Current learning rate : 0.0001875
[2023-05-30 20:40:48] INFO Training: Epoch= 61 [mrr@100=0.3075 recall@100=0.6618 precision@100=0.0066 ndcg@100=0.3803 train_loss_0=4.1599]
[2023-05-30 20:40:48] INFO Train time: 398.86907s. Valid time: 5.06132s. GPU RAM: 10.57/23.70 GB
[2023-05-30 20:40:48] INFO Current learning rate : 9.375e-05
[2023-05-30 20:47:39] INFO Training: Epoch= 62 [mrr@100=0.3078 recall@100=0.6618 precision@100=0.0066 ndcg@100=0.3805 train_loss_0=4.1373]
[2023-05-30 20:47:39] INFO Train time: 405.82522s. Valid time: 5.22567s. GPU RAM: 10.57/23.70 GB
[2023-05-30 20:47:39] INFO Current learning rate : 9.375e-05
[2023-05-30 20:47:40] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 20:47:40] INFO mrr@100 improved. Best value: 0.3078
[2023-05-30 20:54:30] INFO Training: Epoch= 63 [mrr@100=0.3079 recall@100=0.6619 precision@100=0.0066 ndcg@100=0.3806 train_loss_0=4.1328]
[2023-05-30 20:54:30] INFO Train time: 404.56707s. Valid time: 5.01129s. GPU RAM: 10.57/23.70 GB
[2023-05-30 20:54:30] INFO Current learning rate : 9.375e-05
[2023-05-30 20:54:31] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 20:54:31] INFO mrr@100 improved. Best value: 0.3079
[2023-05-30 21:01:19] INFO Training: Epoch= 64 [mrr@100=0.3077 recall@100=0.6620 precision@100=0.0066 ndcg@100=0.3805 train_loss_0=4.1301]
[2023-05-30 21:01:19] INFO Train time: 402.82432s. Valid time: 5.25191s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:01:19] INFO Current learning rate : 9.375e-05
[2023-05-30 21:08:07] INFO Training: Epoch= 65 [mrr@100=0.3076 recall@100=0.6619 precision@100=0.0066 ndcg@100=0.3803 train_loss_0=4.1273]
[2023-05-30 21:08:07] INFO Train time: 402.77417s. Valid time: 5.39884s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:08:07] INFO Current learning rate : 9.375e-05
[2023-05-30 21:14:54] INFO Training: Epoch= 66 [mrr@100=0.3078 recall@100=0.6621 precision@100=0.0066 ndcg@100=0.3805 train_loss_0=4.1252]
[2023-05-30 21:14:54] INFO Train time: 401.92866s. Valid time: 5.28557s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:14:54] INFO Current learning rate : 4.6875e-05
[2023-05-30 21:21:42] INFO Training: Epoch= 67 [mrr@100=0.3079 recall@100=0.6622 precision@100=0.0066 ndcg@100=0.3806 train_loss_0=4.1135]
[2023-05-30 21:21:42] INFO Train time: 402.89408s. Valid time: 5.24234s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:21:42] INFO Current learning rate : 4.6875e-05
[2023-05-30 21:28:30] INFO Training: Epoch= 68 [mrr@100=0.3079 recall@100=0.6622 precision@100=0.0066 ndcg@100=0.3806 train_loss_0=4.1121]
[2023-05-30 21:28:30] INFO Train time: 402.75182s. Valid time: 5.18910s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:28:30] INFO Current learning rate : 4.6875e-05
[2023-05-30 21:35:18] INFO Training: Epoch= 69 [mrr@100=0.3078 recall@100=0.6623 precision@100=0.0066 ndcg@100=0.3806 train_loss_0=4.1101]
[2023-05-30 21:35:18] INFO Train time: 402.98029s. Valid time: 4.99765s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:35:18] INFO Current learning rate : 2.34375e-05
[2023-05-30 21:42:05] INFO Training: Epoch= 70 [mrr@100=0.3078 recall@100=0.6624 precision@100=0.0066 ndcg@100=0.3806 train_loss_0=4.1037]
[2023-05-30 21:42:05] INFO Train time: 401.01483s. Valid time: 5.16246s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:42:05] INFO Current learning rate : 2.34375e-05
[2023-05-30 21:48:52] INFO Training: Epoch= 71 [mrr@100=0.3077 recall@100=0.6623 precision@100=0.0066 ndcg@100=0.3806 train_loss_0=4.1017]
[2023-05-30 21:48:52] INFO Train time: 401.59900s. Valid time: 5.50219s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:48:52] INFO Current learning rate : 2.34375e-05
[2023-05-30 21:55:42] INFO Training: Epoch= 72 [mrr@100=0.3079 recall@100=0.6626 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.1025]
[2023-05-30 21:55:42] INFO Train time: 404.94969s. Valid time: 5.04963s. GPU RAM: 10.57/23.70 GB
[2023-05-30 21:55:42] INFO Current learning rate : 1.171875e-05
[2023-05-30 21:55:43] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 21:55:43] INFO mrr@100 improved. Best value: 0.3079
[2023-05-30 22:02:35] INFO Training: Epoch= 73 [mrr@100=0.3079 recall@100=0.6626 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0993]
[2023-05-30 22:02:35] INFO Train time: 406.66741s. Valid time: 4.99320s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:02:35] INFO Current learning rate : 1.171875e-05
[2023-05-30 22:09:28] INFO Training: Epoch= 74 [mrr@100=0.3078 recall@100=0.6626 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0983]
[2023-05-30 22:09:28] INFO Train time: 407.96706s. Valid time: 5.18322s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:09:28] INFO Current learning rate : 1.171875e-05
[2023-05-30 22:16:23] INFO Training: Epoch= 75 [mrr@100=0.3079 recall@100=0.6625 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0976]
[2023-05-30 22:16:23] INFO Train time: 408.45038s. Valid time: 6.01327s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:16:23] INFO Current learning rate : 5.859375e-06
[2023-05-30 22:23:13] INFO Training: Epoch= 76 [mrr@100=0.3079 recall@100=0.6626 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0961]
[2023-05-30 22:23:13] INFO Train time: 404.99569s. Valid time: 5.55584s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:23:13] INFO Current learning rate : 5.859375e-06
[2023-05-30 22:30:06] INFO Training: Epoch= 77 [mrr@100=0.3078 recall@100=0.6625 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0966]
[2023-05-30 22:30:06] INFO Train time: 407.59459s. Valid time: 5.56790s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:30:06] INFO Current learning rate : 5.859375e-06
[2023-05-30 22:37:00] INFO Training: Epoch= 78 [mrr@100=0.3079 recall@100=0.6625 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0965]
[2023-05-30 22:37:00] INFO Train time: 408.22234s. Valid time: 5.79880s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:37:00] INFO Current learning rate : 2.9296875e-06
[2023-05-30 22:43:53] INFO Training: Epoch= 79 [mrr@100=0.3078 recall@100=0.6626 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0961]
[2023-05-30 22:43:53] INFO Train time: 407.34725s. Valid time: 5.49416s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:43:53] INFO Current learning rate : 2.9296875e-06
[2023-05-30 22:50:45] INFO Training: Epoch= 80 [mrr@100=0.3078 recall@100=0.6625 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0950]
[2023-05-30 22:50:45] INFO Train time: 405.90847s. Valid time: 5.58048s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:50:45] INFO Current learning rate : 2.9296875e-06
[2023-05-30 22:57:37] INFO Training: Epoch= 81 [mrr@100=0.3079 recall@100=0.6626 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0946]
[2023-05-30 22:57:37] INFO Train time: 405.50671s. Valid time: 6.44002s. GPU RAM: 10.57/23.70 GB
[2023-05-30 22:57:37] INFO Current learning rate : 1.46484375e-06
[2023-05-30 23:04:28] INFO Training: Epoch= 82 [mrr@100=0.3079 recall@100=0.6625 precision@100=0.0066 ndcg@100=0.3807 train_loss_0=4.0945]
[2023-05-30 23:04:28] INFO Train time: 405.65718s. Valid time: 5.53837s. GPU RAM: 10.57/23.70 GB
[2023-05-30 23:04:28] INFO Current learning rate : 1.46484375e-06
[2023-05-30 23:04:28] INFO Early stopped. Since the metric mrr@100 haven't been improved for 10 epochs.
[2023-05-30 23:04:28] INFO The best score of mrr@100 is 0.3079 on epoch 72
[2023-05-30 23:04:29] INFO Best model checkpoint saved in ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt.
[2023-05-30 23:04:35] INFO Testing:  [recall@100=0.6626 precision@100=0.0066 map@100=0.3079 ndcg@100=0.3807 mrr@100=0.3079 hit@100=0.6626 recall@200=0.6971 precision@200=0.0035 map@200=0.3082 ndcg@200=0.3856 mrr@200=0.3082 hit@200=0.6971 recall@300=0.7140 precision@300=0.0024 map@300=0.3083 ndcg@300=0.3877 mrr@300=0.3083 hit@300=0.7140]
[2023-05-30 23:04:43] INFO Load checkpoint from ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt
[2023-05-30 23:05:07] INFO Load checkpoint from ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt
[2023-05-30 23:05:30] INFO Load checkpoint from ./saved/SASRec_Next/kdd_cup_2023_DE/2023-05-30-13-04-14.ckpt
[2023-05-30 23:05:53] INFO Prediction is finished, results are saved in ./predictions/SASRec_Next/kdd_cup_2023_DE/2023-05-30-23-04-35.parquet.
