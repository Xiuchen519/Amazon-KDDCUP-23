[2023-06-07 11:49:08] INFO Log saved in /root/autodl-tmp/xiaolong/WorkSpace/Amazon-KDDCUP-23/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.log.
[2023-06-07 11:49:08] INFO Global seed set to 2022
[2023-06-07 11:49:08] INFO Load dataset from cache ./.recstudio/cache/2536617955df215e0047f5b220d1c012
[2023-06-07 11:49:21] INFO 
Dataset Info: 

==================================================================
item information: 
field      product_id JP_index   
type       token      float      
##         395010     -          
==================================================================
user information: 
field      sess_id    
type       token      
##         1192054    
==================================================================
interaction information: 
field      rating     sess_id    product_id timestamp  locale     
type       float      token      token      float      token      
##         -          1192054    395010     -          2          
==================================================================
Total Interactions: 6218923
Sparsity: 0.999987
==================================================================
[2023-06-07 11:49:21] INFO 
Model Config: 

data:
	binarized_rating_thres=None
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=True
	split_mode=user
	split_ratio=[1.0]
	test_rep=True
	train_rep=True
eval:
	batch_size=1024
	cutoff=[100, 200, 300]
	val_metrics=['mrr', 'recall', 'precision', 'ndcg']
	val_n_epoch=1
	test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
	topk=300
	save_path=./saved/
	num_workers=8
	predict_topk=100
model:
	embed_dim=128
	item_bias=False
	hidden_size=256
	dropout_rate=[0.25, 0.5]
	layer_num=1
	loss_func=softmax
	use_product_feature=1
	use_color=0
	use_price=0
	use_text_feat=0
	item_text_layers=[768, 128]
	item_text_dropout=0.0
	feat_id_concat=0
	feat_id_layers=None
	feat_id_dropout=None
	item_text_vectors=/root/autodl-tmp/xiaolong/WorkSpace/Amazon-KDDCUP-23/data_for_recstudio/JP_data/JP_product_text_vectors.npy
train:
	accelerator=gpu
	ann=None
	batch_size=1024
	early_stop_mode=max
	early_stop_patience=10
	epochs=300
	gpu=0
	grad_clip_norm=None
	init_method=default
	init_range=0.02
	item_batch_size=1024
	learner=adam
	learning_rate=0.001
	num_threads=10
	num_workers=8
	sampling_method=none
	sampler=uniform
	negative_count=None
	excluding_hist=False
	scheduler=onplateau
	scheduler_patience=2
	scheduler_factor=0.5
	seed=2022
	weight_decay=0.0
	tensorboard_path=None
	use_wandb=False
	wandb_project=None
	wandb_count=0
[2023-06-07 11:49:22] INFO save_dir:./saved/
[2023-06-07 11:49:22] INFO NARM_Feat(
  (score_func): InnerProductScorer()
  (loss_fn): SoftmaxLoss()
  (item_encoder): NARMFeatItemEncoder(
    (item_emb): Embedding(395010, 128, padding_idx=0)
    (brand_embedding): Embedding(48697, 128, padding_idx=0)
    (material_embedding): Embedding(15408, 128, padding_idx=0)
    (author_embedding): Embedding(11560, 128, padding_idx=0)
  )
  (query_encoder): NARMQueryEncoder(
    (item_encoder): NARMFeatItemEncoder(
      (item_emb): Embedding(395010, 128, padding_idx=0)
      (brand_embedding): Embedding(48697, 128, padding_idx=0)
      (material_embedding): Embedding(15408, 128, padding_idx=0)
      (author_embedding): Embedding(11560, 128, padding_idx=0)
    )
    (gru_layer): Sequential(
      (0): Dropout(p=0.25, inplace=False)
      (1): GRULayer(
        (gru): GRU(128, 256, bias=False, batch_first=True)
      )
    )
    (A_1): Linear(in_features=256, out_features=256, bias=False)
    (A_2): Linear(in_features=256, out_features=256, bias=False)
    (gather_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
    (attn_layer): AttentionLayer(
      (mlp): Sequential(
        (0): MLPModule(
          (model): Sequential(
            (0): Dropout(p=0.0, inplace=False)
            (1): Linear(in_features=512, out_features=256, bias=False)
            (2): Sigmoid()
          )
        )
        (1): Linear(in_features=256, out_features=1, bias=True)
      )
    )
    (fc): Sequential(
      (0): Dropout(p=0.5, inplace=False)
      (1): Linear(in_features=512, out_features=128, bias=False)
    )
  )
)
[2023-06-07 11:49:22] INFO GPU id [0] are selected.
[2023-06-07 11:56:41] INFO Training: Epoch=  0 [mrr@100=0.1475 recall@100=0.4323 precision@100=0.0043 ndcg@100=0.2040 train_loss_0=8.6172]
[2023-06-07 11:56:41] INFO Train time: 424.27310s. Valid time: 9.32378s. GPU RAM: 9.14/23.70 GB
[2023-06-07 11:56:41] INFO Current learning rate : 0.001
[2023-06-07 11:56:42] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 11:56:42] INFO mrr@100 improved. Best value: 0.1475
[2023-06-07 12:04:03] INFO Training: Epoch=  1 [mrr@100=0.1991 recall@100=0.5013 precision@100=0.0050 ndcg@100=0.2598 train_loss_0=7.1075]
[2023-06-07 12:04:03] INFO Train time: 431.49602s. Valid time: 9.24134s. GPU RAM: 9.14/23.70 GB
[2023-06-07 12:04:03] INFO Current learning rate : 0.001
[2023-06-07 12:04:06] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 12:04:06] INFO mrr@100 improved. Best value: 0.1991
[2023-06-07 12:11:16] INFO Training: Epoch=  2 [mrr@100=0.2364 recall@100=0.5470 precision@100=0.0055 ndcg@100=0.2993 train_loss_0=6.3784]
[2023-06-07 12:11:16] INFO Train time: 422.25301s. Valid time: 7.95007s. GPU RAM: 9.14/23.70 GB
[2023-06-07 12:11:16] INFO Current learning rate : 0.001
[2023-06-07 12:11:18] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 12:11:18] INFO mrr@100 improved. Best value: 0.2364
[2023-06-07 12:18:07] INFO Training: Epoch=  3 [mrr@100=0.2616 recall@100=0.5805 precision@100=0.0058 ndcg@100=0.3266 train_loss_0=5.9015]
[2023-06-07 12:18:07] INFO Train time: 400.12197s. Valid time: 8.51944s. GPU RAM: 9.14/23.70 GB
[2023-06-07 12:18:07] INFO Current learning rate : 0.001
[2023-06-07 12:18:10] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 12:18:10] INFO mrr@100 improved. Best value: 0.2616
[2023-06-07 12:25:01] INFO Training: Epoch=  4 [mrr@100=0.2805 recall@100=0.6031 precision@100=0.0060 ndcg@100=0.3466 train_loss_0=5.5675]
[2023-06-07 12:25:01] INFO Train time: 403.24556s. Valid time: 8.47300s. GPU RAM: 9.14/23.70 GB
[2023-06-07 12:25:01] INFO Current learning rate : 0.001
[2023-06-07 12:25:04] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 12:25:04] INFO mrr@100 improved. Best value: 0.2805
[2023-06-07 12:32:41] INFO Training: Epoch=  5 [mrr@100=0.2934 recall@100=0.6213 precision@100=0.0062 ndcg@100=0.3608 train_loss_0=5.3216]
[2023-06-07 12:32:41] INFO Train time: 446.72457s. Valid time: 9.70786s. GPU RAM: 9.14/23.70 GB
[2023-06-07 12:32:41] INFO Current learning rate : 0.001
[2023-06-07 12:32:43] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 12:32:43] INFO mrr@100 improved. Best value: 0.2934
[2023-06-07 12:40:09] INFO Training: Epoch=  6 [mrr@100=0.3040 recall@100=0.6346 precision@100=0.0063 ndcg@100=0.3722 train_loss_0=5.1260]
[2023-06-07 12:40:09] INFO Train time: 436.26523s. Valid time: 9.57610s. GPU RAM: 9.14/23.70 GB
[2023-06-07 12:40:09] INFO Current learning rate : 0.001
[2023-06-07 12:40:12] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 12:40:12] INFO mrr@100 improved. Best value: 0.3040
[2023-06-07 12:47:48] INFO Training: Epoch=  7 [mrr@100=0.3096 recall@100=0.6431 precision@100=0.0064 ndcg@100=0.3785 train_loss_0=4.9661]
[2023-06-07 12:47:48] INFO Train time: 447.08115s. Valid time: 9.51874s. GPU RAM: 9.14/23.70 GB
[2023-06-07 12:47:48] INFO Current learning rate : 0.001
[2023-06-07 12:47:51] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 12:47:51] INFO mrr@100 improved. Best value: 0.3096
[2023-06-07 12:55:09] INFO Training: Epoch=  8 [mrr@100=0.3176 recall@100=0.6507 precision@100=0.0065 ndcg@100=0.3866 train_loss_0=4.8315]
[2023-06-07 12:55:09] INFO Train time: 428.98163s. Valid time: 8.94878s. GPU RAM: 9.14/23.70 GB
[2023-06-07 12:55:09] INFO Current learning rate : 0.001
[2023-06-07 12:55:11] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 12:55:11] INFO mrr@100 improved. Best value: 0.3176
[2023-06-07 13:02:29] INFO Training: Epoch=  9 [mrr@100=0.3216 recall@100=0.6574 precision@100=0.0066 ndcg@100=0.3913 train_loss_0=4.7198]
[2023-06-07 13:02:29] INFO Train time: 428.60040s. Valid time: 8.50053s. GPU RAM: 9.14/23.70 GB
[2023-06-07 13:02:29] INFO Current learning rate : 0.001
[2023-06-07 13:02:31] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 13:02:31] INFO mrr@100 improved. Best value: 0.3216
[2023-06-07 13:09:35] INFO Training: Epoch= 10 [mrr@100=0.3261 recall@100=0.6621 precision@100=0.0066 ndcg@100=0.3959 train_loss_0=4.6247]
[2023-06-07 13:09:35] INFO Train time: 415.25820s. Valid time: 8.30469s. GPU RAM: 9.14/23.70 GB
[2023-06-07 13:09:35] INFO Current learning rate : 0.001
[2023-06-07 13:09:36] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 13:09:36] INFO mrr@100 improved. Best value: 0.3261
[2023-06-07 13:16:23] INFO Training: Epoch= 11 [mrr@100=0.3284 recall@100=0.6667 precision@100=0.0067 ndcg@100=0.3987 train_loss_0=4.5433]
[2023-06-07 13:16:23] INFO Train time: 398.65587s. Valid time: 8.34503s. GPU RAM: 9.14/23.70 GB
[2023-06-07 13:16:23] INFO Current learning rate : 0.001
[2023-06-07 13:16:26] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 13:16:26] INFO mrr@100 improved. Best value: 0.3284
[2023-06-07 13:23:13] INFO Training: Epoch= 12 [mrr@100=0.3309 recall@100=0.6706 precision@100=0.0067 ndcg@100=0.4016 train_loss_0=4.4720]
[2023-06-07 13:23:13] INFO Train time: 399.10707s. Valid time: 8.12640s. GPU RAM: 9.14/23.70 GB
[2023-06-07 13:23:13] INFO Current learning rate : 0.001
[2023-06-07 13:23:16] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 13:23:16] INFO mrr@100 improved. Best value: 0.3309
[2023-06-07 13:30:43] INFO Training: Epoch= 13 [mrr@100=0.3327 recall@100=0.6731 precision@100=0.0067 ndcg@100=0.4035 train_loss_0=4.4087]
[2023-06-07 13:30:43] INFO Train time: 438.55478s. Valid time: 9.20298s. GPU RAM: 9.14/23.70 GB
[2023-06-07 13:30:43] INFO Current learning rate : 0.001
[2023-06-07 13:30:46] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 13:30:46] INFO mrr@100 improved. Best value: 0.3327
[2023-06-07 13:38:16] INFO Training: Epoch= 14 [mrr@100=0.3350 recall@100=0.6733 precision@100=0.0067 ndcg@100=0.4055 train_loss_0=4.3525]
[2023-06-07 13:38:16] INFO Train time: 440.33997s. Valid time: 9.52817s. GPU RAM: 9.14/23.70 GB
[2023-06-07 13:38:16] INFO Current learning rate : 0.001
[2023-06-07 13:38:17] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 13:38:17] INFO mrr@100 improved. Best value: 0.3350
[2023-06-07 13:45:50] INFO Training: Epoch= 15 [mrr@100=0.3377 recall@100=0.6763 precision@100=0.0068 ndcg@100=0.4082 train_loss_0=4.3021]
[2023-06-07 13:45:50] INFO Train time: 443.03348s. Valid time: 9.32363s. GPU RAM: 9.14/23.70 GB
[2023-06-07 13:45:50] INFO Current learning rate : 0.001
[2023-06-07 13:45:53] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 13:45:53] INFO mrr@100 improved. Best value: 0.3377
[2023-06-07 13:53:02] INFO Training: Epoch= 16 [mrr@100=0.3386 recall@100=0.6777 precision@100=0.0068 ndcg@100=0.4092 train_loss_0=4.2543]
[2023-06-07 13:53:02] INFO Train time: 419.80199s. Valid time: 9.28108s. GPU RAM: 9.14/23.70 GB
[2023-06-07 13:53:02] INFO Current learning rate : 0.001
[2023-06-07 13:53:04] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 13:53:04] INFO mrr@100 improved. Best value: 0.3386
[2023-06-07 14:00:18] INFO Training: Epoch= 17 [mrr@100=0.3401 recall@100=0.6793 precision@100=0.0068 ndcg@100=0.4108 train_loss_0=4.2113]
[2023-06-07 14:00:18] INFO Train time: 425.40637s. Valid time: 8.95713s. GPU RAM: 9.14/23.70 GB
[2023-06-07 14:00:18] INFO Current learning rate : 0.001
[2023-06-07 14:00:20] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 14:00:20] INFO mrr@100 improved. Best value: 0.3401
[2023-06-07 14:08:16] INFO Training: Epoch= 18 [mrr@100=0.3395 recall@100=0.6799 precision@100=0.0068 ndcg@100=0.4104 train_loss_0=4.1707]
[2023-06-07 14:08:16] INFO Train time: 466.37989s. Valid time: 9.75276s. GPU RAM: 9.14/23.70 GB
[2023-06-07 14:08:16] INFO Current learning rate : 0.001
[2023-06-07 14:15:19] INFO Training: Epoch= 19 [mrr@100=0.3413 recall@100=0.6809 precision@100=0.0068 ndcg@100=0.4122 train_loss_0=4.1322]
[2023-06-07 14:15:19] INFO Train time: 414.76198s. Valid time: 8.33981s. GPU RAM: 9.14/23.70 GB
[2023-06-07 14:15:19] INFO Current learning rate : 0.001
[2023-06-07 14:15:21] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 14:15:21] INFO mrr@100 improved. Best value: 0.3413
[2023-06-07 14:22:33] INFO Training: Epoch= 20 [mrr@100=0.3408 recall@100=0.6806 precision@100=0.0068 ndcg@100=0.4117 train_loss_0=4.0948]
[2023-06-07 14:22:33] INFO Train time: 420.42630s. Valid time: 10.61063s. GPU RAM: 9.14/23.70 GB
[2023-06-07 14:22:33] INFO Current learning rate : 0.001
[2023-06-07 14:30:35] INFO Training: Epoch= 21 [mrr@100=0.3420 recall@100=0.6817 precision@100=0.0068 ndcg@100=0.4128 train_loss_0=4.0596]
[2023-06-07 14:30:35] INFO Train time: 472.08774s. Valid time: 10.23596s. GPU RAM: 9.14/23.70 GB
[2023-06-07 14:30:35] INFO Current learning rate : 0.001
[2023-06-07 14:30:38] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 14:30:38] INFO mrr@100 improved. Best value: 0.3420
[2023-06-07 14:38:31] INFO Training: Epoch= 22 [mrr@100=0.3435 recall@100=0.6815 precision@100=0.0068 ndcg@100=0.4140 train_loss_0=4.0257]
[2023-06-07 14:38:31] INFO Train time: 462.90558s. Valid time: 10.54307s. GPU RAM: 9.14/23.70 GB
[2023-06-07 14:38:31] INFO Current learning rate : 0.001
[2023-06-07 14:38:34] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 14:38:34] INFO mrr@100 improved. Best value: 0.3435
[2023-06-07 14:46:21] INFO Training: Epoch= 23 [mrr@100=0.3428 recall@100=0.6818 precision@100=0.0068 ndcg@100=0.4135 train_loss_0=3.9937]
[2023-06-07 14:46:21] INFO Train time: 456.48470s. Valid time: 10.42469s. GPU RAM: 9.14/23.70 GB
[2023-06-07 14:46:21] INFO Current learning rate : 0.001
[2023-06-07 14:53:39] INFO Training: Epoch= 24 [mrr@100=0.3428 recall@100=0.6818 precision@100=0.0068 ndcg@100=0.4134 train_loss_0=3.9620]
[2023-06-07 14:53:39] INFO Train time: 430.11389s. Valid time: 8.79956s. GPU RAM: 9.14/23.70 GB
[2023-06-07 14:53:39] INFO Current learning rate : 0.001
[2023-06-07 15:00:52] INFO Training: Epoch= 25 [mrr@100=0.3431 recall@100=0.6818 precision@100=0.0068 ndcg@100=0.4137 train_loss_0=3.9322]
[2023-06-07 15:00:52] INFO Train time: 424.02283s. Valid time: 8.54529s. GPU RAM: 9.14/23.70 GB
[2023-06-07 15:00:52] INFO Current learning rate : 0.0005
[2023-06-07 15:07:52] INFO Training: Epoch= 26 [mrr@100=0.3477 recall@100=0.6836 precision@100=0.0068 ndcg@100=0.4178 train_loss_0=3.7737]
[2023-06-07 15:07:52] INFO Train time: 411.57805s. Valid time: 7.86952s. GPU RAM: 9.14/23.70 GB
[2023-06-07 15:07:52] INFO Current learning rate : 0.0005
[2023-06-07 15:07:54] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 15:07:54] INFO mrr@100 improved. Best value: 0.3477
[2023-06-07 15:14:41] INFO Training: Epoch= 27 [mrr@100=0.3489 recall@100=0.6837 precision@100=0.0068 ndcg@100=0.4187 train_loss_0=3.7452]
[2023-06-07 15:14:41] INFO Train time: 398.55307s. Valid time: 8.29999s. GPU RAM: 9.14/23.70 GB
[2023-06-07 15:14:41] INFO Current learning rate : 0.0005
[2023-06-07 15:14:43] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 15:14:43] INFO mrr@100 improved. Best value: 0.3489
[2023-06-07 15:21:34] INFO Training: Epoch= 28 [mrr@100=0.3491 recall@100=0.6836 precision@100=0.0068 ndcg@100=0.4189 train_loss_0=3.7258]
[2023-06-07 15:21:34] INFO Train time: 400.94852s. Valid time: 9.84030s. GPU RAM: 9.14/23.70 GB
[2023-06-07 15:21:34] INFO Current learning rate : 0.0005
[2023-06-07 15:21:36] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 15:21:36] INFO mrr@100 improved. Best value: 0.3491
[2023-06-07 15:29:18] INFO Training: Epoch= 29 [mrr@100=0.3486 recall@100=0.6837 precision@100=0.0068 ndcg@100=0.4185 train_loss_0=3.7065]
[2023-06-07 15:29:18] INFO Train time: 451.56005s. Valid time: 9.95527s. GPU RAM: 9.14/23.70 GB
[2023-06-07 15:29:18] INFO Current learning rate : 0.0005
[2023-06-07 15:37:00] INFO Training: Epoch= 30 [mrr@100=0.3490 recall@100=0.6831 precision@100=0.0068 ndcg@100=0.4187 train_loss_0=3.6904]
[2023-06-07 15:37:00] INFO Train time: 451.23262s. Valid time: 10.94928s. GPU RAM: 9.14/23.70 GB
[2023-06-07 15:37:00] INFO Current learning rate : 0.0005
[2023-06-07 15:44:44] INFO Training: Epoch= 31 [mrr@100=0.3495 recall@100=0.6837 precision@100=0.0068 ndcg@100=0.4192 train_loss_0=3.6732]
[2023-06-07 15:44:44] INFO Train time: 453.35286s. Valid time: 10.31361s. GPU RAM: 9.14/23.70 GB
[2023-06-07 15:44:44] INFO Current learning rate : 0.0005
[2023-06-07 15:44:46] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 15:44:46] INFO mrr@100 improved. Best value: 0.3495
[2023-06-07 15:53:13] INFO Training: Epoch= 32 [mrr@100=0.3486 recall@100=0.6821 precision@100=0.0068 ndcg@100=0.4181 train_loss_0=3.6571]
[2023-06-07 15:53:13] INFO Train time: 497.50740s. Valid time: 9.24121s. GPU RAM: 9.14/23.70 GB
[2023-06-07 15:53:13] INFO Current learning rate : 0.0005
[2023-06-07 16:00:41] INFO Training: Epoch= 33 [mrr@100=0.3484 recall@100=0.6823 precision@100=0.0068 ndcg@100=0.4180 train_loss_0=3.6412]
[2023-06-07 16:00:41] INFO Train time: 438.26497s. Valid time: 9.08506s. GPU RAM: 9.14/23.70 GB
[2023-06-07 16:00:41] INFO Current learning rate : 0.0005
[2023-06-07 16:07:58] INFO Training: Epoch= 34 [mrr@100=0.3482 recall@100=0.6815 precision@100=0.0068 ndcg@100=0.4177 train_loss_0=3.6262]
[2023-06-07 16:07:58] INFO Train time: 428.92071s. Valid time: 8.30894s. GPU RAM: 9.14/23.70 GB
[2023-06-07 16:07:58] INFO Current learning rate : 0.00025
[2023-06-07 16:15:02] INFO Training: Epoch= 35 [mrr@100=0.3504 recall@100=0.6823 precision@100=0.0068 ndcg@100=0.4196 train_loss_0=3.5384]
[2023-06-07 16:15:02] INFO Train time: 415.89559s. Valid time: 8.17243s. GPU RAM: 9.14/23.70 GB
[2023-06-07 16:15:02] INFO Current learning rate : 0.00025
[2023-06-07 16:15:04] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 16:15:04] INFO mrr@100 improved. Best value: 0.3504
[2023-06-07 16:21:59] INFO Training: Epoch= 36 [mrr@100=0.3503 recall@100=0.6821 precision@100=0.0068 ndcg@100=0.4195 train_loss_0=3.5234]
[2023-06-07 16:21:59] INFO Train time: 404.75591s. Valid time: 9.90535s. GPU RAM: 9.14/23.70 GB
[2023-06-07 16:21:59] INFO Current learning rate : 0.00025
[2023-06-07 16:29:46] INFO Training: Epoch= 37 [mrr@100=0.3496 recall@100=0.6807 precision@100=0.0068 ndcg@100=0.4186 train_loss_0=3.5134]
[2023-06-07 16:29:46] INFO Train time: 457.66004s. Valid time: 9.37336s. GPU RAM: 9.14/23.70 GB
[2023-06-07 16:29:46] INFO Current learning rate : 0.00025
[2023-06-07 16:38:21] INFO Training: Epoch= 38 [mrr@100=0.3492 recall@100=0.6807 precision@100=0.0068 ndcg@100=0.4184 train_loss_0=3.5045]
[2023-06-07 16:38:21] INFO Train time: 500.99611s. Valid time: 13.78400s. GPU RAM: 9.14/23.70 GB
[2023-06-07 16:38:21] INFO Current learning rate : 0.000125
[2023-06-07 16:47:17] INFO Training: Epoch= 39 [mrr@100=0.3507 recall@100=0.6810 precision@100=0.0068 ndcg@100=0.4195 train_loss_0=3.4579]
[2023-06-07 16:47:17] INFO Train time: 523.69596s. Valid time: 12.42126s. GPU RAM: 9.14/23.70 GB
[2023-06-07 16:47:17] INFO Current learning rate : 0.000125
[2023-06-07 16:47:20] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 16:47:20] INFO mrr@100 improved. Best value: 0.3507
[2023-06-07 16:55:57] INFO Training: Epoch= 40 [mrr@100=0.3501 recall@100=0.6807 precision@100=0.0068 ndcg@100=0.4191 train_loss_0=3.4489]
[2023-06-07 16:55:57] INFO Train time: 505.71864s. Valid time: 11.61516s. GPU RAM: 9.14/23.70 GB
[2023-06-07 16:55:57] INFO Current learning rate : 0.000125
[2023-06-07 17:04:18] INFO Training: Epoch= 41 [mrr@100=0.3504 recall@100=0.6806 precision@100=0.0068 ndcg@100=0.4193 train_loss_0=3.4437]
[2023-06-07 17:04:18] INFO Train time: 490.07076s. Valid time: 10.77025s. GPU RAM: 9.14/23.70 GB
[2023-06-07 17:04:18] INFO Current learning rate : 0.000125
[2023-06-07 17:12:46] INFO Training: Epoch= 42 [mrr@100=0.3503 recall@100=0.6806 precision@100=0.0068 ndcg@100=0.4191 train_loss_0=3.4381]
[2023-06-07 17:12:46] INFO Train time: 497.28758s. Valid time: 10.07437s. GPU RAM: 9.14/23.70 GB
[2023-06-07 17:12:46] INFO Current learning rate : 6.25e-05
[2023-06-07 17:21:19] INFO Training: Epoch= 43 [mrr@100=0.3504 recall@100=0.6806 precision@100=0.0068 ndcg@100=0.4192 train_loss_0=3.4144]
[2023-06-07 17:21:19] INFO Train time: 499.22265s. Valid time: 13.85486s. GPU RAM: 9.14/23.70 GB
[2023-06-07 17:21:19] INFO Current learning rate : 6.25e-05
[2023-06-07 17:29:36] INFO Training: Epoch= 44 [mrr@100=0.3508 recall@100=0.6806 precision@100=0.0068 ndcg@100=0.4196 train_loss_0=3.4105]
[2023-06-07 17:29:36] INFO Train time: 487.90879s. Valid time: 9.08243s. GPU RAM: 9.14/23.70 GB
[2023-06-07 17:29:36] INFO Current learning rate : 6.25e-05
[2023-06-07 17:29:38] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 17:29:38] INFO mrr@100 improved. Best value: 0.3508
[2023-06-07 17:37:08] INFO Training: Epoch= 45 [mrr@100=0.3508 recall@100=0.6805 precision@100=0.0068 ndcg@100=0.4195 train_loss_0=3.4067]
[2023-06-07 17:37:08] INFO Train time: 440.73869s. Valid time: 8.84246s. GPU RAM: 9.14/23.70 GB
[2023-06-07 17:37:08] INFO Current learning rate : 6.25e-05
[2023-06-07 17:44:35] INFO Training: Epoch= 46 [mrr@100=0.3503 recall@100=0.6806 precision@100=0.0068 ndcg@100=0.4192 train_loss_0=3.4045]
[2023-06-07 17:44:35] INFO Train time: 437.22353s. Valid time: 10.09898s. GPU RAM: 9.14/23.70 GB
[2023-06-07 17:44:35] INFO Current learning rate : 6.25e-05
[2023-06-07 17:52:11] INFO Training: Epoch= 47 [mrr@100=0.3507 recall@100=0.6798 precision@100=0.0068 ndcg@100=0.4194 train_loss_0=3.4022]
[2023-06-07 17:52:11] INFO Train time: 444.98967s. Valid time: 10.43266s. GPU RAM: 9.14/23.70 GB
[2023-06-07 17:52:11] INFO Current learning rate : 3.125e-05
[2023-06-07 18:00:39] INFO Training: Epoch= 48 [mrr@100=0.3506 recall@100=0.6801 precision@100=0.0068 ndcg@100=0.4193 train_loss_0=3.3900]
[2023-06-07 18:00:39] INFO Train time: 496.92327s. Valid time: 11.25504s. GPU RAM: 9.14/23.70 GB
[2023-06-07 18:00:39] INFO Current learning rate : 3.125e-05
[2023-06-07 18:08:53] INFO Training: Epoch= 49 [mrr@100=0.3504 recall@100=0.6802 precision@100=0.0068 ndcg@100=0.4192 train_loss_0=3.3871]
[2023-06-07 18:08:53] INFO Train time: 482.27024s. Valid time: 11.41499s. GPU RAM: 9.14/23.70 GB
[2023-06-07 18:08:53] INFO Current learning rate : 3.125e-05
[2023-06-07 18:17:08] INFO Training: Epoch= 50 [mrr@100=0.3506 recall@100=0.6801 precision@100=0.0068 ndcg@100=0.4193 train_loss_0=3.3863]
[2023-06-07 18:17:08] INFO Train time: 482.59372s. Valid time: 12.14120s. GPU RAM: 9.14/23.70 GB
[2023-06-07 18:17:08] INFO Current learning rate : 1.5625e-05
[2023-06-07 18:25:39] INFO Training: Epoch= 51 [mrr@100=0.3505 recall@100=0.6800 precision@100=0.0068 ndcg@100=0.4192 train_loss_0=3.3792]
[2023-06-07 18:25:39] INFO Train time: 499.44186s. Valid time: 11.84180s. GPU RAM: 9.14/23.70 GB
[2023-06-07 18:25:39] INFO Current learning rate : 1.5625e-05
[2023-06-07 18:33:51] INFO Training: Epoch= 52 [mrr@100=0.3505 recall@100=0.6799 precision@100=0.0068 ndcg@100=0.4192 train_loss_0=3.3789]
[2023-06-07 18:33:51] INFO Train time: 480.63624s. Valid time: 11.15068s. GPU RAM: 9.14/23.70 GB
[2023-06-07 18:33:51] INFO Current learning rate : 1.5625e-05
[2023-06-07 18:41:53] INFO Training: Epoch= 53 [mrr@100=0.3506 recall@100=0.6801 precision@100=0.0068 ndcg@100=0.4193 train_loss_0=3.3777]
[2023-06-07 18:41:53] INFO Train time: 470.63742s. Valid time: 11.09778s. GPU RAM: 9.14/23.70 GB
[2023-06-07 18:41:53] INFO Current learning rate : 7.8125e-06
[2023-06-07 18:49:38] INFO Training: Epoch= 54 [mrr@100=0.3505 recall@100=0.6798 precision@100=0.0068 ndcg@100=0.4192 train_loss_0=3.3743]
[2023-06-07 18:49:38] INFO Train time: 455.89000s. Valid time: 9.10893s. GPU RAM: 9.14/23.70 GB
[2023-06-07 18:49:38] INFO Current learning rate : 7.8125e-06
[2023-06-07 18:49:38] INFO Early stopped. Since the metric mrr@100 haven't been improved for 10 epochs.
[2023-06-07 18:49:38] INFO The best score of mrr@100 is 0.3508 on epoch 44
[2023-06-07 18:49:41] INFO Best model checkpoint saved in ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt.
[2023-06-07 18:49:52] INFO Testing:  [recall@100=0.6806 precision@100=0.0068 map@100=0.3508 ndcg@100=0.4196 mrr@100=0.3508 hit@100=0.6806 recall@200=0.7111 precision@200=0.0036 map@200=0.3510 ndcg@200=0.4239 mrr@200=0.3510 hit@200=0.7111 recall@300=0.7261 precision@300=0.0024 map@300=0.3511 ndcg@300=0.4257 mrr@300=0.3511 hit@300=0.7261]
[2023-06-07 18:50:06] INFO Load checkpoint from ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt
[2023-06-07 18:50:43] INFO Load checkpoint from ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt
[2023-06-07 18:51:22] INFO Load checkpoint from ./saved/NARM_Feat/kdd_cup_2023_JP/2023-06-07-11-49-08.ckpt
[2023-06-07 18:51:52] INFO Prediction is finished, results are saved in ./predictions/NARM_Feat/kdd_cup_2023_JP/2023-06-07-18-49-52.parquet.
